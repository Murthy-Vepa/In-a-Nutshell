<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='80' font-size='80'>üèóÔ∏è</text></svg>" />
  <title>System Design Concepts - In a Nutshell</title>
  <meta name="description" content="A comprehensive guide to system design concepts." />
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    :root{
      --bg: #ffffff;
      --fg: #0f172a;
      --muted: #64748b;
      --accent: #3b82f6;
      --accent-light: #dbeafe;
      --border: #e2e8f0;
      --sidebar-bg: #ffffff;
      --sidebar-fg: #0f172a;
      --code-bg: linear-gradient(90deg, rgba(59, 130, 246, 0.08) 0%, rgba(59, 130, 246, 0.12) 100%);
      --focus: #10b981;
      --shadow-sm: 0 1px 3px rgba(0,0,0,0.08);
      --shadow-md: 0 4px 6px rgba(0,0,0,0.1), 0 2px 4px rgba(0,0,0,0.06);
      --shadow-lg: 0 10px 20px rgba(0,0,0,0.12), 0 6px 6px rgba(0,0,0,0.08);
      --gradient: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
    }
    
    /* Bootstrap Gradient Utility Classes */
    .bg-gradient-blue { background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%) !important; }
    .bg-gradient-green { background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%) !important; }
    .bg-gradient-yellow { background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%) !important; }
    .bg-gradient-pink { background: linear-gradient(135deg, #fce7f3 0%, #fbcfe8 100%) !important; }
    .bg-gradient-purple { background: linear-gradient(135deg, #e9d5ff 0%, #d8b4fe 100%) !important; }
    .bg-gradient-teal { background: linear-gradient(135deg, #ccfbf1 0%, #99f6e4 100%) !important; }
    .bg-gradient-blue-dark { background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%) !important; }
    .bg-gradient-gray { background: linear-gradient(135deg, #64748b 0%, #475569 100%) !important; }
    .bg-gradient-purple-dark { background: linear-gradient(135deg, #a855f7 0%, #9333ea 100%) !important; }
    .bg-gradient-teal-dark { background: linear-gradient(135deg, #14b8a6 0%, #0d9488 100%) !important; }
    .bg-gradient-green-dark { background: linear-gradient(135deg, #10b981 0%, #059669 100%) !important; }
    .bg-gradient-red { background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%) !important; }
    .bg-gradient-green-light { background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%) !important; }
    .bg-gradient-blue-sky { background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%) !important; }
    .bg-gradient-red-dark { background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%) !important; }
    .bg-gradient-indigo { background: linear-gradient(135deg, #4f46e5 0%, #4338ca 100%) !important; }
    .bg-gradient-green-medium { background: linear-gradient(135deg, #10b981 0%, #059669 100%) !important; }
    .bg-gradient-orange { background: linear-gradient(135deg, #f97316 0%, #ea580c 100%) !important; }
    .bg-gradient-violet { background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%) !important; }
    .bg-gradient-lime { background: linear-gradient(135deg, #84cc16 0%, #65a30d 100%) !important; }
    .bg-gradient-sky { background: linear-gradient(135deg, #0284c7 0%, #0369a1 100%) !important; }
    
    /* Apply theme colors to Bootstrap elements */
    body { background-color: var(--bg); color: var(--fg); overflow: hidden; }
    .navbar { background-color: var(--fg) !important; border-bottom: none !important; box-shadow: var(--shadow-md) !important; }
    .navbar-brand { cursor: pointer; color: var(--bg) !important; font-weight: 600; letter-spacing: 0px; }
    .navbar-toggler-icon { 
      filter: invert(1);
      background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba%2896, 165, 250, 0.9%29' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e");
    }
    
    .btn-outline-secondary { border-color: var(--border) !important; color: var(--fg) !important; }
    .btn-outline-secondary:hover { background-color: var(--accent-light) !important; border-color: var(--accent) !important; color: var(--accent) !important; }
    
    /* Sidebar - Modern Design */
    nav.sidebar { 
      background: linear-gradient(180deg, #f3f4f6 0%, #e5e7eb 100%); 
      border-right: 1px solid rgba(0, 0, 0, 0.05) !important;  
      overflow-y: auto; 
      box-shadow: 4px 0 16px rgba(0, 0, 0, 0.06);
      padding-top: 0;
    }
    
    .menu-header {  
      background: linear-gradient(135deg, rgba(0, 0, 0, 0.15), rgba(0, 0, 0, 0.1) 100%);
      font-weight: bold; 
      padding: 1.25rem 1.25rem; 
      letter-spacing: 0px; 
      font-size: 1.1rem;
      position: relative;
      overflow: hidden;
      border: none;
      border-bottom: 2px solid #a5aab3;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.12);
      color: #0c346c;
      text-shadow: none;
      margin: 0;
      text-transform: none;
    }
    .menu-header::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.15), transparent);
      transition: left 0.6s ease;
    }
    .menu-header:hover::before {
      left: 100%;
    }
    .menu-header::after {
      content: 'üèóÔ∏è';
      position: absolute;
      right: 1.5rem;
      top: 50%;
      transform: translateY(-50%);
      font-size: 1.3rem;
      opacity: 0.9;
      filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.2));
    }
    
    .toc { 
      list-style: none; 
      padding: 0rem 0; 
      margin: 0; 
      background: transparent;
    }
    .toc li { 
      margin: 0; 
    }
    
    /* Section grouping */
    .toc li[data-group="overview"] { margin-bottom: 0.75rem; }
    .toc li[data-group="solid"]:first-of-type { 
      margin-top: 1rem; 
      border-top: 2px solid rgba(59, 130, 246, 0.15);
      padding-top: 1rem;
    }
    .toc li[data-group="other-principles"]:first-of-type { 
      margin-top: 1rem; 
      border-top: 2px solid rgba(16, 185, 129, 0.15);
      padding-top: 1rem;
    }
    .toc li[data-group="resources"] { 
      margin-top: 1rem; 
      border-top: 2px solid rgba(100, 116, 139, 0.15);
      padding-top: 1rem;
    }
    
    .list-group-item { 
      background: transparent; 
      border-color: transparent; 
      padding: 0; 
      margin: 0.25rem 0.75rem; 
      border-radius: 0rem;
      transition: all 0.2s ease;
    }
    .list-group-item a { 
      color: #1f2937; 
      text-decoration: none; 
      display: flex; 
      flex-direction: column; 
      align-items: flex-start; 
      gap: 0.4rem; 
      border-left: 3px solid transparent; 
      padding: 0.85rem 1.25rem; 
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); 
      font-weight: 500; 
      border-radius: 0rem;
      font-size: 0.95rem;
      position: relative;
      overflow: hidden;
      background: linear-gradient(90deg, rgba(255, 255, 255, 0.4) 0%, rgba(255, 255, 255, 0.1) 100%);
      border: 1px solid rgba(0, 0, 0, 0.06);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
    }
    .list-group-item a::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      height: 100%;
      width: 4px;
      background: linear-gradient(180deg, #3b82f6 0%, #2563eb 100%);
      transform: scaleY(0);
      transition: transform 0.3s ease;
      border-radius: 0 0px 0px 0;
    }
    .list-group-item a::after {
      content: '‚ñ∂';
      position: absolute;
      right: 1rem;
      top: 50%;
      transform: translateY(-50%) scale(0.7);
      font-size: 0.7rem;
      color: #9ca3af;
      opacity: 0;
      transition: all 0.3s ease;
    }
    .list-group-item a:hover { 
      background: linear-gradient(90deg, rgba(59, 130, 246, 0.15) 0%, rgba(59, 130, 246, 0.08) 100%); 
      border-left-color: transparent;
      color: #1e40af;
      box-shadow: 0 4px 12px rgba(59, 130, 246, 0.2), 0 2px 4px rgba(0, 0, 0, 0.08);
      border-color: rgba(59, 130, 246, 0.2);
      text-decoration: none;
    }
    .list-group-item a:hover::before {
      transform: scaleY(1);
    }
    .list-group-item a:hover::after {
      opacity: 1;
      transform: translateY(-50%) scale(1);
      color: #3b82f6;
    }
    .list-group-item a.active { 
      background: linear-gradient(90deg, rgba(59, 130, 246, 0.22) 0%, rgba(59, 130, 246, 0.12) 100%); 
      color: #1e40af; 
      font-weight: 600; 
      border-left-color: transparent;
      box-shadow: 0 4px 16px rgba(59, 130, 246, 0.25), inset 0 1px 0 rgba(255, 255, 255, 0.3);
      border-color: rgba(59, 130, 246, 0.3);
    }
    .list-group-item a.active::before {
      transform: scaleY(1);
      background: linear-gradient(180deg, #3b82f6 0%, #2563eb 100%);
      width: 5px;
      box-shadow: 0 0 8px rgba(59, 130, 246, 0.5);
    }
    .list-group-item a.active::after {
      opacity: 1;
      color: #2563eb;
      transform: translateY(-50%) scale(1);
    }
    .list-group-item a.active:hover { 
      background: linear-gradient(90deg, rgba(59, 130, 246, 0.28) 0%, rgba(59, 130, 246, 0.16) 100%); 
      box-shadow: 0 6px 20px rgba(59, 130, 246, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.4);
    }
    
    /* Collapsible parent items */
    .list-group-item.has-children {
      cursor: default;
    }
    .list-group-item.has-children > a {
      cursor: pointer;
      user-select: none;
    }
    .list-group-item.has-children > a::after {
      content: '‚ñº';
      font-size: 0.65rem;
      opacity: 0.6;
      transition: transform 0.3s ease, opacity 0.3s ease;
      transform: translateY(-50%) rotate(0deg);
    }
    .list-group-item.has-children.collapsed > a::after {
      transform: translateY(-50%) rotate(-90deg);
    }
    .list-group-item.has-children > a:hover::after {
      opacity: 1;
    }
    
    /* Hide collapsed children */
    .list-group-sub-item.collapsed {
      display: none;
      max-height: 0;
      overflow: hidden;
    }
    
    /* Sub-items tree connectors */
    .list-group-sub-item a::before { 
      content: '‚îú‚îÄ';
      font-size: 0.85rem;
      margin-right: 0.5rem;
      color: #6b7280;
      z-index: 1;
      position: relative;
    }
    
    /* Sub-items styling - similar to main items but smaller and indented */
    .list-group-sub-item {
      background: transparent; 
      border-color: transparent; 
      padding: 0px; 
      margin: 0.2rem 0.75rem 0.2rem 1.5rem;
      border-radius: 0rem;
      transition: all 0.2s ease;
      position: relative;
      list-style-type: none;
    }
    .list-group-sub-item::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      height: 100%;
      width: 4px;
      background: linear-gradient(180deg, #3b82f6 0%, #2563eb 100%);
      transform: scaleY(0);
      transition: transform 0.3s ease;
      border-radius: 0 0px 0px 0;
      z-index: 1;
    }
    .list-group-sub-item a {
      color: #1f2937; 
      text-decoration: none; 
      display: block;
      border-left: 3px solid transparent; 
      padding: 0.65rem 1rem 0.65rem 2.00rem;
      transition: all 0.2s ease; 
      font-weight: 500; 
      border-radius: 0rem;
      font-size: 0.8125rem;
      line-height: 1.4;
      position: relative;
      overflow: hidden;
      background: rgba(255, 255, 255, 0.5);
      border: 1px solid rgba(0, 0, 0, 0.04);
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.04);
    }
    
    /* Sub-items hover and active states - same as main items */
    .list-group-sub-item a::after {
      content: '‚ñ∂';
      position: absolute;
      right: 1rem;
      top: 50%;
      transform: translateY(-50%) scale(0.7);
      font-size: 0.7rem;
      color: #9ca3af;
      opacity: 0;
      transition: all 0.3s ease;
    }
    
    .list-group-sub-item:hover::before {
      transform: scaleY(1);
    }
    .list-group-sub-item a:hover { 
      background: linear-gradient(90deg, rgba(59, 130, 246, 0.15) 0%, rgba(59, 130, 246, 0.08) 100%); 
      border-left-color: transparent;
      color: #1e40af;
      box-shadow: 0 4px 12px rgba(59, 130, 246, 0.2), 0 2px 4px rgba(0, 0, 0, 0.08);
      border-color: rgba(59, 130, 246, 0.2);
      text-decoration: none;
    }
    .list-group-sub-item a:hover::after {
      opacity: 1;
      transform: translateY(-50%) scale(1);
      color: #3b82f6;
    }
    
    .list-group-sub-item.active::before {
      transform: scaleY(1);
      width: 5px;
      box-shadow: 0 0 8px rgba(59, 130, 246, 0.5);
    }
    .list-group-sub-item a.active { 
      background: linear-gradient(90deg, rgba(59, 130, 246, 0.22) 0%, rgba(59, 130, 246, 0.12) 100%); 
      color: #1e40af; 
      font-weight: 600; 
      border-left-color: transparent;
      box-shadow: 0 4px 16px rgba(59, 130, 246, 0.25), inset 0 1px 0 rgba(255, 255, 255, 0.3);
      border-color: rgba(59, 130, 246, 0.3);
    }
    .list-group-sub-item a.active::after {
      opacity: 1;
      color: #2563eb;
      transform: translateY(-50%) scale(1);
    }
    .list-group-sub-item a.active:hover { 
      background: linear-gradient(90deg, rgba(59, 130, 246, 0.28) 0%, rgba(59, 130, 246, 0.16) 100%); 
      box-shadow: 0 6px 20px rgba(59, 130, 246, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.4);
    }
    
    .list-group-item a::after {
      content: '‚ñ∂';
      position: absolute;
      right: 1rem;
      top: 50%;
      transform: translateY(-50%) scale(0.7);
      font-size: 0.7rem;
      color: #9ca3af;
      opacity: 0;
      transition: all 0.3s ease;
    }
    
    .list-group-item a:hover { 
      background: linear-gradient(90deg, rgba(59, 130, 246, 0.15) 0%, rgba(59, 130, 246, 0.08) 100%); 
      border-left-color: transparent;
      color: #1e40af;
      box-shadow: 0 4px 12px rgba(59, 130, 246, 0.2), 0 2px 4px rgba(0, 0, 0, 0.08);
      border-color: rgba(59, 130, 246, 0.2);
      text-decoration: none;
    }
    .list-group-item a:hover::before {
      transform: scaleY(1);
    }
    .list-group-item a:hover::after {
      opacity: 1;
      transform: translateY(-50%) scale(1);
      color: #3b82f6;
    }
    .list-group-item a.active { 
      background: linear-gradient(90deg, rgba(59, 130, 246, 0.22) 0%, rgba(59, 130, 246, 0.12) 100%); 
      color: #1e40af; 
      font-weight: 600; 
      border-left-color: transparent;
      box-shadow: 0 4px 16px rgba(59, 130, 246, 0.25), inset 0 1px 0 rgba(255, 255, 255, 0.3);
      border-color: rgba(59, 130, 246, 0.3);
    }
    .list-group-item a.active::after {
      opacity: 1;
      color: #2563eb;
      transform: translateY(-50%) scale(1);
    }
    .list-group-item a.active:hover { 
      background: linear-gradient(90deg, rgba(59, 130, 246, 0.28) 0%, rgba(59, 130, 246, 0.16) 100%); 
      box-shadow: 0 6px 20px rgba(59, 130, 246, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.4);
    }
    
    /* Badge styling */
    .badge { font-size: 0.8rem; padding: 0.15rem 0.4rem; background: var(--accent-light); color: var(--accent); border: 1px solid var(--accent); font-weight: 600; border-radius: 0.25rem; font-style: normal; line-height: 1.2; opacity: 0.9; }
    .badge { background: var(--accent); color: white; border: none; font-size: 0.6rem; padding: 0.25rem 0.5rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; display: inline-block; margin-top: 0.5rem; margin-right: 0.35rem; }
    .list-group-item a:hover .badge { opacity: 1; background: var(--accent); color: white; }
    .list-group-item a.active .badge { background: rgba(255, 255, 255, 0.3); color: white; border-color: rgba(255, 255, 255, 0.6); font-weight: 600; opacity: 1; }
        
    /* Content */
    .content { width: 100%; max-width: 100%; margin: 0 auto; background: #ffffff; padding: 2rem; border-radius: 0.75rem; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08); }
    section { display: none !important; margin-bottom: 2rem; }
    section.active { display: block !important; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    
    h1 { font-size: 2rem; font-weight: 700; margin: 1rem 0 0.25rem 0; letter-spacing: -0.5px; color: var(--fg); display: block; border: none; }
    h2 { font-size: 1.5rem; font-weight: 600; margin: 1.5rem 0 0.75rem 0; color: var(--fg); border-bottom: 2px solid var(--accent-light); padding-bottom: 0.5rem; }
    h3 { font-size: 1.1rem; color: var(--accent); font-weight: 600; margin: 1rem 0 0.5rem 0; }
    h4 { font-size: 0.8rem; color: var(--fg); font-weight: 600; margin: 0.75rem 0 0.4rem 0; }
    p { margin: 1rem 0; line-height: 1.65; color: var(--fg); }
    ul, ol { margin: 1rem 0; padding-left: 2rem; }
    li { margin: 0.5rem 0; color: var(--fg); }
    
    code { background: var(--code-bg); border: 1px solid var(--border); padding: 0.2rem 0.5rem; font-family: ui-monospace, 'Cascadia Code', 'Source Code Pro', monospace; font-size: 0.9em; color: var(--accent); border-radius: 0.5rem; }
    pre { background: var(--code-bg); border: 0px solid var(--border); padding: 1rem; border-radius: 0.5rem; overflow: auto; box-shadow: var(--shadow-sm); margin: 1rem 0; }
    pre code { padding: 0; background: transparent; border: none; color: var(--fg); }
    
    .callout { border-left: 5px solid var(--accent); background: var(--accent-light); padding: 1rem 1.2rem; margin: 1.5rem 0; border-radius: 0.5rem; box-shadow: var(--shadow-sm); font-weight: 500; color: var(--fg); }
    
    /* Table styling */
    .table { color: var(--fg); }
    .table thead th { background: var(--accent-light); color: var(--accent); border-color: var(--border); font-weight: 600; }
    .table tbody td { border-color: var(--border); }
    .table-striped tbody tr:nth-of-type(odd) { background-color: rgba(0,0,0,0.02); }
    .table-striped tbody tr:hover { background-color: var(--accent-light); }
    
    /* Controls/Pagination */
    .controls { opacity: 0.5; position: fixed; bottom: 0.25rem; right: 1rem; width: auto; z-index: 1000; background: transparent; display: flex; align-items: center; justify-content: center; gap: 0rem; padding: 0; min-height: 40px; }
    @media (max-width: 991px) {
      .controls { bottom: 0.25rem; right: 1rem; }
      .menu-header { color: var(--focus); }
    }
    .controls:hover { opacity: 1; }
    
    .page-indicator { color: var(--accent); font-weight: 600; font-size: 0.875rem; }
    .btn-group .btn { margin: 0px 2px; padding: 0.2rem 0.5rem; background: var(--accent); color: white; border-color: var(--accent); font-size: 1rem; font-weight: bold; }
    .btn-group .btn:hover { background: var(--accent); }
    .btn-group .btn + .btn { margin-left: -1px; }
    
    /* Mobile/Offcanvas */
    .offcanvas { background: var(--bg) !important; }
    .offcanvas-header { border-bottom: 1px solid var(--border); }
    .offcanvas-title { color: var(--fg); font-weight: 600; }
    .btn-close { color: var(--fg); }
    
    /* Scrollbar */
    nav.sidebar::-webkit-scrollbar { width: 6px; }
    nav.sidebar::-webkit-scrollbar-track { background: rgba(0, 0, 0, 0.05); }
    nav.sidebar::-webkit-scrollbar-thumb { background: rgba(0, 0, 0, 0.2); border-radius: 0px; }
    nav.sidebar::-webkit-scrollbar-thumb:hover { background: rgba(0, 0, 0, 0.3); }
    
    /* Mermaid Diagrams */
    .mermaid {
      background: #ffffff;
      border: 1px solid #e2e8f0;
      border-radius: 0.5rem;
      padding: 2rem;
      margin: 1.5rem 0;
      min-height: 400px;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: visible;
      position: relative;
    }
    .mermaid.rendered {
      min-height: 0;
    }
    .mermaid svg {
      max-width: 100%;
      height: auto;
      min-height: 300px;
      transition: transform 0.3s ease;
      transform-origin: center center;
    }
    .mermaid.zoomed {
      overflow: auto;
      cursor: grab;
    }
    .mermaid.zoomed:active {
      cursor: grabbing;
    }
    .mermaid svg text {
      font-size: 14px !important;
      font-family: 'Segoe UI', system-ui, -apple-system, sans-serif !important;
    }
    
    /* Mermaid title styling */
    .mermaid svg text, .diagram-modal-content svg text {
      font-size: 1rem !important;
      font-weight: bold !important;
      fill: var(--fg) !important;
      font-family: 'Segoe UI', system-ui, -apple-system, sans-serif !important;
    }

    .mermaid svg *
    {
        color: #333;
    }

    .mermaid[data-processed="true"] {
      min-height: 0;
    }
    
    .mermaid svg {
      max-width: 100%;
      height: auto;
      display: inline-block;
    }
    
    /* Zoom controls */
    .zoom-controls {
      position: absolute;
      top: 10px;
      right: 10px;
      z-index: 10;
      opacity: 0.5;
      transition: opacity 0.3s ease;
    }
    .mermaid:hover .zoom-controls {
      opacity: 1;
    }
    .zoom-btn {
      background: var(--accent);
      color: white;
      border: none;
      border-radius: 0.25rem;
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 16px;
      font-weight: bold;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
      transition: all 0.2s ease;
    }
    .zoom-btn:hover {
      background: #2563eb;
      transform: scale(1.1);
    }

    /* Modal for diagram zoom */
    .diagram-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0, 0, 0, 0.95);
      z-index: 9999;
      align-items: center;
      justify-content: center;
      padding: 0;
    }
    .diagram-modal.active {
      display: flex;
    }
    .diagram-modal-content {
      position: relative;
      width: 100%;
      height: 100%;
      background: white;
      border-radius: 0;
      padding: 3rem 3rem 3rem 3rem;
      overflow: auto;
      display: flex;
      align-items: flex-start;
      justify-content: center;
    }
    .diagram-modal-content svg {
      max-width: 100%;
      height: auto;
    }
    .modal-close {
      position: fixed;
      top: 1.5rem;
      right: 1.5rem;
      background: #ef4444;
      color: white;
      border: none;
      border-radius: 50%;
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 16px;
      font-weight: bold;
      box-shadow: 0 4px 8px rgba(0,0,0,0.3);
      transition: all 0.2s ease;
      z-index: 10000;
    }
    .modal-close:hover {
      background: #dc2626;
      transform: scale(1.1);
    }
    .modal-zoom-controls {
      position: fixed;
      bottom: 1.5rem;
      right: 1.5rem;
      display: flex;
      gap: 0.5rem;
      z-index: 10000;
      padding: 0rem;
      border-radius: 0.4rem;
    }
    .modal-zoom-btn {
      background: var(--accent);
      color: white;
      border: none;
      border-radius: 0.25rem;
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 16px;
      font-weight: bold;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
      transition: all 0.2s ease;
    }
    .modal-zoom-btn:hover {
      background: #2563eb;
      transform: scale(1.1);
    }
    
    /* Utilities */
    .search { height: 0; overflow: hidden; padding: 0 !important; }
    .search input { display: none; }
    .min-vh-100 { min-height: 100vh; }
    .skip-link { position: absolute; left: -9999px; top: auto; width: 1px; height: 1px; overflow: hidden; }
    .skip-link:focus { position: static; width: auto; height: auto; padding: 0.4rem 0.6rem; background: var(--accent); color: white; border-radius: 0.4rem; }
    
    /* Override Bootstrap defaults for theme */
    a { color: var(--accent); }
    a:hover { color: var(--accent); text-decoration: underline; }
    
    /* Responsive - keep sidebar visible on desktop, offcanvas on mobile */
    @media (max-width: 991px) {
      nav.sidebar { display: none; }
      #main { width: 100%; }
      .row { --bs-gutter-x: 0; }
    }
    
    /* Layout - prevent unnecessary scrolling */
    html, body { height: 100%; margin: 0; }
    #appContainer { display: flex; flex-direction: column; height: calc(100vh - 50px); }
    #mainRow { flex: 1; overflow: hidden; display: flex; }
    nav.sidebar { overflow-y: auto; max-height: 100%; position: relative; padding-bottom: 0px; }
    #main { overflow: hidden; display: flex; flex-direction: column; height: 100%; -webkit-tap-highlight-color: transparent; outline: none; border: none; }
    #main:focus { outline: none; }
    .content { overflow-y: auto; flex: 1; width: 100%; min-height: 0; padding: 0rem 1.5rem 0rem 1.5rem; }
    
    /* Contact Info */
    .contact-info {
      font-weight: 400 !important;
      padding: 0.5rem 0.75rem;
      font-size: 0.75rem;
      color: var(--accent-light);
      margin: 0;
      opacity: 0.5;
      white-space: nowrap;
      cursor: pointer;
    }
    .contact-info:hover {
      opacity: 0.9;
      text-decoration: none;
    }
    @media (max-width: 991px) {
      .navbar-brand {
        font-size: 1rem !important;
        flex: 1;
      }
      .contact-info {
        font-size: 0.7rem;
        padding: 0.25rem 0.5rem;
      }
    }
    @media (max-width: 576px) {
      .navbar-brand {
        font-size: 0.9rem !important;
      }
      .contact-info {
        font-size: 0.65rem;
        padding: 0.2rem 0.4rem;
      }
    }

    .list-style-none {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    /* JSON Syntax Highlighting */
    pre code.language-json {
      display: block;
      white-space: pre;
      font-family: 'Cascadia Code', 'Consolas', 'Monaco', 'Courier New', monospace;
    }

    pre code.language-json .json-key {
      color: #0451a5;
      font-weight: 500;
    }

    pre code.language-json .json-string {
      color: #a31515;
    }

    pre code.language-json .json-number {
      color: #098658;
    }

    pre code.language-json .json-boolean {
      color: #0000ff;
      font-weight: 600;
    }

    pre code.language-json .json-null {
      color: #0000ff;
      font-weight: 600;
    }

    pre code.language-json .json-punctuation {
      color: #333;
    }

    /* SQL Syntax Highlighting */
    pre code.language-sql {
      display: block;
      white-space: pre;
      font-family: 'Cascadia Code', 'Consolas', 'Monaco', 'Courier New', monospace;
    }

    pre code.language-sql .sql-keyword {
      color: #0000ff;
      font-weight: 600;
      text-transform: uppercase;
    }

    pre code.language-sql .sql-string {
      color: #a31515;
    }

    pre code.language-sql .sql-number {
      color: #098658;
    }

    pre code.language-sql .sql-comment {
      color: #008000;
      font-style: italic;
    }

    pre code.language-sql .sql-function {
      color: #795e26;
      font-weight: 500;
    }

    pre code.language-sql .sql-operator {
      color: #666;
      font-weight: 500;
    }

    /* Language Label for Code Blocks */
    pre[data-language]::before {
      content: attr(data-language);
      position: absolute;
      top: 8px;
      right: 12px;
      font-size: 0.75em;
      color: #6a737d;
      text-transform: uppercase;
      font-weight: 600;
      letter-spacing: 0.5px;
      background: var(--bg);
      padding: 0.2rem 0.5rem;
      border-radius: 0.25rem;
      border: 1px solid var(--border);
    }

    /* Enhanced pre/code styling for syntax highlighted blocks */
    pre.syntax-highlighted {
      position: relative;
      background: var(--code-bg);
      border: 1px solid var(--border);
      padding: 1.5rem 1rem 1rem 1rem;
      border-radius: 0.5rem;
      overflow-x: auto;
      box-shadow: var(--shadow-sm);
      margin: 1rem 0;
    }

    pre.syntax-highlighted code {
      background: transparent;
      padding: 0;
      border: none;
      color: var(--fg);
      font-size: 0.875rem;
      line-height: 1.6;
    }

    ul
    {
        list-style-type: none;
    }
  /* Document Footer */
    .document-footer {
      text-align: center;
      padding: 20px;
      background-color: #f8f9fa;
      border-radius: 8px;
      margin-top: 20px;
    }
    .document-footer p {
      margin: 0;
      font-size: 14px;
      color: #6c757d;
      line-height: 1.6;
    }
    .document-footer strong {
      color: #495057;
    }  
  </style>
  <!-- Mermaid.js for diagrams -->
  <script src="https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.min.js"></script>
  <script>
    // Initialize Mermaid with proper configuration
    document.addEventListener('DOMContentLoaded', function() {

      mermaid.initialize({
        startOnLoad: false,
        theme: 'base',
        securityLevel: 'loose',
        logLevel: 'error',
        fontFamily: 'Segoe UI Semibold',
        flowchart: {
          useMaxWidth: true,
          htmlLabels: true,
          curve: 'basis',
        },
        sequence: {
          useMaxWidth: false,
          htmlLabels: true,
          diagramMarginX: 50,
          diagramMarginY: 10
        }
      });
      
      // Render all diagrams
      renderMermaidDiagrams();
    });
    
    async function renderMermaidDiagrams() {
      const diagrams = document.querySelectorAll('.mermaid');
      
      for (let i = 0; i < diagrams.length; i++) {
        const diagram = diagrams[i];
        const code = diagram.textContent.trim();
        
        // Store original code
        if (!diagram.hasAttribute('data-original-code')) {
          diagram.setAttribute('data-original-code', code);
        }
        
        try {
          const { svg } = await mermaid.render('mermaid-diagram-' + i, code);
          diagram.innerHTML = svg;
          diagram.setAttribute('data-processed', 'true');
          
          // Add zoom controls
          addZoomControls(diagram);
        } catch (error) {
          console.error('Mermaid rendering error for diagram ' + i + ':', error);
          diagram.innerHTML = '<div class="alert alert-danger border border-danger rounded p-3">Error rendering diagram: ' + error.message + '</div>';
        }
      }
    }
    
    // Add zoom controls to mermaid diagrams
    function addZoomControls(diagram) {
      const controls = document.createElement('div');
      controls.className = 'zoom-controls';
      controls.innerHTML = `
        <button class="zoom-btn" data-action="expand" title="Expand View">‚õ∂</button>
      `;
      
      diagram.style.position = 'relative';
      diagram.insertBefore(controls, diagram.firstChild);
      
      // Expand to modal
      controls.addEventListener('click', (e) => {
        const btn = e.target.closest('.zoom-btn');
        if (!btn) return;
        
        openDiagramModal(diagram);
      });
    }

    // Open diagram in modal
    function openDiagramModal(diagram) {
      // Create modal if it doesn't exist
      let modal = document.getElementById('diagram-modal');
      if (!modal) {
        modal = document.createElement('div');
        modal.id = 'diagram-modal';
        modal.className = 'diagram-modal';
        modal.innerHTML = `
          <button class="modal-close" id="modal-close">√ó</button>
          <div class="diagram-modal-content" id="modal-diagram-content"></div>
          <div class="modal-zoom-controls">
            <button class="modal-zoom-btn" data-action="zoom-in" title="Zoom In">+</button>
            <button class="modal-zoom-btn" data-action="zoom-out" title="Zoom Out">‚àí</button>
            <button class="modal-zoom-btn" data-action="reset" title="Reset Zoom">‚ü≤</button>
          </div>
        `;
        document.body.appendChild(modal);
        
        // Close modal handlers
        modal.querySelector('#modal-close').addEventListener('click', closeDiagramModal);
        modal.addEventListener('click', (e) => {
          if (e.target === modal) closeDiagramModal();
        });
        document.addEventListener('keydown', (e) => {
          if (e.key === 'Escape' && modal.classList.contains('active')) {
            closeDiagramModal();
          }
        });
        
        // Zoom controls in modal
        let scale = 1;
        let translateX = 0;
        let translateY = 0;
        
        modal.querySelector('.modal-zoom-controls').addEventListener('click', (e) => {
          const btn = e.target.closest('.modal-zoom-btn');
          if (!btn) return;
          
          const action = btn.dataset.action;
          const svg = modal.querySelector('svg');
          if (!svg) return;
          
          if (action === 'zoom-in') {
            scale = Math.min(scale + 0.1, 5);
          } else if (action === 'zoom-out') {
            scale = Math.max(scale - 0.1, 0.5);
          } else if (action === 'reset') {
            scale = 1;
            translateX = 0;
            translateY = 0;
          }
          
          svg.style.transform = `scale(${scale}) translate(${translateX / scale}px, ${translateY / scale}px)`;
        });
      }
      
      // Clone diagram content
      const svg = diagram.querySelector('svg');
      if (svg) {
        const content = modal.querySelector('#modal-diagram-content');
        content.innerHTML = '';
        const clonedSvg = svg.cloneNode(true);
        clonedSvg.style.transform = 'scale(1)';
        clonedSvg.style.maxWidth = '100%';
        clonedSvg.style.height = 'auto';
        content.appendChild(clonedSvg);
      }
      
      modal.classList.add('active');
      document.body.style.overflow = 'hidden';
    }

    function closeDiagramModal() {
      const modal = document.getElementById('diagram-modal');
      if (modal) {
        modal.classList.remove('active');
        document.body.style.overflow = '';
      }
    }
    
    // Re-render on theme change
    window.rerenderMermaid = async function() {
      const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
      
      mermaid.initialize({
        startOnLoad: false,
        theme: isDark ? 'base' : 'base',
        securityLevel: 'loose',
        flowchart: {
          useMaxWidth: true,
          htmlLabels: true,
          curve: 'basis',
        },
        sequence: {
          useMaxWidth: false,
          htmlLabels: true,
          diagramMarginX: 50,
          diagramMarginY: 10
        }
      });
      
      const diagrams = document.querySelectorAll('.mermaid[data-processed="true"]');
      for (let i = 0; i < diagrams.length; i++) {
        const diagram = diagrams[i];
        const code = diagram.getAttribute('data-original-code');
        
        if (code) {
          try {
            const { svg } = await mermaid.render('mermaid-diagram-rerender-' + i + '-' + Date.now(), code);
            diagram.innerHTML = svg;
          } catch (error) {
            console.error('Mermaid re-rendering error:', error);
          }
        }
      }
    };
  </script>
</head>
<body>
  <nav class="navbar navbar-expand-lg sticky-top" aria-label="Top bar">
    <div class="container-fluid d-flex align-items-center">
      <button class="navbar-toggler me-2" id="toggleSidebar" type="button" aria-label="Toggle sidebar">
        <span class="navbar-toggler-icon"></span>
      </button>
<span class="navbar-brand mb-0 h1 me-auto">üèóÔ∏è System Design Concepts - In a Nutshell</span>
<span class="contact-info mb-0">ü§ù Curated by Murthy Vepa</span>
    </div>      
  </nav>

  <div id="appContainer">
    <div class="row g-0" id="mainRow">
      <nav class="col-lg-3 border-end sidebar" id="sidebar" aria-label="Table of contents">
        <div class="menu-header py-2">Contents</div>
        <ul class="list-group list-group-flush toc" id="toc"></ul>
      </nav>

      <main id="main" class="col-lg-9 d-flex flex-column" tabindex="-1">
        <div class="content" id="content">

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê OVERVIEW ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <section id="overview" role="article">
          <h1>üìñ System Design Concepts ‚Äî Overview</h1>
          <span class="badge">intro</span> <span class="badge">overview</span> <span class="badge">system design</span>

          <h2>Introduction</h2>
          <p>System design is the craft of translating <strong>business requirements into scalable, reliable, and maintainable architectures</strong>. It sits at the intersection of computer science, software engineering, and operational excellence ‚Äî and is the skill that separates senior engineers from the rest.</p>
          <p>This guide covers <strong>25 essential system design concepts</strong> organised into five key areas, each built with practical depth: decision frameworks, trade-off tables, real-world examples, and actionable principles you can apply on the job today.</p>

          <div class="callout">
            <strong>üí° Why System Design Matters</strong>
            <ul>
              <li>‚úÖ <strong>Better Architecture Decisions:</strong> Make informed trade-offs between consistency, availability, and performance</li>
              <li>‚úÖ <strong>Scale Confidently:</strong> Understand when and how to scale before you hit production bottlenecks</li>
              <li>‚úÖ <strong>Shared Language:</strong> Give your team a common vocabulary for architecture discussions</li>
              <li>‚úÖ <strong>Cloud-Ready Thinking:</strong> Apply resilience, observability, and security patterns from day one</li>
            </ul>
          </div>

          <h2>What's Covered</h2>

          <h3>üìå Foundational Concepts (6 topics)</h3>
          <p>The building blocks every system design conversation starts with ‚Äî requirements, scale estimation, and data distribution.</p>
          <ul>
            <li><strong>What is System Design?</strong> ‚Äî Problem framing, requirement gathering, back-of-envelope estimation</li>
            <li><strong>Functional vs Non-Functional Requirements</strong> ‚Äî Separating <em>what</em> from <em>how well</em>; NFRs as architecture drivers</li>
            <li><strong>Horizontal vs Vertical Scaling</strong> ‚Äî When to scale out vs scale up; choosing the right strategy per tier</li>
            <li><strong>Load Balancing Strategies</strong> ‚Äî Round-robin, weighted, Least Connections, IP Hash, Consistent Hashing</li>
            <li><strong>Caching Basics</strong> ‚Äî Client, CDN, Application, DB layers; eviction policies; cache stampede</li>
            <li><strong>DB Sharding, Partitioning &amp; Replication</strong> ‚Äî Range/hash/geo sharding; leader/leaderless replication; resharding challenges</li>
          </ul>

          <h3>üìå Storage &amp; Databases (4 topics)</h3>
          <p>Choosing the right data store is the most consequential design decision. These topics give you the full decision framework.</p>
          <ul>
            <li><strong>SQL vs NoSQL</strong> ‚Äî ACID vs BASE; Key-Value, Document, Wide-Column, Graph stores; when to choose what</li>
            <li><strong>CAP Theorem &amp; PACELC</strong> ‚Äî CP vs AP systems; PACELC's latency vs consistency trade-off beyond partition scenarios</li>
            <li><strong>Event Sourcing &amp; CQRS</strong> ‚Äî Immutable event log; read/write model separation; projections and replay</li>
            <li><strong>Search Systems</strong> ‚Äî Inverted indexes; relevance scoring (TF-IDF / BM25); ElasticSearch architecture</li>
          </ul>

          <h3>üìå Architecture Patterns (6 topics)</h3>
          <p>The macro-structural decisions that define how your services are organised and how they communicate.</p>
          <ul>
            <li><strong>Monolith vs Microservices</strong> ‚Äî The spectrum; Conway's Law; when to decompose</li>
            <li><strong>API Gateway &amp; BFF</strong> ‚Äî Unified entry point; SSL termination; client-specific backends</li>
            <li><strong>Message Queues &amp; Pub/Sub</strong> ‚Äî Kafka vs RabbitMQ; topics, partitions, consumer groups; fan-out vs point-to-point</li>
            <li><strong>Distributed Transactions &amp; Sagas</strong> ‚Äî Choreography vs orchestration; compensating transactions; eventual consistency</li>
            <li><strong>Idempotency &amp; Retry Patterns</strong> ‚Äî Idempotency keys; exponential backoff with jitter; thundering herd prevention</li>
            <li><strong>Strangler Fig Pattern</strong> ‚Äî Fa√ßade-based incremental migration; zero big-bang rewrites</li>
          </ul>

          <h3>üìå Cloud &amp; Platform Engineering (6 topics)</h3>
          <p>Production-grade cloud systems require designing for failure, not around it. These patterns are the standard toolkit.</p>
          <ul>
            <li><strong>Fault Tolerance &amp; High Availability</strong> ‚Äî Redundancy models; health probes; availability nines table</li>
            <li><strong>Circuit Breaker &amp; Bulkhead</strong> ‚Äî Preventing cascade failures; state machine (Closed / Open / Half-Open); resource isolation</li>
            <li><strong>Serverless &amp; Event-Driven Design</strong> ‚Äî Functions-as-a-Service; cold starts; EDA + serverless composition</li>
            <li><strong>Infrastructure as Code</strong> ‚Äî Declarative vs imperative; Terraform, Bicep, Pulumi; drift elimination</li>
            <li><strong>Zero-Trust Architecture</strong> ‚Äî Never trust, always verify; least privilege; mTLS, identity-first security</li>
            <li><strong>Multi-Region Active-Active vs Active-Passive</strong> ‚Äî RTO/RPO; geo-routing; write conflict resolution</li>
          </ul>

          <h3>üìå Performance &amp; Reliability (4 topics)</h3>
          <p>The SRE toolkit for measuring, protecting, and continuously improving production systems.</p>
          <ul>
            <li><strong>Observability: Logging, Metrics, Tracing</strong> ‚Äî The three pillars; RED &amp; USE methods; OpenTelemetry</li>
            <li><strong>Rate Limiting &amp; API Throttling</strong> ‚Äî Token Bucket, Leaky Bucket, Sliding Window; HTTP 429 &amp; Retry-After</li>
            <li><strong>Chaos Engineering</strong> ‚Äî Steady state hypothesis; failure injection; Chaos Monkey / Azure Chaos Studio</li>
            <li><strong>SLIs, SLOs &amp; SLAs</strong> ‚Äî Reliability indicators vs objectives vs agreements; error budgets; burn rate alerting</li>
          </ul>

          <div class="callout mt-3">
            <strong>üéØ Recommended Reading Order</strong><br/>
            If you're new to system design, follow the sections top to bottom. If you're looking to quickly review specific topics, jump to the section that matches your current needs. The concepts build on each other, but each section is designed to be standalone as well.<br/><br/>
            <em>What is System Design?</em> ‚Üí <em>Scaling</em> ‚Üí <em>Caching</em> ‚Üí <em>SQL vs NoSQL</em> ‚Üí <em>CAP Theorem</em> ‚Üí <em>Monolith vs Microservices</em> ‚Üí <em>API Gateway</em> ‚Üí <em>Message Queues</em> ‚Üí <em>SLIs/SLOs/SLAs</em>.
          </div>

          <h2>Who Is This For?</h2>
          <div class="row g-3 mt-1">
            <div class="col-md-4"><div class="card h-100 border-0 bg-gradient-blue p-3 rounded-3"><h6 class="fw-bold">üë®‚Äçüíª Software Engineers</h6><ul class="mb-0 ps-3"><li>Making day-to-day architectural decisions</li><li>Onboarding to distributed systems</li></ul></div></div>
            <div class="col-md-4"><div class="card h-100 border-0 bg-gradient-green p-3 rounded-3"><h6 class="fw-bold">üèóÔ∏è Architects &amp; Tech Leads</h6><ul class="mb-0 ps-3"><li>Evaluating architectural options</li><li>Communicating trade-offs to stakeholders</li><li>Reviewing and guiding team designs</li></ul></div></div>
            <div class="col-md-4"><div class="card h-100 border-0 bg-gradient-yellow p-3 rounded-3"><h6 class="fw-bold">‚òÅÔ∏è Cloud &amp; Platform Engineers</h6><ul class="mb-0 ps-3"><li>Designing resilient cloud-native systems</li><li>Implementing SRE practices</li><li>Scaling services on Azure / AWS / GCP</li></ul></div></div>
          </div>
        </section>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê FOUNDATIONAL CONCEPTS GROUP ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <section id="foundational" role="article">
          <h1>üéì Foundational Concepts</h1>
          <span class="badge">foundational</span> <span class="badge">basics</span> <span class="badge">fundamentals</span>
        </section>

        <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ FOUNDATIONAL INTRODUCTION ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
        <section id="foundational-introduction" role="article">
          <h1>üìñ Introduction</h1>
          <span class="badge">foundational</span> <span class="badge">basics</span> <span class="badge">overview</span>

          <h2>About Foundational Concepts</h2>
          <p>Foundational concepts are the <strong>non-negotiable bedrock of every system design conversation</strong>. Before you can talk about databases, microservices, or cloud patterns, you need a firm grip on how to frame requirements, estimate capacity, distribute load, and store data at scale.</p>
          <p>This section covers <strong>6 core topics</strong> that appear in virtually every production system. Master these and you will have the vocabulary and mental models to reason about any architecture problem.</p>

          <div class="callout">
            <strong>üí° Why These Concepts Matter</strong>
            <ul>
              <li>‚úÖ <strong>Problem Framing First:</strong> Getting requirements wrong wastes entire design cycles ‚Äî NFRs drive architecture more than features do</li>
              <li>‚úÖ <strong>Scale is a Choice:</strong> Understanding when to scale out vs up prevents over-engineering and under-engineering equally</li>
              <li>‚úÖ <strong>Load Balancing is Invisible ‚Äî Until it Isn't:</strong> The right algorithm is the difference between even load and thundering herds</li>
              <li>‚úÖ <strong>Cache Everything Wisely:</strong> 80% of read traffic can be served from cache ‚Äî but getting invalidation wrong causes silent data bugs</li>
              <li>‚úÖ <strong>Database Distribution is Irreversible:</strong> Sharding and replication choices lock in your operational model; choosing wrong is expensive to unwind</li>
            </ul>
          </div>

          <h2>What's Covered</h2>

          <h3>üéØ What is System Design?</h3>
          <p>The discipline of defining architecture, components, interfaces, and data flows to satisfy requirements. Covers the four-step framework: <strong>Clarify Requirements ‚Üí Estimate Scale ‚Üí High-Level Design ‚Üí Deep Dive</strong>. Includes back-of-envelope techniques (QPS, storage, bandwidth estimation).</p>

          <h3>üìã Functional vs Non-Functional Requirements (NFRs)</h3>
          <p>Separating <em>what the system does</em> (features, APIs, workflows) from <em>how well it does it</em> (latency, availability, security, cost). NFRs are the true architecture drivers ‚Äî a 99.999% availability target produces a fundamentally different design than 99.9%. Covers the six NFR categories: Performance, Reliability, Scalability, Security, Maintainability, Cost.</p>

          <h3>üìà Horizontal vs Vertical Scaling</h3>
          <p>Vertical scaling (bigger machine) is simple but has a hard ceiling and is a single point of failure. Horizontal scaling (more machines) is theoretically unlimited but requires stateless services and introduces distributed complexity. Covers when to use each, and the reality that most production systems use both ‚Äî vertical for databases, horizontal for application tiers.</p>

          <h3>‚öñÔ∏è Load Balancing Strategies</h3>
          <p>Load balancers distribute traffic across healthy instances to maximise throughput and prevent overload. Covers L4 (transport-layer) vs L7 (application-layer) balancers, and six algorithms: Round-Robin, Weighted Round-Robin, Least Connections, IP Hash, Consistent Hashing, and Random. Consistent Hashing is particularly important for distributed caches ‚Äî only K/N keys are remapped when a node is added or removed.</p>

          <h3>‚ö° Caching Basics</h3>
          <p>Caching stores hot data in a faster layer to reduce latency and protect downstream services. Covers four caching layers (Client ‚Üí CDN ‚Üí Application ‚Üí Database), eviction policies (LRU, LFU, TTL, Write-Through), and critical failure modes including Cache Stampede / Thundering Herd. The key challenge: cache invalidation is one of the hardest problems in computer science.</p>

          <h3>üóÑÔ∏è Database Sharding, Partitioning &amp; Replication</h3>
          <p>When a single DB node can't handle load or storage, data must be distributed. Covers three sharding strategies (Range, Hash, Directory-based), three replication models (Single-Leader, Multi-Leader, Leaderless/Quorum), and the operational challenges of cross-shard queries, hot shards, and resharding. The golden rule: start with a single node, add read replicas, shard only when you feel real pain.</p>

          <div class="callout mt-3">
            <strong>üîó How These Topics Connect</strong><br/>
            Requirements define your <em>NFRs</em> ‚Üí NFRs determine your <em>scaling strategy</em> ‚Üí Scale drives your <em>load balancing</em> and <em>caching</em> needs ‚Üí Data volume forces <em>sharding &amp; replication</em> decisions. These six topics form a logical dependency chain ‚Äî each one builds on the last.
          </div>

          <h2>Key Topics at a Glance</h2>
          <div class="row g-3 mt-1">
            <div class="col-md-4"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100"><h6 class="fw-bold">üéØ What is System Design?</h6><ul class="mb-0 ps-3"><li>4-step framework: Clarify ‚Üí Estimate ‚Üí Design ‚Üí Dive</li><li>Back-of-envelope: QPS, storage, bandwidth</li><li>Interview strategy &amp; common mistakes</li></ul></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100"><h6 class="fw-bold">üìã Functional vs NFRs</h6><ul class="mb-0 ps-3"><li>Features &amp; behaviours vs quality attributes</li><li>Six NFR categories (Perf, Reliability, Scale‚Ä¶)</li><li>NFRs as architecture drivers ‚Äî not afterthoughts</li></ul></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-yellow p-3 rounded-3 h-100"><h6 class="fw-bold">üìà Scaling</h6><ul class="mb-0 ps-3"><li>Vertical: simple, limited, SPOF risk</li><li>Horizontal: unlimited, stateless required</li><li>When to use each per system tier</li></ul></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-purple p-3 rounded-3 h-100"><h6 class="fw-bold">‚öñÔ∏è Load Balancing</h6><ul class="mb-0 ps-3"><li>L4 (TCP/IP) vs L7 (HTTP/content-aware)</li><li>6 algorithms incl. Consistent Hashing</li><li>Health checks, SSL termination, sticky sessions</li></ul></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-teal p-3 rounded-3 h-100"><h6 class="fw-bold">‚ö° Caching</h6><ul class="mb-0 ps-3"><li>4 layers: Client ‚Üí CDN ‚Üí App ‚Üí DB</li><li>Eviction: LRU, LFU, TTL, Write-Through</li><li>Cache stampede &amp; invalidation pitfalls</li></ul></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-pink p-3 rounded-3 h-100"><h6 class="fw-bold">üóÑÔ∏è DB Sharding &amp; Replication</h6><ul class="mb-0 ps-3"><li>Sharding: Range, Hash, Directory-based</li><li>Replication: Single-Leader, Multi-Leader, Quorum</li><li>Hot shards, cross-shard queries, resharding</li></ul></div></div>
          </div>
        </section>

        <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ WHAT IS SYSTEM DESIGN ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
        <section id="what-is-sd" role="article">
          <h1>üéØ What is System Design?</h1>
          <span class="badge">problem framing</span> <span class="badge">requirements</span> <span class="badge">basics</span>

          <h2>Introduction</h2>
          <p><strong>System Design</strong> is the process of defining the <em>architecture, components, interfaces, and data flows</em> of a system to satisfy specified requirements. It is the discipline that bridges business goals with technical execution ‚Äî taking a problem statement and turning it into a blueprint that a team of engineers can build and operate reliably at scale.</p>
          <p>Unlike coding problems (where there is one correct answer), system design is deliberately open-ended. The goal is to demonstrate <strong>structured thinking, trade-off analysis, and clear communication</strong> ‚Äî not to produce a perfect system in 45 minutes.</p>

          <div class="callout">
            <strong>üí° Why System Design Skills Matter</strong>
            <ul>
              <li>‚úÖ <strong>Senior Engineering Interviews:</strong> System design is the primary evaluation dimension for Staff+ and Principal engineers</li>
              <li>‚úÖ <strong>Real-World Architecture:</strong> Every production service starts with a design document ‚Äî learning this skill translates directly to your daily work</li>
              <li>‚úÖ <strong>Avoiding Costly Mistakes:</strong> A bad architectural decision found in design costs minutes to fix; the same mistake found in production costs weeks</li>
              <li>‚úÖ <strong>Team Alignment:</strong> A shared design creates alignment across engineering, product, and infrastructure before a single line of code is written</li>
            </ul>
          </div>

          <h2>The System Design Framework</h2>
          <p>Use this repeatable 4-step framework for any design problem:</p>
          <div class="row g-3">
            <div class="col-md-6"><div class="card border-0 bg-gradient-blue p-3 rounded-3">
              <strong>Step 1 ‚Äî Clarify Requirements</strong>
              <ul class="mt-2 mb-0 ps-3">
                <li>Who are the users and what do they need?</li>
                <li>What is the expected scale? (users, QPS, data volume)</li>
                <li>What are the constraints? (latency, budget, compliance)</li>
                <li>What is <em>out of scope</em>? (equally important)</li>
              </ul>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-green p-3 rounded-3">
              <strong>Step 2 ‚Äî Estimate Scale</strong>
              <ul class="mt-2 mb-0 ps-3">
                <li>QPS = DAU √ó actions per day √∑ 86,400</li>
                <li>Storage = rows/day √ó avg row size √ó retention days</li>
                <li>Bandwidth = read QPS √ó avg response size</li>
                <li>Memory = hot data % √ó total data size</li>
              </ul>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-yellow p-3 rounded-3">
              <strong>Step 3 ‚Äî High-Level Design</strong>
              <ul class="mt-2 mb-0 ps-3">
                <li>Draw the major components: API, DB, Cache, Queue, CDN</li>
                <li>Identify data flows end-to-end for the primary use case</li>
                <li>Make technology choices: SQL vs NoSQL, sync vs async</li>
                <li>Define the API surface (REST, GraphQL, gRPC)</li>
              </ul>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-purple p-3 rounded-3">
              <strong>Step 4 ‚Äî Deep Dive</strong>
              <ul class="mt-2 mb-0 ps-3">
                <li>Database schema, indexing strategy, and query patterns</li>
                <li>API contracts, auth/authz, and error handling</li>
                <li>Identify bottlenecks and propose mitigations</li>
                <li>Handle failure modes: retries, timeouts, circuit breakers</li>
              </ul>
            </div></div>
          </div>

          <h2>Back-of-Envelope Estimation Cheat Sheet</h2>
          <div class="table-responsive">
            <table class="table table-bordered table-striped">
              <thead><tr><th>Metric</th><th>Formula</th><th>Quick Reference</th></tr></thead>
              <tbody>
                <tr><td><strong>Queries per Second (QPS)</strong></td><td>DAU √ó daily actions √∑ 86,400</td><td>100M DAU √ó 10 actions = ~11,500 QPS</td></tr>
                <tr><td><strong>Storage per Year</strong></td><td>Daily writes √ó size per record √ó 365</td><td>1M posts/day √ó 1 KB = ~365 GB/year</td></tr>
                <tr><td><strong>Cache Memory Needed</strong></td><td>20% of data serves 80% of requests (Pareto)</td><td>100 GB total data ‚Üí ~20 GB cache covers most reads</td></tr>
                <tr><td><strong>Bandwidth (Read)</strong></td><td>Read QPS √ó avg response size</td><td>10K QPS √ó 10 KB = 100 MB/s egress</td></tr>
                <tr><td><strong>Latency Targets</strong></td><td>p50 / p95 / p99 percentiles</td><td>p99 &lt; 500ms for interactive; &lt; 50ms for real-time</td></tr>
              </tbody>
            </table>
          </div>

          <h2>Common Mistakes</h2>
          <div class="row g-3">
            <div class="col-md-4"><div class="card border-0 bg-gradient-red p-3 rounded-3 h-100"><strong>‚ùå Jumping to Solutions</strong><p class="mt-1 mb-0"><small>Starting to draw components before clarifying requirements. Always pause to ask questions first ‚Äî it demonstrates senior-level thinking.</small></p></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-red p-3 rounded-3 h-100"><strong>‚ùå Ignoring Scale</strong><p class="mt-1 mb-0"><small>Designing a system for 100 users that needs to serve 100 million. Estimation shapes every technology choice you make.</small></p></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-red p-3 rounded-3 h-100"><strong>‚ùå No Trade-off Discussion</strong><p class="mt-1 mb-0"><small>Stating "Confirming Kafka" without explaining why vs SQS or a direct DB write.</small></p></div></div>
          </div>

        </section>

        <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ FUNCTIONAL VS NFRS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
        <section id="functional-nfr" role="article">
          <h1>üìã Functional vs Non-Functional Requirements</h1>
          <span class="badge">nfr</span> <span class="badge">functional</span> <span class="badge">requirements</span>

          <h2>Introduction</h2>
          <p>Every system design begins by separating <strong>what the system must do</strong> (functional requirements) from <strong>how well it must do it</strong> (non-functional requirements). This distinction is fundamental ‚Äî it prevents teams from building the <em>right thing the wrong way</em>.</p>
          <p>Functional requirements describe <em>features and behaviours</em>: user login, file upload, message delivery. Non-functional requirements (NFRs) describe <em>quality attributes</em>: latency, availability, security, cost. The critical insight is that <strong>NFRs are the true architecture drivers</strong> ‚Äî they determine whether you use a queue or a direct call, a relational or a NoSQL database, a monolith or microservices.</p>

          <div class="callout">
            <strong>üí° Why NFRs Drive Architecture</strong>
            <ul>
              <li>‚úÖ <strong>Availability dictates topology:</strong> 99.9% uptime allows a single region; 99.999% demands multi-region active-active</li>
              <li>‚úÖ <strong>Latency dictates data placement:</strong> &lt;50ms p99 forces in-memory caching; &lt;200ms allows remote DB reads</li>
              <li>‚úÖ <strong>Throughput dictates messaging:</strong> 1M events/sec demands Kafka; 1K/sec is fine with a simple queue</li>
              <li>‚úÖ <strong>Compliance dictates geography:</strong> GDPR requires EU data residency regardless of performance cost</li>
              <li>‚úÖ <strong>Cost dictates trade-offs:</strong> Premium infrastructure for SLAs has a price ‚Äî always acknowledge it</li>
            </ul>
          </div>

          <h2>Functional vs Non-Functional: Side-by-Side</h2>
          <div class="table-responsive mt-3">
            <table class="table table-bordered table-striped">
              <thead><tr><th>Dimension</th><th>Functional Requirements</th><th>Non-Functional Requirements (NFRs)</th></tr></thead>
              <tbody>
                <tr><td><strong>Definition</strong></td><td>Features &amp; behaviours the system performs</td><td>Quality attributes the system must exhibit</td></tr>
                <tr><td><strong>Examples</strong></td><td>User login, send message, upload file, search products</td><td>99.9% availability, &lt;200ms p99 latency, GDPR compliance</td></tr>
                <tr><td><strong>Drives</strong></td><td>API design, data models, business workflows</td><td>Infrastructure choices, architecture patterns, SLAs</td></tr>
                <tr><td><strong>Testable?</strong></td><td>‚úÖ Unit &amp; integration tests</td><td>‚úÖ Load tests, chaos tests, security audits</td></tr>
                <tr><td><strong>Who defines?</strong></td><td>Product team, business stakeholders</td><td>Engineering, infrastructure, legal/compliance</td></tr>
                <tr><td><strong>When do they bite?</strong></td><td>During development</td><td>In production ‚Äî often catastrophically if ignored</td></tr>
              </tbody>
            </table>
          </div>

          <h2>The 6 NFR Categories</h2>
          <p>When gathering requirements, systematically probe each of these 6 dimensions. Missing even one can lead to a fundamentally broken design:</p>
          <div class="row g-3">
            <div class="col-md-4"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100"><strong>‚ö° Performance</strong><ul class="mt-1 mb-0 ps-3"><li>Latency targets: p50, p95, p99</li><li>Throughput: RPS, QPS, TPS</li><li>Response time SLOs per endpoint</li><li><small class="text-muted">‚Ü≥ Drives: caching, indexing, CDN</small></li></ul></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100"><strong>üõ°Ô∏è Reliability</strong><ul class="mt-1 mb-0 ps-3"><li>Availability: 99.9% = only 8.7h/yr downtime</li><li>Fault tolerance &amp; graceful degradation</li><li>RTO (recovery time) &amp; RPO (data loss)</li><li><small class="text-muted">‚Ü≥ Drives: replication, failover, chaos tests</small></li></ul></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-yellow p-3 rounded-3 h-100"><strong>üìà Scalability</strong><ul class="mt-1 mb-0 ps-3"><li>Handle 10√ó traffic spikes without config changes</li><li>Horizontal scale-out vs vertical scale-up</li><li>Data volume growth projection over 5 years</li><li><small class="text-muted">‚Ü≥ Drives: stateless design, sharding, auto-scaling</small></li></ul></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-purple p-3 rounded-3 h-100"><strong>üîí Security</strong><ul class="mt-1 mb-0 ps-3"><li>AuthN (who are you?) &amp; AuthZ (what can you do?)</li><li>Encryption at rest &amp; in transit (TLS 1.3+)</li><li>Compliance: GDPR, HIPAA, SOC2, PCI-DSS</li><li><small class="text-muted">‚Ü≥ Drives: Zero Trust, secrets management, WAF</small></li></ul></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-teal p-3 rounded-3 h-100"><strong>üîß Maintainability</strong><ul class="mt-1 mb-0 ps-3"><li>MTTR: mean time to resolve incidents</li><li>Deployment frequency &amp; change failure rate</li><li>Observability: logs, metrics, distributed traces</li><li><small class="text-muted">‚Ü≥ Drives: CI/CD, feature flags, runbooks</small></li></ul></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-pink p-3 rounded-3 h-100"><strong>üí∞ Cost</strong><ul class="mt-1 mb-0 ps-3"><li>Cloud spend per request / per active user</li><li>Infrastructure efficiency (CPU, memory utilisation)</li><li>Operational overhead (on-call burden, toil)</li><li><small class="text-muted">‚Ü≥ Drives: architecture simplicity, right-sizing</small></li></ul></div></div>
          </div>

          <h2>Availability Nines Reference</h2>
          <div class="table-responsive mt-2">
            <table class="table table-bordered table-striped">
              <thead><tr><th>Availability</th><th>Downtime / Year</th><th>Downtime / Month</th><th>Architecture Implication</th></tr></thead>
              <tbody>
                <tr><td>99% (two nines)</td><td>~87.6 hours</td><td>~7.3 hours</td><td>Single region; planned maintenance windows acceptable</td></tr>
                <tr><td>99.9% (three nines)</td><td>~8.7 hours</td><td>~43 minutes</td><td>Multi-AZ deployment with auto-failover required</td></tr>
                <tr><td>99.99% (four nines)</td><td>~52 minutes</td><td>~4.4 minutes</td><td>Multi-region active-passive; fast automated failover</td></tr>
                <tr><td>99.999% (five nines)</td><td>~5.3 minutes</td><td>~26 seconds</td><td>Multi-region active-active; zero-downtime deploys mandatory</td></tr>
              </tbody>
            </table>
          </div>

          <div class="callout mt-3">üí° NFRs are <strong>architecture drivers, not afterthoughts</strong>. A 99.999% availability requirement produces a fundamentally different ‚Äî and dramatically more expensive ‚Äî system than 99.9%. Always surface the cost of each NFR explicitly to stakeholders before the architecture is frozen.</div>
        </section>

        <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ SCALING ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
        <section id="scaling" role="article">
          <h1>üìà Designing for Scale: Horizontal vs Vertical Scaling</h1>
          <span class="badge">scale</span> <span class="badge">horizontal</span> <span class="badge">vertical</span>

          <h2>Introduction</h2>
          <p>Scaling is the ability of a system to handle <strong>growing load</strong> ‚Äî more users, more data, more requests ‚Äî while maintaining acceptable performance. Scaling decisions are among the most consequential in system design because they affect <em>cost, complexity, and operational burden</em> for years to come.</p>
          <p>There are two fundamental strategies: <strong>vertical scaling</strong> (making individual nodes bigger) and <strong>horizontal scaling</strong> (adding more nodes). In practice, every production system uses both ‚Äî the art is knowing <em>which strategy to apply to which tier</em> at each stage of growth.</p>

          <div class="callout">
            <strong>‚ö†Ô∏è Why Scaling Decisions Are Hard to Reverse</strong>
            <ul>
              <li>‚úÖ <strong>Stateful vs Stateless:</strong> Storing session data in-process makes horizontal scaling impossible without re-architecture</li>
              <li>‚úÖ <strong>Database choice:</strong> Relational DBs scale vertically by default ‚Äî retrofitting horizontal sharding later is extremely expensive</li>
              <li>‚úÖ <strong>Cost curves:</strong> Vertical scaling costs grow super-linearly (4√ó RAM costs more than 4√ó the price) ‚Äî horizontal is typically cheaper at scale</li>
              <li>‚úÖ <strong>Operational complexity:</strong> Distributed systems require consensus, consistency protocols, and network-aware design from day one</li>
            </ul>
          </div>

          <h2>Vertical vs Horizontal: The Trade-offs</h2>
          <div class="mermaid">
graph TD
    subgraph Vertical["üîº Vertical Scaling (Scale Up)"]
        V1["üíª Single Server<br/>4 CPU, 8GB RAM"] -->|"Upgrade"| V2["üíªüí™ Same Server<br/>16 CPU, 64GB RAM"]
        V2 -->|"Upgrade Again"| V3["üíªüí™üí™ Same Server<br/>64 CPU, 256GB RAM"]
        V3 -.->|"Hardware Limit"| VLimit["‚ö†Ô∏è Max Instance Size<br/>(e.g., 128 vCPU)"]
    end
    
    subgraph Horizontal["‚û°Ô∏è Horizontal Scaling (Scale Out)"]
        LB["‚öñÔ∏è Load Balancer"]
        LB --> H1["üíª Server 1<br/>4 CPU, 8GB"]
        LB --> H2["üíª Server 2<br/>4 CPU, 8GB"]
        LB --> H3["üíª Server 3<br/>4 CPU, 8GB"]
        LB --> H4["üíª Server N<br/>4 CPU, 8GB"]
        H4 -.->|"Add more servers"| HMore["‚ûï Near-infinite<br/>scalability"]
    end
    
    User1["üë§ Limited Users"] -.->|"Single node<br/>bottleneck"| V3
    User2["üë• Unlimited Users"] -.->|"Distributed<br/>across fleet"| LB
    
    style V1 fill:#fef3c7,stroke:#f59e0b
    style V2 fill:#fed7aa,stroke:#ea580c
    style V3 fill:#fecaca,stroke:#dc2626,stroke-width:2px
    style VLimit fill:#fee2e2,stroke:#dc2626,stroke-width:3px,stroke-dasharray: 5 5
    style H1 fill:#dbeafe,stroke:#3b82f6
    style H2 fill:#dbeafe,stroke:#3b82f6
    style H3 fill:#dbeafe,stroke:#3b82f6
    style H4 fill:#dbeafe,stroke:#3b82f6
    style HMore fill:#dcfce7,stroke:#10b981,stroke-width:3px
    style LB fill:#dcfce7,stroke:#10b981,stroke-width:3px
          </div>
          <div class="row g-3 mt-3">
            <div class="col-md-6"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100">
              <h6 class="fw-bold">‚¨ÜÔ∏è Vertical Scaling (Scale-Up)</h6>
              <p class="mb-2">Add more CPU, RAM, or storage to a <em>single machine</em>. The application sees a bigger, faster server with no code changes.</p>
              <ul class="mb-0 ps-3">
                <li>‚úÖ Simple ‚Äî no application changes required</li>
                <li>‚úÖ No distributed systems complexity</li>
                <li>‚úÖ Strong consistency without coordination</li>
                <li>‚ùå Hard ceiling ‚Äî limited by the biggest instance type</li>
                <li>‚ùå Single point of failure (SPOF)</li>
                <li>‚ùå Downtime required during hardware upgrades</li>
                <li>‚ùå Cost grows super-linearly at extreme sizes</li>
              </ul>
              <div class="mt-2"><span class="badge bg-primary">Best for: relational DBs, ML models, legacy apps</span></div>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100">
              <h6 class="fw-bold">‚ÜîÔ∏è Horizontal Scaling (Scale-Out)</h6>
              <p class="mb-2">Add more <em>instances</em> and distribute load across them. Each node handles a fraction of total traffic.</p>
              <ul class="mb-0 ps-3">
                <li>‚úÖ Theoretically unlimited scale</li>
                <li>‚úÖ Fault tolerant ‚Äî one node fails, others serve traffic</li>
                <li>‚úÖ Cost-efficient using commodity hardware</li>
                <li>‚úÖ Zero-downtime deployments (rolling updates)</li>
                <li>‚ùå Application must be stateless (no local session state)</li>
                <li>‚ùå Adds distributed systems complexity</li>
                <li>‚ùå Requires load balancing infrastructure</li>
              </ul>
              <div class="mt-2"><span class="badge bg-success">Best for: web servers, API services, microservices</span></div>
            </div></div>
          </div>

          <h2>When to Choose What</h2>
          <div class="table-responsive">
            <table class="table table-bordered table-striped">
              <thead><tr><th>Scenario</th><th>Recommended Strategy</th><th>Reason</th></tr></thead>
              <tbody>
                <tr><td>Relational DB (OLTP)</td><td>Vertical ‚Üí Read Replicas ‚Üí Sharding</td><td>Hard to shard SQL; start simple and scale gradually</td></tr>
                <tr><td>Stateless REST / GraphQL API</td><td>Horizontal (auto-scaling)</td><td>Completely stateless ‚Äî trivial to add nodes behind a load balancer</td></tr>
                <tr><td>Message queue workers / consumers</td><td>Horizontal (consumer groups)</td><td>Scale consumer count based on queue depth metrics</td></tr>
                <tr><td>ML model serving</td><td>Vertical (GPU nodes) + Horizontal</td><td>GPU memory requirements are fixed per model; replicate for throughput</td></tr>
                <tr><td>In-memory cache (Redis)</td><td>Vertical first ‚Üí Redis Cluster</td><td>Latency-sensitive; RAM is the bottleneck ‚Äî cluster when RAM limit is hit</td></tr>
                <tr><td>NoSQL (Cassandra, DynamoDB)</td><td>Horizontal (native)</td><td>Built for horizontal scale; sharding is built into the data model</td></tr>
                <tr><td>Search engine (Elasticsearch)</td><td>Horizontal (shards + replicas)</td><td>Shard splits index across nodes for parallel query execution</td></tr>
              </tbody>
            </table>
          </div>

          <h2>The Scaling Ladder</h2>
          <div class="row g-3">
            <div class="col-md-4"><div class="card border-0 bg-gradient-yellow p-3 rounded-3 h-100"><strong>üîÄ Step 1 ‚Äî Read Replicas</strong><p class="mt-1 mb-0"><small>Redirect read traffic to replicas; primary handles writes only. Cheap first step before sharding. Watch for replication lag causing stale reads.</small></p></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-purple p-3 rounded-3 h-100"><strong>‚ö° Step 2 ‚Äî Caching Layer</strong><p class="mt-1 mb-0"><small>Add Redis/Memcached in front of the DB. Serves 80% of reads from memory ‚Äî reduces DB load drastically without schema changes.</small></p></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-teal p-3 rounded-3 h-100"><strong>üìä Step 3 ‚Äî Database Sharding</strong><p class="mt-1 mb-0"><small>Distribute data across multiple DB nodes. Last resort ‚Äî adds cross-shard query complexity and makes schema migrations hard. Never shard prematurely.</small></p></div></div>
          </div>

          <h2>Auto-Scaling Strategies &amp; Metrics</h2>
          <div class="row g-3 mt-1">
            <div class="col-md-4"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100">
              <h6 class="fw-bold">üìä Metric-Based Auto-Scaling</h6>
              <ul class="mb-0 ps-3">
                <li><strong>CPU-based:</strong> Scale out at 70% CPU; scale in at 30% ‚Äî most common but can lag</li>
                <li><strong>Queue depth:</strong> Scale workers when SQS depth &gt; 1000; ideal for async processing</li>
                <li><strong>Request rate:</strong> Scale at 1000 RPS per instance ‚Äî predictable capacity planning</li>
                <li><strong>Custom metrics:</strong> Memory pressure, connection pool saturation, p95 latency &gt; threshold</li>
              </ul>
            </div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100">
              <h6 class="fw-bold">‚è∞ Schedule-Based Auto-Scaling</h6>
              <ul class="mb-0 ps-3">
                <li><strong>Predictable patterns:</strong> E-commerce scales up 9am-9pm weekdays, down at night</li>
                <li><strong>Batch processing:</strong> 10 instances during nightly ETL; 2 instances during day</li>
                <li><strong>Event-driven:</strong> Scale ahead of known traffic spikes (Black Friday, product launches)</li>
                <li><strong>Time zones matter:</strong> Global apps scale different regions at different local peak hours</li>
              </ul>
            </div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-yellow p-3 rounded-3 h-100">
              <h6 class="fw-bold">‚öôÔ∏è Auto-Scaling Best Practices</h6>
              <ul class="mb-0 ps-3">
                <li><strong>Cooldown period:</strong> Wait 5 min after scale-out before evaluating again ‚Äî prevents flapping</li>
                <li><strong>Min/max bounds:</strong> Always set limits to prevent runaway scaling costs</li>
                <li><strong>Warm-up time:</strong> Account for application start time; pre-warm instances for predictable spikes</li>
                <li><strong>Scale out fast, scale in slow:</strong> Add capacity quickly; remove slowly to avoid thrashing</li>
              </ul>
            </div></div>
          </div>

          <div class="callout mt-3">üí° <strong>The Scaling Ladder:</strong> Single node ‚Üí Read replicas ‚Üí Caching ‚Üí Async workers ‚Üí Sharding. Climb one rung at a time. Most systems never need to reach sharding ‚Äî premature horizontal scaling creates distributed complexity without proportional business benefit.</div>
        </section>

        <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ LOAD BALANCING ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
        <section id="load-balancing" role="article">
          <h1>‚öñÔ∏è Load Balancing Strategies</h1>
          <span class="badge">load balancing</span> <span class="badge">round-robin</span> <span class="badge">consistent hashing</span>

          <h2>Introduction</h2>
          <p>A <strong>Load Balancer</strong> is the traffic controller of your system ‚Äî it distributes incoming requests across multiple backend servers to <em>maximise availability, throughput, and resource utilisation</em> while preventing any single node from being overwhelmed. It is the component that makes horizontal scaling possible.</p>
          <p>Without a load balancer, adding more servers is pointless: all traffic still hits a single endpoint. With one, you can scale horizontally, deploy zero-downtime releases, and route traffic away from unhealthy nodes automatically.</p>

          <div class="callout">
            <strong>üí° What Load Balancers Enable</strong>
            <ul>
              <li>‚úÖ <strong>High Availability:</strong> Remove unhealthy nodes from rotation automatically via health checks</li>
              <li>‚úÖ <strong>Horizontal Scale:</strong> Add/remove nodes without changing client configuration</li>
              <li>‚úÖ <strong>Zero-Downtime Deploys:</strong> Rolling deployments drain connections from old nodes before terminating them</li>
              <li>‚úÖ <strong>SSL Termination:</strong> Offload TLS decryption from application servers to the load balancer</li>
              <li>‚úÖ <strong>Observability:</strong> Centralised access logs, request metrics, and connection counts in one place</li>
            </ul>
          </div>

          <h2>L4 vs L7 Load Balancers</h2>
          <div class="row g-3 mt-1">
            <div class="col-md-6"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100">
              <strong>L4 Load Balancing (Transport Layer)</strong>
              <ul class="mt-2 mb-0 ps-3">
                <li>Routes based on IP address + TCP/UDP port only</li>
                <li>No inspection of packet content ‚Äî treats TCP as a byte stream</li>
                <li>Ultra-low latency; maximum raw throughput</li>
                <li>Cannot route based on URL path, headers, or cookies</li>
                <li><strong>Examples:</strong> AWS NLB, HAProxy TCP mode, IPVS</li>
              </ul>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100">
              <strong>L7 Load Balancing (Application Layer)</strong>
              <ul class="mt-2 mb-0 ps-3">
                <li>Routes based on HTTP headers, URL path, cookies, or body content</li>
                <li>Supports content-based routing: <code>/api</code> ‚Üí Service A, <code>/images</code> ‚Üí CDN</li>
                <li>Enables A/B testing, canary deploys, and sticky sessions</li>
                <li>Slightly higher latency due to protocol parsing overhead</li>
                <li><strong>Examples:</strong> AWS ALB, Nginx, Envoy, Traefik</li>
              </ul>
            </div></div>
          </div>

          <h2>Load Balancing Algorithms</h2>
          <div class="mermaid">
graph LR
    Client["üë§ Client"] --> LB["‚öñÔ∏è Load Balancer"]
    LB -->|Round-Robin| S1["üñ•Ô∏è Server 1"]
    LB -->|Round-Robin| S2["üñ•Ô∏è Server 2"]
    LB -->|Round-Robin| S3["üñ•Ô∏è Server 3"]
    
    style LB fill:#dbeafe,stroke:#3b82f6,stroke-width:3px
    style S1 fill:#dcfce7,stroke:#10b981
    style S2 fill:#dcfce7,stroke:#10b981
    style S3 fill:#dcfce7,stroke:#10b981
    style Client fill:#fef3c7,stroke:#f59e0b
          </div>
          <div class="table-responsive mt-3">
            <table class="table table-bordered table-striped">
              <thead><tr><th>Algorithm</th><th>How it works</th><th>Best for</th><th>Watch out for</th></tr></thead>
              <tbody>
                <tr><td><strong>Round-Robin</strong></td><td>Rotates requests 1‚Üí2‚Üí3‚Üí1‚Üí2‚Ä¶</td><td>Stateless services with equal capacity nodes</td><td>Ignores current server load ‚Äî may hit an already-busy node</td></tr>
                <tr><td><strong>Weighted Round-Robin</strong></td><td>Sends more requests to higher-weight nodes proportionally</td><td>Mixed instance sizes (2√ó instance gets 2√ó traffic)</td><td>Weights must be updated manually as capacity changes</td></tr>
                <tr><td><strong>Least Connections</strong></td><td>Route to server with fewest active connections</td><td>Long-lived connections: WebSocket, gRPC streaming</td><td>Requires LB to track per-server connection count</td></tr>
                <tr><td><strong>IP Hash</strong></td><td>hash(client IP) ‚Üí always routes to the same server</td><td>Session stickiness without a distributed session store</td><td>Uneven distribution if client IP space is not diverse</td></tr>
                <tr><td><strong>Consistent Hashing</strong></td><td>Hash ring ‚Äî only K/N keys remapped when nodes change</td><td>Distributed caches, Cassandra, DynamoDB-style DBs</td><td>Hot spots with skewed keys; mitigate with virtual nodes</td></tr>
                <tr><td><strong>Least Response Time</strong></td><td>Route to the fastest-responding server</td><td>Heterogeneous hardware with mixed latency profiles</td><td>Requires LB to track response time per server continuously</td></tr>
                <tr><td><strong>Random</strong></td><td>Pick a random backend node per request</td><td>Simplest deployments with equal-capacity nodes</td><td>No guarantee of even distribution over small windows</td></tr>
              </tbody>
            </table>
          </div>

          <h2>Health Checks &amp; Failure Detection</h2>
          <div class="row g-3">
            <div class="col-md-4"><div class="card border-0 bg-gradient-yellow p-3 rounded-3 h-100"><strong>üîç Active Health Checks</strong><p class="mt-1 mb-0"><small>LB periodically probes a <code>/health</code> endpoint (HTTP 200 = healthy). Removes node on N consecutive failures; returns it after M successful checks. Small overhead but precise control.</small></p></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-purple p-3 rounded-3 h-100"><strong>üìä Passive Health Checks</strong><p class="mt-1 mb-0"><small>Monitor actual request success/error rates in real traffic. Mark a node unhealthy if its error rate exceeds a threshold. Zero extra protocol overhead ‚Äî reacts to real failures.</small></p></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-teal p-3 rounded-3 h-100"><strong>üîÑ Connection Draining</strong><p class="mt-1 mb-0"><small>When removing a node (deploy or failure), stop sending new requests but allow existing connections to complete gracefully. Prevents in-flight request drops and 502 errors.</small></p></div></div>
          </div>

          <div class="callout mt-3">üí° <strong>Consistent Hashing</strong> is the key algorithm for distributed caches. In a standard hash ring with N nodes, adding or removing one node remaps only ~K/N keys ‚Äî compared to remapping <em>all keys</em> with naive modular hashing. Virtual nodes (vnodes) ensure even distribution even when physical nodes have different capacities.</div>

          <h2>Consistent Hashing Deep Dive</h2>
          <p class="mt-3">Traditional modular hashing <code>(hash(key) % N)</code> has a fatal flaw: when you change N (add or remove a node), <strong>all keys are remapped</strong>. For a cache with 1 million keys and 10 nodes, adding one node causes ~909K keys to move to different nodes ‚Äî a massive cache miss storm.</p>
          <p><strong>Consistent Hashing</strong> solves this with a hash ring: both keys and nodes are hashed to positions on a virtual ring (0 to 2^32-1). Each key is served by the first node encountered when moving clockwise around the ring. When you add or remove a node, only <strong>K/N keys</strong> are remapped ‚Äî the theoretical minimum.</p>

          <div class="mermaid-container mt-2">
            <pre class="mermaid">
graph TB
    subgraph Ring["üîÑ Hash Ring (0 to 2¬≥¬≤-1)"]
        direction TB
        
        subgraph TopHalf["Clockwise Direction ‚Üí"]
            A["üü¢ Node A<br/>hash(A) = 400M"]
            K1["üîë key1<br/>hash = 500M"]
            B["üü¢ Node B<br/>hash(B) = 800M"]
        end
        
        subgraph BottomHalf["‚Üê Clockwise Direction"]
            K2["üîë key2<br/>hash = 1.5B"]
            C["üü¢ Node C<br/>hash(C) = 2B"]
            K3["üîë key3<br/>hash = 100M"]
        end
        
        A -->|"Clockwise lookup"| K1
        K1 -->|"Nearest node clockwise"| B
        B --> K2
        K2 --> C
        C --> K3
        K3 -->|"Wraps to start"| A
    end
    
    K1 -.->|"Served by"| B
    K2 -.->|"Served by"| C
    K3 -.->|"Served by"| A
    
    subgraph VNodes["üî∑ Virtual Nodes (VNodes) Solution"]
        VA1["A-vnode-1"]
        VA2["A-vnode-2"]
        VA3["A-vnode-3"]
        VB1["B-vnode-1"]
        VB2["B-vnode-2"]
        VB3["B-vnode-3"]
        
        Note1["Each physical node<br/>gets 100-200 vnodes<br/>spread evenly on ring"]
    end
    
    VA1 & VA2 & VA3 -.->|"All map to"| PA["Physical Node A"]
    VB1 & VB2 & VB3 -.->|"All map to"| PB["Physical Node B"]
    
    style A fill:#10b981,stroke:#059669,stroke-width:2px,color:#fff
    style B fill:#10b981,stroke:#059669,stroke-width:2px,color:#fff
    style C fill:#10b981,stroke:#059669,stroke-width:2px,color:#fff
    style K1 fill:#fbbf24,stroke:#f59e0b,stroke-width:2px
    style K2 fill:#fbbf24,stroke:#f59e0b,stroke-width:2px
    style K3 fill:#fbbf24,stroke:#f59e0b,stroke-width:2px
    style PA fill:#3b82f6,stroke:#2563eb,stroke-width:2px,color:#fff
    style PB fill:#3b82f6,stroke:#2563eb,stroke-width:2px,color:#fff
            </pre>
          </div>

          <h2>How Consistent Hashing Works</h2>
          <div class="row g-3 mt-2">
            <div class="col-md-4"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100">
              <h6 class="fw-bold">1Ô∏è‚É£ Hash the Nodes</h6>
              <p class="mb-2"><small>Hash each node identifier (IP, hostname) to a position on the ring (0 to 2¬≥¬≤-1).</small></p>
              <ul class="mb-0 ps-3">
                <li><small>Node A ‚Üí hash("nodeA") = 400,000,000</small></li>
                <li><small>Node B ‚Üí hash("nodeB") = 800,000,000</small></li>
                <li><small>Node C ‚Üí hash("nodeC") = 2,000,000,000</small></li>
              </ul>
              <p class="mb-0 mt-2"><small>Nodes are now positioned at specific points on the hash ring.</small></p>
            </div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100">
              <h6 class="fw-bold">2Ô∏è‚É£ Hash the Keys</h6>
              <p class="mb-2"><small>Hash each cache key to a position on the same ring.</small></p>
              <ul class="mb-0 ps-3">
                <li><small>key1 ‚Üí hash("key1") = 500,000,000</small></li>
                <li><small>key2 ‚Üí hash("key2") = 1,500,000,000</small></li>
                <li><small>key3 ‚Üí hash("key3") = 100,000,000</small></li>
              </ul>
              <p class="mb-0 mt-2"><small>Each key now has a specific position between existing nodes.</small></p>
            </div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-yellow p-3 rounded-3 h-100">
              <h6 class="fw-bold">3Ô∏è‚É£ Clockwise Lookup</h6>
              <p class="mb-2"><small>Each key is served by the <strong>first node encountered when moving clockwise</strong> from the key's position.</small></p>
              <ul class="mb-0 ps-3">
                <li><small>key1 (500M) ‚Üí clockwise ‚Üí Node B (800M)</small></li>
                <li><small>key2 (1.5B) ‚Üí clockwise ‚Üí Node C (2B)</small></li>
                <li><small>key3 (100M) ‚Üí clockwise ‚Üí Node A (400M)</small></li>
              </ul>
              <p class="mb-0 mt-2"><small>Keys are evenly distributed across nodes based on ring position.</small></p>
            </div></div>
          </div>

          <h2>What Happens When a Node is Added or Removed?</h2>
          <div class="row g-3 mt-2">
            <div class="col-md-6"><div class="card border-0 bg-gradient-teal p-3 rounded-3 h-100">
              <h6 class="fw-bold">‚ûï Adding Node D @ 1.2B</h6>
              <ul class="mb-0 ps-3">
                <li><strong>Before:</strong> key2 (1.5B) served by Node C (2B)</li>
                <li><strong>After:</strong> Node D inserted at 1.2B position</li>
                <li><strong>Result:</strong> key2 (1.5B) now served by Node D (1.2B ‚Üí closest clockwise)</li>
                <li><strong>Impact:</strong> Only keys between new node and previous node are remapped ‚Äî <strong>~25% of keys move</strong> (K/N where N=4)</li>
                <li><strong>Cache miss:</strong> Only those remapped keys experience a miss ‚Äî other keys remain cached</li>
              </ul>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-pink p-3 rounded-3 h-100">
              <h6 class="fw-bold">‚ûñ Removing Node B @ 800M</h6>
              <ul class="mb-0 ps-3">
                <li><strong>Before:</strong> key1 (500M) served by Node B (800M)</li>
                <li><strong>After:</strong> Node B removed from ring</li>
                <li><strong>Result:</strong> key1 (500M) ‚Üí next clockwise node = Node C (2B)</li>
                <li><strong>Impact:</strong> Only keys that were served by Node B are remapped to the next available node ‚Äî <strong>~33% of keys move</strong> (K/N where N=3)</li>
                <li><strong>Cache miss:</strong> Only keys previously on Node B miss; other keys unaffected</li>
              </ul>
            </div></div>
          </div>

          <h2>The Virtual Nodes (VNodes) Solution</h2>
          <div class="callout mt-3">
            <strong>‚ö†Ô∏è Problem with Basic Consistent Hashing:</strong> With only 3 physical nodes, one node might get 60% of keys while another gets 15% ‚Äî highly uneven distribution due to random hash positions. The solution: <strong>Virtual Nodes</strong>.
          </div>

          <div class="row g-3 mt-2">
            <div class="col-md-6"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100">
              <h6 class="fw-bold">üî∑ How Virtual Nodes Work</h6>
              <ul class="mb-0 ps-3">
                <li>Each physical node is hashed <strong>100-200 times</strong> to create virtual nodes (vnodes)</li>
                <li>Node A creates: hash("A-vnode-0"), hash("A-vnode-1"), ‚Ä¶, hash("A-vnode-99")</li>
                <li>Each vnode occupies a different position on the ring</li>
                <li>When a key lands on a vnode, it maps back to the physical node</li>
                <li><strong>Result:</strong> Keys are distributed evenly because each physical node has many positions</li>
              </ul>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100">
              <h6 class="fw-bold">‚úÖ Benefits of Virtual Nodes</h6>
              <ul class="mb-0 ps-3">
                <li><strong>Even distribution:</strong> With 150 vnodes per node, variance is &lt;2% ‚Äî nearly perfect load balance</li>
                <li><strong>Weighted nodes:</strong> Powerful server gets 200 vnodes, weaker gets 100 ‚Üí 2√ó the load automatically</li>
                <li><strong>Smooth key redistribution:</strong> When a node fails, its vnodes are spread across the ring ‚Äî burden distributed evenly to remaining nodes</li>
                <li><strong>Standard practice:</strong> Cassandra (default 256 vnodes), DynamoDB, Riak all use vnodes</li>
              </ul>
            </div></div>
          </div>

          <h2>Consistent Hashing in Production</h2>
          <div class="table-responsive mt-3">
            <table class="table table-bordered table-striped">
              <thead><tr><th>System</th><th>Use Case</th><th>VNodes</th><th>Why Consistent Hashing</th></tr></thead>
              <tbody>
                <tr><td><strong>Cassandra</strong></td><td>Distributed NoSQL database</td><td>256 (default)</td><td>Partition data across nodes; minimal data movement when adding/removing nodes</td></tr>
                <tr><td><strong>DynamoDB</strong></td><td>AWS managed NoSQL</td><td>Yes (internal)</td><td>Distribute partition keys across storage nodes; automatic scaling without resharding</td></tr>
                <tr><td><strong>Redis Cluster</strong></td><td>Distributed cache</td><td>16,384 hash slots</td><td>Shard keys across cluster nodes; support live resharding with minimal disruption</td></tr>
                <tr><td><strong>Memcached (libketama)</strong></td><td>Distributed cache</td><td>150-200 per node</td><td>Client-side consistent hashing to route keys to cache nodes without coordination</td></tr>
                <tr><td><strong>Akka Cluster Sharding</strong></td><td>Actor distribution</td><td>Yes (configurable)</td><td>Distribute actors evenly; rebalance on cluster membership changes</td></tr>
              </tbody>
            </table>
          </div>

          <div class="callout mt-3">üí° <strong>When NOT to Use Consistent Hashing:</strong> If your data access pattern has severe hotspots (celebrity user, viral content), consistent hashing cannot fix uneven load ‚Äî the hot key will always land on one node. Solutions: (1) <strong>Sub-shard hot keys</strong> ‚Äî append random suffix to distribute replicas, (2) <strong>Dedicated cache tier</strong> for hot keys, (3) <strong>Application-layer load balancing</strong> ‚Äî detect hot partition and route to oversized node.</div>
        </section>

        <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ CACHING ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
        <section id="caching" role="article">
          <h1>‚ö° Caching ‚Äî Speed Up Everything</h1>
          <span class="badge">cache</span> <span class="badge">cdn</span> <span class="badge">redis</span> <span class="badge">eviction</span>

          <h2>Introduction</h2>
          <p>Caching is the practice of <strong>storing frequently accessed data in a faster storage layer</strong> to reduce latency, protect backend systems, and dramatically increase throughput. The performance difference is staggering: an in-process cache lookup takes nanoseconds; a Redis read takes ~1ms; a PostgreSQL query takes 5‚Äì100ms; a remote API call takes 100ms+ ‚Äî up to 6 orders of magnitude difference.</p>
          <p>The fundamental cache challenge is not <em>getting</em> data into the cache ‚Äî it is <strong>knowing when to remove it</strong>. As Phil Karlton famously said: <em>"There are only two hard things in Computer Science: cache invalidation and naming things."</em></p>

          <div class="callout">
            <strong>üí° Why Caching Changes the Game</strong>
            <ul>
              <li>‚úÖ <strong>Latency:</strong> In-process = nanoseconds; Redis = ~1ms; DB query = 5‚Äì100ms ‚Äî orders of magnitude difference per request</li>
              <li>‚úÖ <strong>Throughput:</strong> A single Redis instance handles ~100K ops/sec; a typical DB handles ~5‚Äì10K QPS under load</li>
              <li>‚úÖ <strong>Pareto Rule:</strong> 20% of data is accessed 80% of the time ‚Äî cache the hot 20% and deflect 80% of DB traffic</li>
              <li>‚úÖ <strong>Cost:</strong> RAM is expensive per GB but reduces DB compute requirements dramatically ‚Äî often cheaper overall</li>
              <li>‚ö†Ô∏è <strong>Stale Data:</strong> Every cache is a freshness trade-off ‚Äî understand the business tolerance before choosing a TTL</li>
            </ul>
          </div>

          <h2>The 4 Caching Layers</h2>
          <div class="mermaid">
graph TB
    Client["üë§ Client<br/>(Browser/App Cache)"] -->|1. Check cache| CDN["üåê CDN / Edge Cache"]
    CDN -->|2. If miss| AppCache["üì¶ App-Level Cache<br/>(Redis/Memcached)"]
    AppCache -->|3. If miss| DBCache["üíæ DB Buffer Pool"]
    DBCache -->|4. If miss| Disk["üìÄ Disk Storage"]
    
    Disk -.->|Write-back| DBCache
    DBCache -.->|Populate| AppCache
    AppCache -.->|Populate| CDN
    CDN -.->|Populate| Client
    
    style Client fill:#dbeafe,stroke:#3b82f6,stroke-width:2px
    style CDN fill:#dcfce7,stroke:#10b981,stroke-width:2px
    style AppCache fill:#fef3c7,stroke:#f59e0b,stroke-width:2px
    style DBCache fill:#e9d5ff,stroke:#a855f7,stroke-width:2px
    style Disk fill:#fee2e2,stroke:#dc2626,stroke-width:2px
          </div>
          <div class="row g-3 mt-3">
            <div class="col-md-6"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100">
              <strong>1. Client-Side Cache</strong>
              <ul class="mt-1 mb-0 ps-3">
                <li>Browser cache, mobile app cache, service worker cache</li>
                <li>HTTP headers: <code>Cache-Control</code>, <code>ETag</code>, <code>Last-Modified</code>, <code>Expires</code></li>
                <li>‚úÖ Zero server cost for repeated requests from same client</li>
                <li>‚úÖ Works offline (service worker)</li>
                <li>‚ùå Stale data risk ‚Äî client controls invalidation timing</li>
                <li>‚ùå Not suitable for user-specific or sensitive data in shared caches</li>
              </ul>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100">
              <strong>2. CDN (Edge / Global Cache)</strong>
              <ul class="mt-1 mb-0 ps-3">
                <li>Caches static assets and cacheable responses close to users globally</li>
                <li>Points of Presence (PoPs) in 100+ cities worldwide</li>
                <li>Providers: CloudFront, Fastly, Akamai, Cloudflare</li>
                <li>‚úÖ Massive latency reduction for geographically distributed users</li>
                <li>‚úÖ Absorbs large traffic spikes without hitting the origin server</li>
                <li>‚ùå Only for idempotent, cacheable content (no personalisation)</li>
              </ul>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-yellow p-3 rounded-3 h-100">
              <strong>3. Application-Level Cache</strong>
              <ul class="mt-1 mb-0 ps-3">
                <li><strong>Local (in-process):</strong> Guava Cache, Caffeine, in-memory dictionary</li>
                <li><strong>Distributed:</strong> Redis, Memcached ‚Äî shared across service instances</li>
                <li>Cache DB query results, session data, computed values, access tokens</li>
                <li>‚úÖ ~1ms latency for Redis; nanosecond access for local cache</li>
                <li>‚ùå Cache invalidation coordination across services is hard</li>
                <li>‚ùå Local cache is per-instance ‚Äî stale during rolling deploys</li>
              </ul>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-purple p-3 rounded-3 h-100">
              <strong>4. Database-Level Cache</strong>
              <ul class="mt-1 mb-0 ps-3">
                <li>DB buffer pool (InnoDB buffer pool, PostgreSQL <code>shared_buffers</code>)</li>
                <li>Query plan cache; prepared statement caches</li>
                <li>Read replicas serve as scaled-out read caches</li>
                <li>‚úÖ Transparent to application layer ‚Äî no code changes</li>
                <li>‚ùå Limited control; may serve stale data silently</li>
                <li>‚ùå Read replicas have replication lag (eventual consistency)</li>
              </ul>
            </div></div>
          </div>

          <h2>Cache Write Strategies</h2>
          <div class="table-responsive mt-2">
            <table class="table table-bordered table-striped">
              <thead><tr><th>Strategy</th><th>How it works</th><th>Pros</th><th>Cons</th></tr></thead>
              <tbody>
                <tr><td><strong>Cache-Aside (Lazy Loading)</strong></td><td>App checks cache; on miss, loads from DB and populates cache explicitly</td><td>Only hot data in cache; resilient to cache failure</td><td>Cache miss penalty on cold start; stampede risk on popular misses</td></tr>
                <tr><td><strong>Write-Through</strong></td><td>Write to cache AND DB synchronously on every write</td><td>Cache always current; no stale reads ever</td><td>Write latency = cache + DB time; fills cache with infrequently read data</td></tr>
                <tr><td><strong>Write-Behind (Write-Back)</strong></td><td>Write to cache first; flush to DB asynchronously in batches</td><td>Ultra-low write latency; batching reduces DB write pressure</td><td>Data loss risk if cache fails before flush; complex to implement safely</td></tr>
                <tr><td><strong>Refresh-Ahead</strong></td><td>Proactively refresh cache before TTL expires based on predicted access</td><td>Eliminates cache miss latency for hot keys entirely</td><td>May cache infrequently used data; wasted compute for cold predictions</td></tr>
              </tbody>
            </table>
          </div>

          <h2>Eviction Policies</h2>
          <div class="row g-3">
            <div class="col-md-3"><div class="card border-0 bg-gradient-teal p-2 rounded-3 text-center h-100"><strong>LRU</strong><br/><small>Least Recently Used ‚Äî evict the key not accessed for the longest time. Most common; excellent for temporal locality patterns.</small></div></div>
            <div class="col-md-3"><div class="card border-0 bg-gradient-pink p-2 rounded-3 text-center h-100"><strong>LFU</strong><br/><small>Least Frequently Used ‚Äî evict the key accessed fewest times overall. Better for stable hot keys that should never leave cache.</small></div></div>
            <div class="col-md-3"><div class="card border-0 bg-gradient-blue p-2 rounded-3 text-center h-100"><strong>TTL</strong><br/><small>Time-To-Live ‚Äî expire after a fixed duration. Simple to reason about; guarantees freshness. Tune TTL to balance hit rate vs staleness.</small></div></div>
            <div class="col-md-3"><div class="card border-0 bg-gradient-green p-2 rounded-3 text-center h-100"><strong>FIFO / Random</strong><br/><small>First-In-First-Out or random eviction. Simplest to implement but lowest effective hit rate. Rarely used in production systems.</small></div></div>
          </div>

          <h2>Cache Invalidation Strategies</h2>
          <div class="row g-3 mt-2">
            <div class="col-md-6"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100">
              <h6 class="fw-bold">‚è±Ô∏è TTL-Based Invalidation</h6>
              <p class="mb-2"><small>Each cache entry expires after a fixed duration. Simplest and most predictable approach.</small></p>
              <ul class="mb-2 ps-3">
                <li><small><strong>Static content:</strong> 24 hours (product images, CSS/JS bundles)</small></li>
                <li><small><strong>Semi-static:</strong> 5‚Äì15 minutes (product catalog, user profiles)</small></li>
                <li><small><strong>Dynamic:</strong> 30‚Äì60 seconds (real-time inventory, live sports scores)</small></li>
                <li><small><strong>Probabilistic early expiry:</strong> Refresh with P% probability as TTL approaches to prevent stampede</small></li>
              </ul>
              <pre class="bg-dark text-light p-2 rounded" style="font-size:0.75rem;">// Redis TTL example
SET user:12345 "{...}" EX 300  // 5 min TTL</pre>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100">
              <h6 class="fw-bold">üì° Event-Driven Invalidation</h6>
              <p class="mb-2"><small>Invalidate cache entries immediately when the underlying data changes via pub/sub events.</small></p>
              <ul class="mb-2 ps-3">
                <li><small><strong>Precision:</strong> Cache stays fresh within milliseconds of data change</small></li>
                <li><small><strong>Complexity:</strong> Every write operation must publish invalidation events</small></li>
                <li><small><strong>Pattern:</strong> On <code>UserUpdated</code> event ‚Üí invalidate <code>user:{id}</code> cache key</small></li>
                <li><small><strong>Risk:</strong> Event loss or delay causes stale cache ‚Äî combine with TTL as a failsafe</small></li>
              </ul>
              <pre class="bg-dark text-light p-2 rounded" style="font-size:0.75rem;">// Pub/Sub invalidation
PUBLISH cache-invalidate "user:12345"</pre>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-yellow p-3 rounded-3 h-100">
              <h6 class="fw-bold">üîÑ Write-Through / Write-Behind</h6>
              <p class="mb-2"><small>Update the cache atomically with the database write ‚Äî cache never becomes stale.</small></p>
              <ul class="mb-0 ps-3">
                <li><small><strong>Write-Through:</strong> Write to DB and cache synchronously in a transaction ‚Äî cache always current, higher write latency</small></li>
                <li><small><strong>Write-Behind:</strong> Write to cache first, flush to DB asynchronously ‚Äî ultra-low latency, risk of data loss if cache crashes before flush</small></li>
                <li><small><strong>Best for:</strong> High-consistency requirements where stale reads are unacceptable</small></li>
                <li><small><strong>Trade-off:</strong> Cache is filled with all written data, not just hot data</small></li>
              </ul>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-purple p-3 rounded-3 h-100">
              <h6 class="fw-bold">üîí Cache Stampede Prevention</h6>
              <p class="mb-2"><small>When a popular key expires, prevent thousands of concurrent requests from hammering the DB to reload it.</small></p>
              <ul class="mb-0 ps-3">
                <li><small><strong>Single-Flight / Mutex:</strong> First request acquires a lock and fetches from DB; others wait for that result</small></li>
                <li><small><strong>Probabilistic early refresh:</strong> Refresh with 10% probability when TTL &lt; 20% remaining ‚Äî spreads refresh load</small></li>
                <li><small><strong>Staggered TTLs:</strong> Add ¬±10-20% jitter to TTL to prevent mass synchronized expiry (TTL = 300 ¬± 30 sec)</small></li>
                <li><small><strong>Serve stale:</strong> Allow serving expired cache entries while asynchronously refreshing in the background</small></li>
              </ul>
            </div></div>
          </div>

          <div class="callout mt-4">‚ö†Ô∏è <strong>Cache Stampede (Thundering Herd):</strong> When a popular cache key expires and thousands of concurrent requests race to reload it from the DB simultaneously. Mitigate with: (1) <strong>Probabilistic early expiry</strong> ‚Äî refresh with P% probability as TTL approaches, (2) <strong>Mutex / single-flight</strong> ‚Äî only one goroutine fetches; others wait on that result, (3) <strong>Staggered TTLs</strong> ‚Äî add random jitter (¬±10-20%) to prevent synchronised mass expiry.</div>
        </section>

        <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ DB SHARDING ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
        <section id="db-sharding" role="article">
          <h1>üóÑÔ∏è Database Sharding, Partitioning &amp; Replication</h1>
          <span class="badge">sharding</span> <span class="badge">partitioning</span> <span class="badge">replication</span>

          <h2>Introduction</h2>
          <p>When a single database node can no longer handle load or storage ‚Äî due to write throughput, data volume, or latency constraints ‚Äî you must distribute data across multiple nodes. There are two complementary techniques: <strong>sharding (partitioning)</strong> splits data horizontally across nodes for scale, while <strong>replication</strong> maintains copies of data across nodes for availability and read throughput.</p>
          <p>These are among the most operationally complex decisions in system design. The golden rule: <strong>do not shard prematurely</strong>. A single well-tuned Postgres node with read replicas handles most production workloads. Shard only when you have concrete evidence of a bottleneck that cannot be resolved with vertical scaling, caching, or read replicas.</p>

          <div class="callout">
            <strong>‚ö†Ô∏è Why This Is One of the Hardest Design Decisions</strong>
            <ul>
              <li>‚úÖ <strong>Data migration:</strong> Moving to a sharded architecture requires careful live data migration ‚Äî often the most stressful engineering event a team faces</li>
              <li>‚úÖ <strong>Schema changes:</strong> DDL operations (ALTER TABLE) must be executed across every shard individually with careful coordination</li>
              <li>‚úÖ <strong>Cross-shard queries:</strong> JOINs across shards are prohibitively expensive ‚Äî requires denormalisation or scatter-gather patterns</li>
              <li>‚úÖ <strong>Transactions:</strong> Distributed transactions (2PC) across shards introduce high latency and failure complexity</li>
              <li>‚úÖ <strong>Resharding:</strong> When you outgrow your shard count, redistributing data is a major multi-day operational event</li>
            </ul>
          </div>

          <h2>Sharding Strategies</h2>
          <div class="mermaid">
graph TB
    subgraph "Hash-Based Sharding"
        H["hash(userId) % 3"]
        H -->|user123 ‚Üí 0| HS1["Shard 0"]
        H -->|user456 ‚Üí 1| HS2["Shard 1"]
        H -->|user789 ‚Üí 2| HS3["Shard 2"]
    end
    
    subgraph "Range-Based Sharding"
        R["userId ranges"]
        R -->|1-1M| RS1["Shard 1<br/>(1-1M)"]
        R -->|1M-2M| RS2["Shard 2<br/>(1M-2M)"]
        R -->|2M-3M| RS3["Shard 3<br/>(2M-3M)"]
    end
    
    style H fill:#dbeafe,stroke:#3b82f6,stroke-width:2px
    style R fill:#dcfce7,stroke:#10b981,stroke-width:2px
    style HS1 fill:#fef3c7,stroke:#f59e0b
    style HS2 fill:#fef3c7,stroke:#f59e0b
    style HS3 fill:#fef3c7,stroke:#f59e0b
    style RS1 fill:#e9d5ff,stroke:#a855f7
    style RS2 fill:#e9d5ff,stroke:#a855f7
    style RS3 fill:#e9d5ff,stroke:#a855f7
          </div>
          <div class="row g-3 mt-3">
            <div class="col-md-6"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100">
              <h6 class="fw-bold">üìä Range-Based Sharding</h6>
              <p class="mb-2">Partition rows by contiguous value ranges: userId 1‚Äì1M ‚Üí shard 1, 1M‚Äì2M ‚Üí shard 2.</p>
              <ul class="mb-0 ps-3">
                <li>‚úÖ Range scans are efficient ‚Äî all rows in a range are co-located</li>
                <li>‚úÖ Simple to understand and reason about operationally</li>
                <li>‚ùå Hot shard risk: new users/records always go to the highest shard</li>
                <li>‚ùå Uneven distribution if usage is skewed across the range</li>
              </ul>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100">
              <h6 class="fw-bold">üîÄ Hash-Based Sharding</h6>
              <p class="mb-2">Apply hash(key) % N to determine the target shard for each row.</p>
              <ul class="mb-0 ps-3">
                <li>‚úÖ Even data and write load distribution across all nodes</li>
                <li>‚úÖ No hot shards under normal write patterns</li>
                <li>‚ùå Resharding is painful: changing N rehashes all keys, requiring full data move</li>
                <li>‚ùå Range queries now span shards ‚Äî must use scatter-gather</li>
              </ul>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-yellow p-3 rounded-3 h-100">
              <h6 class="fw-bold">üìã Directory-Based Sharding</h6>
              <p class="mb-2">A lookup service maps each key to its shard location, stored in a separate metadata store.</p>
              <ul class="mb-0 ps-3">
                <li>‚úÖ Maximum flexibility ‚Äî migrate individual keys between shards easily</li>
                <li>‚úÖ Can mix strategies per data type</li>
                <li>‚ùå The directory itself becomes a bottleneck and single point of failure</li>
                <li>‚ùå Adds an extra network hop to every read and write operation</li>
              </ul>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-purple p-3 rounded-3 h-100">
              <h6 class="fw-bold">üåç Consistent Hashing</h6>
              <p class="mb-2">Keys and nodes are placed on a circular hash ring. Each key routes to the nearest clockwise node.</p>
              <ul class="mb-0 ps-3">
                <li>‚úÖ Only K/N keys remapped when adding or removing a node</li>
                <li>‚úÖ Minimal disruption to existing data routing on topology changes</li>
                <li>‚úÖ Standard in Cassandra, DynamoDB, Redis Cluster</li>
                <li>‚ùå Requires virtual nodes (vnodes) to prevent uneven key distribution</li>
              </ul>
            </div></div>
          </div>

          <h2>Replication Models</h2>
          <div class="table-responsive mt-2">
            <table class="table table-bordered table-striped">
              <thead><tr><th>Model</th><th>How Writes Work</th><th>Pros</th><th>Cons</th></tr></thead>
              <tbody>
                <tr><td><strong>Single-Leader (Primary-Replica)</strong></td><td>One primary accepts all writes; changes are replicated to read replicas asynchronously</td><td>Simple; strong write consistency; read scale-out to replicas</td><td>Leader is write bottleneck; failover delay when leader fails</td></tr>
                <tr><td><strong>Multi-Leader (Multi-Primary)</strong></td><td>Multiple primaries accept writes simultaneously; they sync with each other asynchronously</td><td>Higher write throughput; multi-region active-active; low write latency close to user</td><td>Write conflicts must be detected and resolved; complex to operate correctly</td></tr>
                <tr><td><strong>Leaderless / Quorum (Dynamo-style)</strong></td><td>Write to W replicas; read from R replicas. W + R &gt; N guarantees reading your own writes</td><td>No leader failure scenario; tunable consistency per operation; high write availability</td><td>Conflict detection needed (vector clocks); last-write-wins can lose data silently</td></tr>
              </tbody>
            </table>
          </div>

          <h2>Quorum Consensus Deep Dive</h2>
          <p class="mt-3">Leaderless replication (Dynamo-style) uses <strong>quorum consensus</strong> to provide tunable consistency without a leader. The key insight: if you write to <strong>W</strong> nodes and read from <strong>R</strong> nodes, and <strong>W + R &gt; N</strong> (where N is the total replication factor), then you are guaranteed to read at least one node with the most recent write ‚Äî because the read and write sets must overlap.</p>

          <div class="mermaid-container mt-2">
            <pre class="mermaid">
sequenceDiagram
    participant Client
    participant Coordinator
    participant R1 as Replica 1
    participant R2 as Replica 2
    participant R3 as Replica 3
    
    Note over Client,R3: Write Flow (W=2, N=3)
    Client->>Coordinator: PUT key=user:123, value="Alice"
    Coordinator->>R1: Write value="Alice" (v1)
    Coordinator->>R2: Write value="Alice" (v1)
    Coordinator->>R3: Write value="Alice" (v1)
    
    R1-->>Coordinator: ‚úÖ ACK (success)
    R2-->>Coordinator: ‚úÖ ACK (success)
    Note over Coordinator: W=2 replicas confirmed<br/>Return success to client
    Coordinator-->>Client: ‚úÖ Write successful
    
    R3--xCoordinator: ‚ùå Timeout (node slow/failed)
    Note over R3: R3 has stale data<br/>Will be repaired later
    
    rect rgb(240, 253, 244)
    Note over Client,R3: Read Flow (R=2, N=3)
    Client->>Coordinator: GET key=user:123
    Coordinator->>R1: Read key=user:123
    Coordinator->>R2: Read key=user:123
    
    R1-->>Coordinator: value="Alice" (v1, timestamp=100)
    R2-->>Coordinator: value="Alice" (v1, timestamp=100)
    
    Note over Coordinator: R=2 responses received<br/>Compare timestamps<br/>Return latest version
    Coordinator-->>Client: value="Alice" (v1)
    end
    
    rect rgb(254, 242, 242)
    Note over Coordinator,R3: Read Repair (Background)
    Note over Coordinator: Detected R3 has stale data<br/>Send latest version to R3
    Coordinator->>R3: Write value="Alice" (v1)
    R3-->>Coordinator: ‚úÖ Repaired
    end
            </pre>
          </div>

          <div class="callout mt-3">
            <strong>üîë Quorum Configuration Trade-offs</strong><br/>
            ‚Ä¢ <strong>W=1, R=1, N=3:</strong> Fast reads and writes, but no consistency guarantee ‚Äî may read stale data<br/>
            ‚Ä¢ <strong>W=2, R=2, N=3:</strong> Balanced ‚Äî guarantees consistency (W + R &gt; N), tolerates 1 node failure<br/>
            ‚Ä¢ <strong>W=3, R=1, N=3:</strong> Strong write consistency (all replicas must confirm), fast reads, but cannot tolerate any write failures<br/>
            ‚Ä¢ <strong>W=1, R=3, N=3:</strong> Fast writes, strong read consistency (all replicas must respond), but cannot tolerate read failures<br/>
            <br/>
            <strong>Databases using Quorum:</strong> Cassandra (default W=1, R=1 for availability), DynamoDB (configurable), Riak, Scylla
          </div>

          <h2>Conflict Resolution in Leaderless Systems</h2>
          <div class="row g-3 mt-2">
            <div class="col-md-6"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100">
              <h6 class="fw-bold">‚è±Ô∏è Last-Write-Wins (LWW)</h6>
              <p class="mb-2"><small>Each write tagged with a timestamp. On conflict, the write with the highest timestamp wins.</small></p>
              <ul class="mb-0 ps-3">
                <li>‚úÖ Simple to implement and understand</li>
                <li>‚úÖ No human intervention required</li>
                <li>‚ùå <strong>Silently loses data:</strong> If two clients write concurrently, one write is discarded ‚Äî no merge, no conflict notification</li>
                <li>‚ùå Timestamp synchronisation critical ‚Äî clock skew can cause wrong value to win</li>
              </ul>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100">
              <h6 class="fw-bold">üï∞Ô∏è Vector Clocks / Version Vectors</h6>
              <p class="mb-2"><small>Each replica maintains a version vector tracking causality ‚Äî which writes happened before which.</small></p>
              <ul class="mb-0 ps-3">
                <li>‚úÖ Detects true conflicts: two writes with no causal relationship (concurrent)</li>
                <li>‚úÖ Allows application to resolve conflict with custom merge logic (shopping cart merge, CRDTs)</li>
                <li>‚ùå Complexity: application must handle conflict resolution ‚Äî cannot just read a single value</li>
                <li>‚ùå Version vector size grows with number of concurrent writers</li>
              </ul>
            </div></div>
          </div>

          <div class="callout mt-3">üí° <strong>When to Use Quorum Replication:</strong> Choose leaderless for high availability ‚Äî writes succeed even when some nodes are down. Good for globally distributed systems (Cassandra multi-datacenter), eventually-consistent workloads (session stores, shopping carts), or when you need write availability &gt; strong consistency. Avoid for financial transactions or inventory management where lost updates are unacceptable.</div>

          <h2>Vector Clocks & CRDTs ‚Äî Conflict-Free Distributed Data</h2>
          <p class="mt-3">In distributed systems without a single source of truth, concurrent updates to the same data on different nodes create conflicts. Two fundamental approaches exist: <strong>Vector Clocks</strong> (detect conflicts, let application resolve) and <strong>CRDTs</strong> (Conflict-free Replicated Data Types ‚Äî mathematically guarantee convergence without conflicts).</p>

          <h3>Vector Clocks ‚Äî Causality Tracking</h3>
          <p>A <strong>Vector Clock</strong> is a data structure that tracks causality between events in a distributed system. Each replica maintains a vector of counters ‚Äî one counter per replica. When a replica performs a write, it increments its own counter. By comparing vector clocks, you can determine if two events are causally related or concurrent (conflicting).</p>

          <div class="mermaid-container mt-2">
            <pre class="mermaid">
sequenceDiagram
    participant A as Replica A
    participant B as Replica B
    participant C as Replica C
    
    Note over A,C: Initial state: value="v0", VC=[A:0, B:0, C:0]
    
    rect rgb(240, 253, 244)
    Note over A: Client writes "v1" to A
    A->>A: value="v1", VC=[A:1, B:0, C:0]
    A->>B: Replicate: value="v1", VC=[A:1, B:0, C:0]
    B->>B: Merge: value="v1", VC=[A:1, B:0, C:0]
    end
    
    rect rgb(254, 242, 242)
    Note over B,C: CONCURRENT writes (conflict!)
    B->>B: Client writes "v2" to B<br/>VC=[A:1, B:1, C:0]
    C->>C: Client writes "v3" to C<br/>VC=[A:0, B:0, C:1]
    
    Note over B,C: B's VC=[A:1, B:1, C:0]<br/>C's VC=[A:0, B:0, C:1]<br/>Neither is ancestor of other ‚Üí CONFLICT
    end
    
    rect rgb(254, 242, 242)
    Note over A,C: Conflict Detection
    B->>A: Replicate: value="v2", VC=[A:1, B:1, C:0]
    C->>A: Replicate: value="v3", VC=[A:0, B:0, C:1]
    
    A->>A: Compare VCs - detect conflict<br/>Must merge "v2" and "v3"
    Note over A: Application-level resolution:<br/>Option 1: Last-write-wins (timestamp)<br/>Option 2: Merge values (e.g., shopping cart union)<br/>Option 3: Keep both, user chooses
    
    A->>A: Resolved: value="v2+v3 merged"<br/>VC=[A:2, B:1, C:1]
    end
            </pre>
          </div>

          <div class="row g-3 mt-3">
            <div class="col-md-6"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100">
              <h6 class="fw-bold">üìê Vector Clock Comparison Rules</h6>
              <p class="mb-2"><small>Given VC1=[A:3, B:2, C:1] and VC2=[A:3, B:1, C:1]:</small></p>
              <ul class="mb-0 ps-3">
                <li><strong>VC1 &gt; VC2 (VC1 happened after):</strong> If VC1[i] ‚â• VC2[i] for all i, and VC1[j] &gt; VC2[j] for at least one j<br/><small>Example: [A:3, B:2, C:1] &gt; [A:3, B:1, C:1] ‚Äî VC1 is descendant, no conflict</small></li>
                <li><strong>VC1 &lt; VC2 (VC2 happened after):</strong> If VC2[i] ‚â• VC1[i] for all i, and VC2[j] &gt; VC1[j] for at least one j</li>
                <li><strong>VC1 || VC2 (concurrent ‚Äî CONFLICT):</strong> If neither is ancestor of the other<br/><small>Example: [A:3, B:2, C:0] vs [A:3, B:0, C:1] ‚Äî both have unique updates, must resolve</small></li>
              </ul>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100">
              <h6 class="fw-bold">‚ö†Ô∏è Vector Clock Trade-offs</h6>
              <ul class="mb-0 ps-3">
                <li>‚úÖ <strong>Precise conflict detection:</strong> Never falsely reports conflict for causally-ordered updates</li>
                <li>‚úÖ <strong>No clock synchronization needed:</strong> Uses logical time, not wall-clock time</li>
                <li>‚úÖ <strong>Application control:</strong> App chooses merge strategy per data type (union for cart, max for counter)</li>
                <li>‚ùå <strong>Size growth:</strong> Vector size = number of replicas. With 100 nodes, every value carries 100-entry vector</li>
                <li>‚ùå <strong>Application complexity:</strong> App code must handle conflict resolution ‚Äî can't just read a single value</li>
              </ul>
            </div></div>
          </div>

          <h3 class="mt-4">CRDTs ‚Äî Conflict-Free Replicated Data Types</h3>
          <p>CRDTs are data structures designed to <strong>automatically merge concurrent updates without conflicts</strong>. They provide eventual consistency with a mathematical guarantee: all replicas that have seen the same set of updates will converge to the same state, regardless of update order.</p>

          <div class="callout mt-2">
            <strong>üîë CRDT Core Principle:</strong> Design merge operations that are <strong>commutative</strong> (order doesn't matter), <strong>associative</strong> (grouping doesn't matter), and <strong>idempotent</strong> (applying same update twice = applying once). For example, <code>max(a, b) = max(b, a)</code> ‚Äî a grow-only counter merges by taking the maximum across replicas, always converging.
          </div>

          <h3>Common CRDT Types</h3>
          <div class="table-responsive mt-2">
            <table class="table table-bordered table-striped">
              <thead><tr><th>CRDT Type</th><th>Operations</th><th>Merge Rule</th><th>Use Case</th></tr></thead>
              <tbody>
                <tr>
                  <td><strong>G-Counter<br/>(Grow-only Counter)</strong></td>
                  <td>increment()</td>
                  <td>Each replica maintains a vector of counts; merge by element-wise max. Total = sum of vector.</td>
                  <td>Page view counter, like counts ‚Äî only increments, no decrements</td>
                </tr>
                <tr>
                  <td><strong>PN-Counter<br/>(Positive-Negative Counter)</strong></td>
                  <td>increment(), decrement()</td>
                  <td>Two G-Counters (P for increments, N for decrements). Value = sum(P) - sum(N)</td>
                  <td>Shopping cart quantity (add/remove items), upvote/downvote count</td>
                </tr>
                <tr>
                  <td><strong>G-Set<br/>(Grow-only Set)</strong></td>
                  <td>add(element)</td>
                  <td>Union of all sets across replicas ‚Äî elements are never removed</td>
                  <td>Tag collection, follower list (append-only)</td>
                </tr>
                <tr>
                  <td><strong>2P-Set<br/>(Two-Phase Set)</strong></td>
                  <td>add(element), remove(element)</td>
                  <td>Two G-Sets: A (added) and R (removed). Membership = A \ R. Once removed, element cannot be re-added.</td>
                  <td>Blocklist, deleted item tracking</td>
                </tr>
                <tr>
                  <td><strong>LWW-Element-Set<br/>(Last-Write-Wins Set)</strong></td>
                  <td>add(element, timestamp), remove(element, timestamp)</td>
                  <td>Each operation tagged with timestamp. On conflict, highest timestamp wins.</td>
                  <td>Collaborative document editing (set of characters), presence system (set of online users)</td>
                </tr>
                <tr>
                  <td><strong>OR-Set<br/>(Observed-Remove Set)</strong></td>
                  <td>add(element, unique_tag), remove(element, tags)</td>
                  <td>Each add gets unique tag. Remove only removes specific tags. Element present if any tag remains.</td>
                  <td>Shopping cart (add item twice = two instances), task list with concurrent edits</td>
                </tr>
                <tr>
                  <td><strong>RGA / WOOT<br/>(Replicated Growable Array / WOOT)</strong></td>
                  <td>insert(position, char), delete(position)</td>
                  <td>Sequence CRDTs using tombstones and position identifiers to handle concurrent inserts/deletes</td>
                  <td>Collaborative text editing (Google Docs-style), multi-user rich text</td>
                </tr>
              </tbody>
            </table>
          </div>

          <h3>CRDT Example ‚Äî OR-Set (Shopping Cart)</h3>
          <div class="mermaid-container mt-2">
            <pre class="mermaid">
graph TB
    subgraph Client1["üõí Client 1 (Replica A)"]
        A1["add('apple', tag:a1)"]
        A2["add('banana', tag:a2)"]
        State_A["State A:<br/>{apple:[a1], banana:[a2]}"]
        A1 --> A2
        A2 --> State_A
    end
    
    subgraph Client2["üõí Client 2 (Replica B)"]
        B1["add('apple', tag:b1)"]
        B2["remove('apple', tags:[b1])"]
        State_B["State B:<br/>{apple:[], banana:[]}"]
        B1 --> B2
        B2 --> State_B
    end
    
    subgraph Merge["‚öñÔ∏è Merge at Server"]
        M["Merge OR-Sets:<br/>apple tags = {a1} ‚à™ {} = {a1}<br/>banana tags = {a2} ‚à™ {} = {a2}<br/><br/>Final cart: {apple, banana}"]
    end
    
    State_A --> M
    State_B --> M
    
    M --> Final["‚úÖ Converged State:<br/>{apple:[a1], banana:[a2]}<br/><br/>Both clients now see: apple, banana"]
    
    Note1["üìå Key Insight:<br/>Client 1's add('apple', tag:a1) survives<br/>because Client 2 only removed tag:b1<br/>Concurrent adds are preserved!"]
    
    M --> Note1
    
    style State_A fill:#dcfce7,stroke:#10b981,stroke-width:2px
    style State_B fill:#fef3c7,stroke:#f59e0b,stroke-width:2px
    style M fill:#dbeafe,stroke:#3b82f6,stroke-width:2px
    style Final fill:#d1fae5,stroke:#059669,stroke-width:3px
    style Note1 fill:#e0e7ff,stroke:#6366f1,stroke-width:2px
            </pre>
          </div>

          <h3>CRDTs in Production</h3>
          <div class="row g-3 mt-2">
            <div class="col-md-3"><div class="card border-0 bg-gradient-purple p-3 rounded-3 h-100"><strong>Riak (Basho)</strong><p class="mt-1 mb-0"><small>Distributed KV store with built-in CRDT support: counters, sets, maps, registers. Automatic conflict resolution.</small></p></div></div>
            <div class="col-md-3"><div class="card border-0 bg-gradient-teal p-3 rounded-3 h-100"><strong>Redis (CRDT module)</strong><p class="mt-1 mb-0"><small>Active-Active geo-distributed Redis with CRDTs. Supports G-Counter, PN-Counter, LWW-Registers, OR-Sets.</small></p></div></div>
            <div class="col-md-3"><div class="card border-0 bg-gradient-pink p-3 rounded-3 h-100"><strong>Automerge / Yjs</strong><p class="mt-1 mb-0"><small>JavaScript CRDTs for collaborative apps. Google Docs-style editing with Sequence CRDTs (RGA, YATA algorithm).</small></p></div></div>
            <div class="col-md-3"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100"><strong>Cosmos DB</strong><p class="mt-1 mb-0"><small>Azure Cosmos DB multi-region writes use LWW merge policy (timestamp-based), essentially LWW-Element-Set for conflict resolution.</small></p></div></div>
          </div>

          <div class="callout mt-3">
            <strong>When to Use CRDTs vs Vector Clocks:</strong><br/>
            ‚Ä¢ <strong>CRDTs:</strong> Choose when you want automatic, application-transparent conflict resolution. Perfect for counters, sets, collaborative editing. Works offline-first (mobile apps). Trade-off: limited to CRDT-compatible data types.<br/>
            ‚Ä¢ <strong>Vector Clocks:</strong> Choose when you need application-specific conflict resolution ‚Äî e.g., merging complex objects, business logic-dependent merges. Detects conflicts precisely, but application must handle resolution.<br/>
            <br/>
            <strong>Hybrid approach:</strong> Use CRDTs for simple data (counters, presence, shopping cart) and Vector Clocks for complex domain objects requiring custom merge logic.
          </div>

          <h2>Sharding Challenges &amp; Mitigations</h2>
          <div class="row g-3">
            <div class="col-md-4"><div class="card border-0 bg-gradient-yellow p-3 rounded-3 h-100"><strong>üîó Cross-Shard Queries</strong><p class="mb-0 mt-1"><small>JOINs across shards are expensive. Use scatter-gather: query all shards in parallel, merge in the application layer. Long-term solution: denormalise data or maintain a separate analytics DB (read replica / data warehouse).</small></p></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-red p-3 rounded-3 h-100"><strong>üî• Hot Shards</strong><p class="mb-0 mt-1"><small>A celebrity user or viral event concentrates traffic on a single shard. Solutions: sub-shard the hot key, add a shard-level cache, or move the high-traffic entity to a dedicated oversized shard.</small></p></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-purple p-3 rounded-3 h-100"><strong>üîÑ Resharding</strong><p class="mb-0 mt-1"><small>Growing from N shards to 2N requires live data migration. Consistent hashing minimises the keys moved. Plan your initial shard count conservatively large ‚Äî it is cheaper to start with 16 shards than to reshard from 4.</small></p></div></div>
          </div>

          <div class="callout mt-4">üí° <strong>The Scaling Ladder for Databases:</strong> Single node ‚Üí Vertical scaling ‚Üí Read replicas (read scale) ‚Üí Application-level caching ‚Üí Sharding (write &amp; storage scale). Each step adds irreversible complexity. Start at the bottom and climb only when you feel real, measured production pain.</div>
        </section>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê STORAGE & DATABASES GROUP ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <section id="storage-databases" role="article">
          <h1>ÔøΩ Storage &amp; Databases</h1>
          <span class="badge">storage</span> <span class="badge">databases</span> <span class="badge">data</span>
        </section>

        <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ STORAGE & DATABASES INTRODUCTION ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
        <section id="storage-databases-introduction" role="article">
          <h1>üìñ Introduction</h1>
          <span class="badge">storage</span> <span class="badge">databases</span> <span class="badge">overview</span>

          <h2>About Storage &amp; Databases</h2>
          <p>The database choice is <strong>one of the most consequential and least reversible decisions</strong> in system design. Pick the wrong store and you will be fighting it for years ‚Äî through data migrations, workarounds for missing features, or performance ceilings that require expensive re-architecture.</p>
          <p>Beyond the SQL-vs-NoSQL debate, this section covers the <em>theoretical guarantees</em> that underpin distributed databases (CAP and PACELC), advanced data patterns that unlock audit trails and independent read/write scaling (Event Sourcing and CQRS), and specialised search infrastructure that no relational database can efficiently replace.</p>

          <div class="callout">
            <strong>üí° Why Data Architecture Decisions Are Hard to Reverse</strong>
            <ul>
              <li>‚úÖ <strong>Schema migration at scale is painful:</strong> ALTER TABLE on a 10 TB, 24/7 table takes hours with locking ‚Äî or complex shadow-table tooling (pt-online-schema-change, gh-ost)</li>
              <li>‚úÖ <strong>Application coupling:</strong> Once 50 services query your database schema directly, every change requires coordinated multi-team releases</li>
              <li>‚úÖ <strong>Operational expertise:</strong> Your on-call engineers will spend years mastering your database's failure modes ‚Äî switching technologies resets that clock</li>
              <li>‚úÖ <strong>Data gravity:</strong> Large datasets attract more consumers ‚Äî the more data in a store, the harder it is to move or deprecate</li>
            </ul>
          </div>

          <h2>What's Covered in This Section</h2>

          <h3>üóÉÔ∏è SQL vs NoSQL ‚Äî When to Choose What</h3>
          <p>A structured comparison of relational vs non-relational databases across data model, ACID guarantees, schema flexibility, scaling strategy, and query capabilities. Includes a breakdown of the four NoSQL sub-families (Key-Value, Document, Wide-Column, Graph) with canonical examples and use case guidance.</p>

          <h3>üî∫ CAP Theorem &amp; PACELC</h3>
          <p>The theoretical foundation of distributed database trade-offs. CAP proves you cannot simultaneously guarantee Consistency, Availability, and Partition Tolerance in a distributed system ‚Äî and since partitions are unavoidable in cloud deployments, you must explicitly choose your C-vs-A trade-off. PACELC extends this to the latency-vs-consistency trade-off even in the absence of partitions.</p>

          <h3>üìú Event Sourcing &amp; CQRS</h3>
          <p>Two advanced patterns often combined for domains requiring full audit trails, complex business logic, or extremely asymmetric read/write load. Event Sourcing stores the <em>history of changes</em> rather than current state; CQRS separates the write model (Commands) from the read model (Queries) to allow each to be independently optimised.</p>

          <h3>üîç Search Systems</h3>
          <p>Full-text search requires a fundamentally different data structure than a B-tree index. This section covers inverted indexes, the Elasticsearch / Apache Lucene architecture, relevance scoring algorithms (TF-IDF, BM25), and the integration pattern for keeping a primary database as the source of truth while syncing to a search index for query capabilities.</p>

          <div class="callout mt-3">
            <strong>üîó How These Topics Connect</strong><br/>
            Your <em>SQL vs NoSQL</em> choice is constrained by <em>CAP/PACELC</em> guarantees you can live with ‚Üí domains with complex audit or write/read asymmetry benefit from <em>Event Sourcing + CQRS</em> ‚Üí regardless of primary store, add a dedicated <em>Search System</em> for full-text query capabilities rather than trying to force your primary DB to serve search use cases.
          </div>

          <h2>Topics at a Glance</h2>
          <div class="row g-3 mt-1">
            <div class="col-md-6"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100"><h6 class="fw-bold">üóÉÔ∏è SQL vs NoSQL</h6><ul class="mb-0 ps-3"><li>ACID vs BASE consistency models</li><li>Schema-first vs schema-flexible</li><li>4 NoSQL sub-families with trade-offs</li><li>Decision guide for real-world scenarios</li></ul></div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100"><h6 class="fw-bold">üî∫ CAP Theorem &amp; PACELC</h6><ul class="mb-0 ps-3"><li>CP vs AP trade-off under partitions</li><li>PACELC: latency vs consistency normally</li><li>Practical DB classification (etcd, Cassandra, DynamoDB)</li><li>How to choose given your SLA</li></ul></div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-yellow p-3 rounded-3 h-100"><h6 class="fw-bold">üìú Event Sourcing &amp; CQRS</h6><ul class="mb-0 ps-3"><li>Append-only event log as source of truth</li><li>State reconstruction via event replay</li><li>Separate read/write models for independent scale</li><li>Projections, sagas, and when to apply</li></ul></div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-purple p-3 rounded-3 h-100"><h6 class="fw-bold">üîç Search Systems</h6><ul class="mb-0 ps-3"><li>Inverted index structure and tokenisation</li><li>Elasticsearch shards, replicas, and NRT indexing</li><li>TF-IDF and BM25 relevance scoring</li><li>Sync pattern: primary DB ‚Üí search index via CDC</li></ul></div></div>
          </div>
        </section>

        <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ SQL VS NOSQL ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
        <section id="sql-vs-nosql" role="article">
          <h1>üóÉÔ∏è SQL vs NoSQL ‚Äî When to Choose What</h1>
          <span class="badge">sql</span> <span class="badge">nosql</span> <span class="badge">database choice</span>

          <h2>Introduction</h2>
          <p>There is no universally better choice ‚Äî the right database depends on your <strong>data model, query patterns, consistency needs, and scale requirements</strong>. The SQL-vs-NoSQL framing is actually a simplification: within "NoSQL" there are four radically different data models (Key-Value, Document, Wide-Column, Graph) that have almost nothing in common with each other.</p>
          <p>The real skill is <strong>matching your access patterns to the database's strengths</strong>. A document DB that stores JSON natively is a poor fit for financial ledger data that requires multi-row transactions; a relational DB is a poor fit for a social graph with billions of relationship traversals per second.</p>

          <h2>Database Selection Decision Tree</h2>
          <div class="mermaid">
graph TD
    Start["üìä Choose Database Type"] --> Q1{Need ACID
transactions?}
    
    Q1 -->|Yes| SQL["‚úÖ SQL Database
(PostgreSQL, SQL Server,<br/>MySQL, Oracle)"]
    Q1 -->|No| Q2{What's your
access pattern?}
    
    Q2 -->|Key-based lookups
Caching| KV["üîë Key-Value Store
(Redis, DynamoDB, Memcached)"]
    Q2 -->|Document storage
Flexible schema| DOC["üìÑ Document Store
(MongoDB, Cosmos DB,
Firestore, CouchDB)"]
    Q2 -->|High write throughput
Time-series| WC["üìä Wide-Column Store
(Cassandra, HBase, ScyllaDB)"]
    Q2 -->|Relationship traversal
Graph analysis| GRAPH["üï∏Ô∏è Graph Database
(Neo4j, Neptune, Azure Cosmos Gremlin)"]
    Q2 -->|Full-text search
Relevance ranking| SEARCH["üîç Search Engine
(Elasticsearch, Azure AI Search, Solr)"]
    
    SQL -.-> Use1["Use Cases:
‚Ä¢ Financial systems
‚Ä¢ E-commerce orders
‚Ä¢ ERP, CRM
‚Ä¢ Multi-table reports"]
    KV -.-> Use2["Use Cases:
    ‚Ä¢ Session storage
    ‚Ä¢ Rate limiting
    ‚Ä¢ Feature flags
    ‚Ä¢ Real-time leaderboards"]
    DOC -.-> Use3["Use Cases:
    ‚Ä¢ Product catalogs
    ‚Ä¢ User profiles
    ‚Ä¢ Content mgmt
    ‚Ä¢ IoT device metadata"]
    WC -.-> Use4["Use Cases:
    ‚Ä¢ IoT sensor data
    ‚Ä¢ Activity feeds
    ‚Ä¢ Time-series metrics
    ‚Ä¢ Event logging"]
    GRAPH -.-> Use5["Use Cases:
    ‚Ä¢ Social networks
    ‚Ä¢ Fraud detection
    ‚Ä¢ Knowledge graphs
    ‚Ä¢ Recommendation engines"]
    SEARCH -.-> Use6["Use Cases:
    ‚Ä¢ Product search
    ‚Ä¢ Log analysis
    ‚Ä¢ Document discovery
    ‚Ä¢ Autocomplete"]
    
    style Start fill:#dbeafe,stroke:#3b82f6,stroke-width:3px
    style Q1 fill:#fef3c7,stroke:#f59e0b,stroke-width:2px
    style Q2 fill:#fef3c7,stroke:#f59e0b,stroke-width:2px
    style SQL fill:#dcfce7,stroke:#10b981,stroke-width:2px
    style KV fill:#e9d5ff,stroke:#a855f7,stroke-width:2px
    style DOC fill:#dbeafe,stroke:#3b82f6,stroke-width:2px
    style WC fill:#fce7f3,stroke:#ec4899,stroke-width:2px
    style GRAPH fill:#fed7aa,stroke:#ea580c,stroke-width:2px
    style SEARCH fill:#fef3c7,stroke:#f59e0b,stroke-width:2px
          </div>

          <div class="callout mt-3">
            <strong>üí° The Database Selection Decision Tree</strong>
            <ul>
              <li>‚úÖ <strong>Need complex multi-table transactions?</strong> ‚Üí SQL (PostgreSQL, SQL Server)</li>
              <li>‚úÖ <strong>Need flexible schema for evolving domain models?</strong> ‚Üí Document DB (MongoDB, Cosmos DB)</li>
              <li>‚úÖ <strong>Need extreme write throughput at petabyte scale?</strong> ‚Üí Wide-Column (Cassandra, HBase)</li>
              <li>‚úÖ <strong>Need sub-millisecond key lookups or caching?</strong> ‚Üí Key-Value (Redis, DynamoDB)</li>
              <li>‚úÖ <strong>Need relationship traversal (degrees of connection)?</strong> ‚Üí Graph (Neo4j, Neptune)</li>
              <li>‚úÖ <strong>Need full-text search with relevance ranking?</strong> ‚Üí Search Engine (Elasticsearch, Azure AI Search)</li>
            </ul>
          </div>

          <h2>SQL vs NoSQL: Side-by-Side Comparison</h2>
          <div class="table-responsive mt-3">
            <table class="table table-bordered table-striped">
              <thead><tr><th>Dimension</th><th>SQL (Relational)</th><th>NoSQL</th></tr></thead>
              <tbody>
                <tr><td><strong>Data Model</strong></td><td>Tables, rows, normalised ‚Äî fixed schema enforced by DB</td><td>Documents, key-value, wide-column, or graph ‚Äî schema in application layer</td></tr>
                <tr><td><strong>Consistency</strong></td><td>Full ACID: Atomicity, Consistency, Isolation, Durability</td><td>Varies: most favour BASE (Basically Available, Soft state, Eventually consistent)</td></tr>
                <tr><td><strong>Schema</strong></td><td>Schema-first ‚Äî changes require migrations (ALTER TABLE)</td><td>Schema-flexible ‚Äî new fields can be added per document/row without migration</td></tr>
                <tr><td><strong>Scaling Path</strong></td><td>Vertical primary, read replicas, then hard sharding (PostgreSQL Citus, Vitess)</td><td>Horizontal built-in ‚Äî sharding is native to the data model (Cassandra, DynamoDB)</td></tr>
                <tr><td><strong>Joins</strong></td><td>First-class citizen ‚Äî multi-table JOIN with query planner optimisation</td><td>Typically avoided ‚Äî embed or reference; application-side joins if needed</td></tr>
                <tr><td><strong>Query Language</strong></td><td>SQL ‚Äî ISO standard, universally understood</td><td>Varied: MQL (MongoDB), CQL (Cassandra), GQL (graph), DynamoDB expression syntax</td></tr>
                <tr><td><strong>Indexing</strong></td><td>B-tree primary/secondary, covering indexes, partial indexes</td><td>Varies by DB; DynamoDB requires explicit GSIs; Cassandra uses composite primary keys</td></tr>
                <tr><td><strong>Best for</strong></td><td>Financial systems, ERP, CMS, reporting, anything with complex relationships</td><td>High-throughput write workloads, variable schemas, specific data access patterns at scale</td></tr>
                <tr><td><strong>Examples</strong></td><td>PostgreSQL, MySQL, SQL Server, Oracle, CockroachDB</td><td>MongoDB, Cassandra, DynamoDB, Redis, Neo4j, HBase</td></tr>
              </tbody>
            </table>
          </div>

          <h2>The Four NoSQL Families</h2>
          <div class="row g-3">
            <div class="col-md-6"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100">
              <h6 class="fw-bold">üîë Key-Value Store</h6>
              <p class="mb-2">Simplest model ‚Äî a global dictionary of key ‚Üí opaque value. Extremely fast for direct lookups.</p>
              <ul class="mb-0 ps-3">
                <li><strong>Examples:</strong> Redis, DynamoDB (single-table design), Memcached</li>
                <li>‚úÖ Sub-millisecond reads/writes; simple operations</li>
                <li>‚úÖ Ideal for session stores, feature flags, rate limit counters</li>
                <li>‚ùå No query capability beyond key ‚Äî cannot filter or range-scan values</li>
              </ul>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100">
              <h6 class="fw-bold">üìÑ Document Store</h6>
              <p class="mb-2">Stores semi-structured JSON/BSON documents. Each document is self-describing; documents in the same collection can have different fields.</p>
              <ul class="mb-0 ps-3">
                <li><strong>Examples:</strong> MongoDB, Azure Cosmos DB, Firestore, CouchDB</li>
                <li>‚úÖ Natural fit for object-oriented app models; no impedance mismatch</li>
                <li>‚úÖ Supports richer queries (filter by any field), aggregation pipelines</li>
                <li>‚ùå Multi-document transactions are possible but reduce performance</li>
              </ul>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-yellow p-3 rounded-3 h-100">
              <h6 class="fw-bold">üìä Wide-Column Store</h6>
              <p class="mb-2">Rows are identified by a composite key (partition key + clustering key). Each row can have different columns. Designed for massive write throughput and time-series data.</p>
              <ul class="mb-0 ps-3">
                <li><strong>Examples:</strong> Apache Cassandra, HBase, ScyllaDB, Azure Table Storage</li>
                <li>‚úÖ Linear write scalability to petabytes with no single write bottleneck</li>
                <li>‚úÖ Excellent for IoT sensor data, activity feeds, time-series metrics</li>
                <li>‚ùå Query patterns must be defined at schema design time ‚Äî access pattern changes require schema changes</li>
              </ul>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-purple p-3 rounded-3 h-100">
              <h6 class="fw-bold">üï∏Ô∏è Graph Database</h6>
              <p class="mb-2">First-class nodes and edges. Traversing multi-hop relationships is O(1) per hop rather than O(log N) per JOIN in SQL.</p>
              <ul class="mb-0 ps-3">
                <li><strong>Examples:</strong> Neo4j, Amazon Neptune, Azure Cosmos DB (Gremlin API), TigerGraph</li>
                <li>‚úÖ Friend-of-friend queries, fraud ring detection, knowledge graphs</li>
                <li>‚úÖ Pattern matching across complex relationship structures</li>
                <li>‚ùå Poor fit for aggregate analytics; limited horizontal scale vs wide-column</li>
              </ul>
            </div></div>
          </div>

          <h2>Real-World Decision Guide</h2>
          <div class="table-responsive mt-2">
            <table class="table table-bordered table-striped">
              <thead><tr><th>Use Case</th><th>Recommended DB</th><th>Why</th></tr></thead>
              <tbody>
                <tr><td>User accounts, roles, permissions</td><td>PostgreSQL</td><td>Relational integrity; complex join queries; multi-row transactions</td></tr>
                <tr><td>Product catalogue (varied attributes)</td><td>MongoDB / Cosmos DB</td><td>Schema-flexible JSON documents; different products have different fields</td></tr>
                <tr><td>Session storage, rate limiting</td><td>Redis</td><td>Sub-millisecond TTL-based key-value reads/writes</td></tr>
                <tr><td>IoT sensor data / time-series</td><td>Cassandra / InfluxDB</td><td>High-throughput append-only writes; time-range queries by device ID</td></tr>
                <tr><td>Social graph / recommendations</td><td>Neo4j / Neptune</td><td>Efficient multi-hop relationship traversal</td></tr>
                <tr><td>Full-text search</td><td>Elasticsearch / Azure AI Search</td><td>Inverted index with relevance scoring and faceting</td></tr>
                <tr><td>Financial ledger / banking</td><td>PostgreSQL / CockroachDB</td><td>ACID transactions are non-negotiable</td></tr>
              </tbody>
            </table>
          </div>

          <div class="callout mt-4">üí° <strong>Polyglot Persistence:</strong> Most production systems use <em>multiple databases</em> ‚Äî PostgreSQL for core transactional data, Redis for caching/sessions, Elasticsearch for search, and a time-series DB for metrics. The wisdom is not choosing one winner ‚Äî it is knowing which store to reach for per access pattern.</div>
        </section>

        <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ CAP THEOREM ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
        <section id="cap-theorem" role="article">
          <h1>üî∫ CAP Theorem &amp; PACELC</h1>
          <span class="badge">cap</span> <span class="badge">pacelc</span> <span class="badge">consistency</span> <span class="badge">availability</span>

          <h2>Introduction</h2>
          <p>CAP Theorem (proved by Eric Brewer, 2000; formally by Gilbert &amp; Lynch, 2002) states that a distributed system can simultaneously guarantee at most <strong>two of three properties</strong>: Consistency, Availability, and Partition Tolerance. Since network partitions are a fact of life in any distributed deployment, the practical implication is: <strong>you must choose between Consistency and Availability when a partition occurs</strong>.</p>
          <p>Understanding CAP is not just theoretical ‚Äî it directly governs which databases you can use for different parts of your system. A financial transaction system cannot afford stale reads (choose CP); a social media feed can tolerate slightly stale data but must stay up (choose AP).</p>

          <div class="callout">
            <strong>üí° The Core Insight</strong><br/>
            Network partitions are <em>not optional</em> ‚Äî they happen in datacenters, between regions, and during rolling deploys. The question is never "can I avoid a partition?" but "when a partition happens, do I stay available and risk stale data, or do I reject requests and guarantee freshness?" There is no middle ground ‚Äî you must pick your default behaviour before the partition happens.
          </div>

          <h2>The Three CAP Properties</h2>
          <div class="mermaid">
graph TD
    CAP["üî∫ CAP Theorem
    Pick 2 of 3"]
    CAP --> C["üîí Consistency
    All nodes see same data
    at the same time"]
    CAP --> A["‚úÖ Availability
    Every request gets
    a response"]
    CAP --> P["üö´ Partition Tolerance
    System works despite
    network partitions"]
    
    C -.->|CP System| CP["etcd, ZooKeeper
    MongoDB, PostgreSQL"]
    A -.->|AP System| AP["Cassandra, DynamoDB
    Riak, CouchDB"]
    P -.->|Required in
    distributed systems| Required["You must always
    choose P in cloud"]
    
    style CAP fill:#dbeafe,stroke:#3b82f6,stroke-width:3px
    style C fill:#dcfce7,stroke:#10b981,stroke-width:2px
    style A fill:#fef3c7,stroke:#f59e0b,stroke-width:2px
    style P fill:#fee2e2,stroke:#dc2626,stroke-width:2px
    style CP fill:#e9d5ff,stroke:#a855f7
    style AP fill:#fce7f3,stroke:#ec4899
    style Required fill:#f3f4f6,stroke:#6b7280
          </div>
          <div class="row g-3 mt-3">
            <div class="col-md-4"><div class="card border-0 bg-gradient-blue p-3 rounded-3 text-center h-100">
              <strong>C ‚Äî Consistency</strong>
              <p class="mt-2 mb-1"><small>Every read receives the <em>most recent write</em> or an error. All nodes see the same data at the same time. Equivalent to single-system behaviour viewed from the client.</small></p>
              <span class="badge bg-primary">Examples: etcd, Zookeeper, HBase</span>
            </div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-green p-3 rounded-3 text-center h-100">
              <strong>A ‚Äî Availability</strong>
              <p class="mt-2 mb-1"><small>Every request receives a <em>non-error response</em> ‚Äî without a guarantee it reflects the most recent write. The system stays up and serving requests even if some nodes are unreachable.</small></p>
              <span class="badge bg-success">Examples: Cassandra, CouchDB, DynamoDB</span>
            </div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-yellow p-3 rounded-3 text-center h-100">
              <strong>P ‚Äî Partition Tolerance</strong>
              <p class="mt-2 mb-1"><small>The system continues operating despite arbitrary numbers of messages being lost or delayed between nodes. <em>All distributed systems must implement this</em> ‚Äî you cannot opt out of partitions.</small></p>
              <span class="badge bg-warning text-dark">Required in all distributed systems</span>
            </div></div>
          </div>

          <h2>CP vs AP vs CA in Practice</h2>
          <div class="table-responsive mt-2">
            <table class="table table-bordered table-striped">
              <thead><tr><th>Type</th><th>Sacrifices During Partition</th><th>Examples</th><th>When to Choose</th></tr></thead>
              <tbody>
                <tr><td><strong>CP (Consistent + Partition-Tolerant)</strong></td><td>Availability ‚Äî returns errors if it cannot guarantee freshness</td><td>HBase, Zookeeper, etcd, MongoDB (majority write concern), CockroachDB</td><td>Financial accounts, distributed locks, inventory counts ‚Äî correctness is mandatory</td></tr>
                <tr><td><strong>AP (Available + Partition-Tolerant)</strong></td><td>Consistency ‚Äî may return stale data but stays responsive</td><td>Cassandra, CouchDB, DynamoDB (eventual mode), Riak</td><td>Shopping carts, social media feeds, sensor data ‚Äî availability is mandatory; slight staleness is acceptable</td></tr>
                <tr><td><strong>CA (Consistent + Available)</strong></td><td>Partition tolerance ‚Äî only works as a single node</td><td>Single-node PostgreSQL, MySQL (non-replicated)</td><td>Not viable for distributed systems; only valid for standalone databases with no replication</td></tr>
              </tbody>
            </table>
          </div>

          <h2>PACELC ‚Äî The Extended Model</h2>
          <p>PACELC (Daniel Abadi, 2012) addresses a key gap in CAP: CAP only describes behaviour <em>during a partition</em>. PACELC adds the normal-operation trade-off too:</p>
          <div class="callout">
            <strong>PACELC Formula:</strong><br/>
            <strong>If Partition (P):</strong> choose Availability (A) or Consistency (C).<br/>
            <strong>Else (E ‚Äî no partition):</strong> choose Latency (L) or Consistency (C).
          </div>
          <div class="table-responsive mt-3">
            <table class="table table-bordered table-striped">
              <thead><tr><th>Database</th><th>PACELC Classification</th><th>Interpretation</th></tr></thead>
              <tbody>
                <tr><td>Amazon DynamoDB (eventual)</td><td><strong>PA / EL</strong></td><td>Available during partition; low latency (eventual consistency) in normal operation</td></tr>
                <tr><td>Apache Cassandra</td><td><strong>PA / EL</strong></td><td>Available during partition; tunable ‚Äî default favours low latency over strict consistency</td></tr>
                <tr><td>PostgreSQL (single node)</td><td><strong>PC / EC</strong></td><td>Consistent during partition; consistent in normal operation (ACID)</td></tr>
                <tr><td>MongoDB (majority writes)</td><td><strong>PC / EC</strong></td><td>Consistent under partition (blocks until majority acked); consistent otherwise</td></tr>
                <tr><td>CRDT-based systems (Riak)</td><td><strong>PA / EL</strong></td><td>Always available; CRDTs automatically merge concurrent writes</td></tr>
              </tbody>
            </table>
          </div>

          <h2>Consistency Levels ‚Äî The Spectrum</h2>
          <div class="row g-3">
            <div class="col-md-3"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100 text-center"><strong>Strong</strong><p class="mt-1 mb-0"><small>Read always reflects latest write. Requires coordination. Highest latency. Used in: databases with Raft/Paxos consensus.</small></p></div></div>
            <div class="col-md-3"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100 text-center"><strong>Linearisable</strong><p class="mt-1 mb-0"><small>Operations appear instantaneous and in real-time order. Slightly weaker than strict serializability. Used in: distributed locks (etcd).</small></p></div></div>
            <div class="col-md-3"><div class="card border-0 bg-gradient-yellow p-3 rounded-3 h-100 text-center"><strong>Read-Your-Writes</strong><p class="mt-1 mb-0"><small>A client always reads its own writes. Other clients may see an older version. Common in user-facing apps to prevent confusing UX.</small></p></div></div>
            <div class="col-md-3"><div class="card border-0 bg-gradient-purple p-3 rounded-3 h-100 text-center"><strong>Eventual</strong><p class="mt-1 mb-0"><small>Given no new writes, all replicas will converge to the same value eventually. Maximum availability, minimum latency. Used in: DNS, Cassandra, social feeds.</small></p></div></div>
          </div>

          <div class="callout mt-4">üí° <strong>Application:</strong> When designing a system, always state your CAP choice explicitly: <em>"For the orders service I'll use PostgreSQL ‚Äî it's CP; the order data must be consistent and I'd rather return a 503 than serve stale inventory counts. For the activity feed I'll use Cassandra ‚Äî it's AP; a few seconds of staleness is fine and the feed must never go down."</em></div>
        </section>

        <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ EVENT SOURCING & CQRS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
        <section id="event-sourcing-cqrs" role="article">
          <h1>üìú Event Sourcing &amp; CQRS Patterns</h1>
          <span class="badge">event sourcing</span> <span class="badge">cqrs</span> <span class="badge">patterns</span>

          <h2>Introduction</h2>
          <p>Event Sourcing and CQRS are two distinct patterns that are often applied together in domains where <strong>auditability, complex business logic, or extreme read/write load asymmetry</strong> are primary concerns. Individually they solve different problems; combined, they form a powerful architecture for systems like banking, order management, healthcare records, and trading platforms.</p>
          <p>Both patterns come with real complexity costs ‚Äî they are <em>not the default choice</em> for CRUD applications. Apply them when the problem they solve is genuinely present in your domain.</p>

          <div class="callout">
            <strong>üí° The Core Problem Each Pattern Solves</strong>
            <ul>
              <li>‚úÖ <strong>Event Sourcing</strong> solves: "How do I know how this account balance got to this value?" ‚Äî traditional DBs only store <em>current state</em>, discarding the history of changes</li>
              <li>‚úÖ <strong>CQRS</strong> solves: "My read workload is 100√ó my write workload and needs a completely different data shape" ‚Äî a single model cannot be optimised for both simultaneously</li>
              <li>‚úÖ <strong>Combined:</strong> Solves: "I need independently scalable reads, full audit trails, and the ability to replay and reproject historical data into new views"</li>
            </ul>
          </div>

          <h2>Event Sourcing</h2>
          <div class="row g-3">
            <div class="col-md-6"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100">
              <h6 class="fw-bold">üìú How It Works</h6>
              <p class="mb-2">Instead of storing <em>current state</em> (UPDATE balance = 500), store the <em>sequence of events</em> that produced it (MoneyDeposited: +200, MoneyWithdrawn: -100‚Ä¶).</p>
              <ul class="mb-0 ps-3">
                <li>Event log is <strong>append-only and immutable</strong> ‚Äî events are never deleted or modified</li>
                <li>Current state = fold/replay all events from the beginning (or from a snapshot)</li>
                <li>Snapshots periodically capture current state to avoid replaying the entire log</li>
                <li>Events are facts in the past tense: <em>OrderPlaced, PaymentApproved, ShipmentDespatched</em></li>
              </ul>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100">
              <h6 class="fw-bold">‚úÖ Benefits &amp; ‚ùå Costs</h6>
              <ul class="mb-0 ps-3">
                <li>‚úÖ <strong>Complete audit trail:</strong> Every change is recorded with who, what, and when</li>
                <li>‚úÖ <strong>Time travel:</strong> Reconstruct state at any past point in time</li>
                <li>‚úÖ <strong>Event replay:</strong> Rebuild projections or fix bugs by replaying events through new logic</li>
                <li>‚úÖ <strong>Integration:</strong> Events are natural integration points for other bounded contexts</li>
                <li>‚ùå <strong>Query complexity:</strong> "What is the current balance?" requires replaying all events (or a snapshot cache)</li>
                <li>‚ùå <strong>Schema evolution:</strong> Old events must be upcasted when their schema changes</li>
                <li>‚ùå <strong>Eventual consistency:</strong> Read projections may lag behind the event log</li>
              </ul>
            </div></div>
          </div>

          <h2>CQRS ‚Äî Command Query Responsibility Segregation</h2>
          <div class="row g-3 mt-1">
            <div class="col-md-6"><div class="card border-0 bg-gradient-yellow p-3 rounded-3 h-100">
              <h6 class="fw-bold">‚úçÔ∏è The Command Side (Write Model)</h6>
              <p class="mb-2">Commands express <em>intent</em> ‚Äî they ask the system to do something. They are validated, business logic is applied, and if successful, one or more domain events are emitted.</p>
              <ul class="mb-0 ps-3">
                <li><code>PlaceOrder</code>, <code>CancelOrder</code>, <code>ApprovePayment</code></li>
                <li>Returns only success/failure ‚Äî never data</li>
                <li>Strongly consistent ‚Äî writes go through the domain model</li>
                <li>Optimised for throughput, not for query shape</li>
              </ul>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-purple p-3 rounded-3 h-100">
              <h6 class="fw-bold">üìñ The Query Side (Read Model / Projections)</h6>
              <p class="mb-2">Queries read from pre-built, denormalised <em>projections</em> ‚Äî materialised views tuned exactly to what each consumer needs.</p>
              <ul class="mb-0 ps-3">
                <li><code>GetOrderSummary</code>, <code>GetDashboardMetrics</code></li>
                <li>Returns data ‚Äî never mutates anything</li>
                <li>Eventually consistent ‚Äî built asynchronously from events</li>
                <li>Can have multiple read models, each optimised for a different consumer (mobile vs dashboard vs reporting)</li>
              </ul>
            </div></div>
          </div>

          <h2>How Event Sourcing + CQRS Work Together</h2>
          <div class="mermaid">
graph LR
    User["üë§ User"] -->|"1. Command"| CMD["‚úçÔ∏è Command Handler<br/>(Place Order)"]
    CMD -->|"2. Validate<br/>Business Rules"| BL["‚öôÔ∏è Domain Logic"]
    BL -->|"3. Emit Event"| EVT["üì¢ Domain Event<br/>(OrderPlaced)"]
    EVT -->|"4. Append"| ES[(üìú Event Store<br/>Immutable Log)]
    
    ES -.->|"5. Subscribe"| P1["üîÑ Projector 1<br/>(Mobile View)"]
    ES -.->|"5. Subscribe"| P2["üîÑ Projector 2<br/>(Dashboard)"]
    ES -.->|"5. Subscribe"| P3["üîÑ Projector 3<br/>(Reporting)"]
    
    P1 -->|"6. Build/Update"| RM1[(üìä Read Model 1<br/>Mobile API)]
    P2 -->|"6. Build/Update"| RM2[(üìä Read Model 2<br/>Dashboard SQL)]
    P3 -->|"6. Build/Update"| RM3[(üìä Read Model 3<br/>Analytics DW)]
    
    User2["üë§ User Query"] -->|"7. Read"| QH["üìñ Query Handler"]
    QH -->|"8. Fetch"| RM1
    QH -->|"8. Fetch"| RM2
    QH -->|"8. Fetch"| RM3
    
    QH -->|"9. Return Data"| User2
    
    style User fill:#dbeafe,stroke:#3b82f6,stroke-width:2px
    style User2 fill:#dbeafe,stroke:#3b82f6,stroke-width:2px
    style CMD fill:#fef3c7,stroke:#f59e0b,stroke-width:2px
    style BL fill:#fed7aa,stroke:#ea580c,stroke-width:2px
    style EVT fill:#fce7f3,stroke:#ec4899,stroke-width:2px
    style ES fill:#e9d5ff,stroke:#a855f7,stroke-width:3px
    style P1 fill:#dcfce7,stroke:#10b981
    style P2 fill:#dcfce7,stroke:#10b981
    style P3 fill:#dcfce7,stroke:#10b981
    style RM1 fill:#dbeafe,stroke:#3b82f6,stroke-width:2px
    style RM2 fill:#dbeafe,stroke:#3b82f6,stroke-width:2px
    style RM3 fill:#dbeafe,stroke:#3b82f6,stroke-width:2px
    style QH fill:#fef3c7,stroke:#f59e0b,stroke-width:2px
          </div>
          <div class="callout mt-3">
            <strong>End-to-End Flow:</strong><br/>
            User action ‚Üí <strong>Command</strong> (PlaceOrder) ‚Üí Validate business rules ‚Üí Emit <strong>Domain Event</strong> (OrderPlaced) ‚Üí Persist to <strong>Event Store</strong> ‚Üí <strong>Projector</strong> subscribes to event stream ‚Üí Builds/updates <strong>Read Model</strong> (denormalised view) ‚Üí <strong>Query</strong> returns from read model
          </div>

          <h2>When to Apply These Patterns</h2>
          <div class="table-responsive mt-2">
            <table class="table table-bordered table-striped">
              <thead><tr><th>Signal</th><th>Pattern to Apply</th><th>Example Domain</th></tr></thead>
              <tbody>
                <tr><td>"We need a full audit trail of every change"</td><td>Event Sourcing</td><td>Banking, healthcare, compliance systems</td></tr>
                <tr><td>"Our reads are 50√ó our writes; read queries are slow"</td><td>CQRS (read model)</td><td>E-commerce product search, dashboards</td></tr>
                <tr><td>"We need to rebuild a view after a bug fix"</td><td>Event Sourcing (replay)</td><td>Accounting period close, ledger reconciliation</td></tr>
                <tr><td>"Different clients need completely different data shapes"</td><td>CQRS (multiple projections)</td><td>Mobile app vs analytics vs admin portal</td></tr>
                <tr><td>"We need to correlate actions across multiple services"</td><td>Event Sourcing + Saga</td><td>Order fulfillment pipeline, payment + inventory + shipping</td></tr>
              </tbody>
            </table>
          </div>

          <h2>When NOT to Use These Patterns</h2>
          <div class="row g-3">
            <div class="col-md-4"><div class="card border-0 bg-gradient-red p-3 rounded-3 h-100"><strong>‚ùå Simple CRUD Apps</strong><p class="mt-1 mb-0"><small>If your domain is "create, read, update, delete" with no business logic, adding Event Sourcing is pure overhead with no benefit.</small></p></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-red p-3 rounded-3 h-100"><strong>‚ùå Small Teams / Early Stage</strong><p class="mt-1 mb-0"><small>The infrastructure complexity (event store, projectors, retries, eventual consistency handling) requires mature DevOps and experienced teams to operate safely.</small></p></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-red p-3 rounded-3 h-100"><strong>‚ùå Low-Frequency Changes</strong><p class="mt-1 mb-0"><small>If data rarely changes and read/write load is balanced, a standard query against a well-indexed table is simpler and faster to build and maintain.</small></p></div></div>
          </div>

          <div class="callout mt-4">üí° <strong>Event Stores in practice:</strong> EventStoreDB is purpose-built for Event Sourcing. Kafka is commonly used as an event stream (though it is a message broker, not an event store). PostgreSQL with an events table works well for moderate scale. Azure Service Bus / Event Hub for cloud-native deployments.</div>
        </section>

        <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ SEARCH SYSTEMS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
        <section id="search-systems" role="article">
          <h1>üîç Search Systems ‚Äî Inverted Indexes &amp; Elasticsearch</h1>
          <span class="badge">search</span> <span class="badge">inverted index</span> <span class="badge">elasticsearch</span>

          <h2>Introduction</h2>
          <p>Full-text search is <strong>fundamentally different from database lookups</strong>. A SQL query like <code>WHERE description LIKE '%azure design%'</code> scans every row sequentially ‚Äî catastrophically slow on millions of records. Search engines solve this with a different data structure entirely: the <strong>inverted index</strong>, which maps every distinct term to the list of documents containing it, enabling sub-second search across billions of records.</p>
          <p>Purpose-built search systems also handle capabilities that databases cannot: <em>fuzzy matching</em> (typo tolerance), <em>relevance ranking</em> (most relevant results first, not just any matching result), <em>faceted filtering</em> (filter by category, price range, rating simultaneously), and <em>geographic search</em> (find items within 5 km).</p>

          <div class="callout">
            <strong>üí° Why You Can't Use Your Primary Database for Search</strong>
            <ul>
              <li>‚úÖ <strong>Performance:</strong> LIKE queries with leading wildcards bypass B-tree indexes entirely ‚Äî full table scans degrade to O(n)</li>
              <li>‚úÖ <strong>Relevance:</strong> SQL returns matching rows but has no concept of "which result is most relevant" ‚Äî all matching rows are equal</li>
              <li>‚úÖ <strong>Language analysis:</strong> DBs don't natively handle stemming (run/running/ran), synonyms, or stop words (the, a, is)</li>
              <li>‚úÖ <strong>Aggregations:</strong> Faceted search (count by category while filtering) requires specialised aggregation engine, not SQL GROUP BY</li>
            </ul>
          </div>

          <h2>The Inverted Index ‚Äî Core Data Structure</h2>
          <div class="row g-3">
            <div class="col-md-6"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100">
              <h6 class="fw-bold">üìã How an Inverted Index Works</h6>
              <p class="mb-2">For each unique term in the corpus, the index stores a <strong>posting list</strong> ‚Äî every document containing that term, along with positional data for phrase matching and scoring data for relevance ranking.</p>
              <pre class="mb-0 small">"azure"  ‚Üí [doc1(pos:3, freq:2), doc4(pos:1, freq:1)]
"design" ‚Üí [doc1(pos:5, freq:1), doc2(pos:2, freq:3)]
"cloud"  ‚Üí [doc2(pos:4, freq:1), doc3(pos:1, freq:4)]</pre>
              <p class="mt-2 mb-0"><small>Query "azure design" ‚Üí intersect posting lists for "azure" AND "design" ‚Üí rank by combined score</small></p>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100">
              <h6 class="fw-bold">üîß Text Analysis Pipeline</h6>
              <p class="mb-2">Before indexing, text is processed through an <strong>analyser pipeline</strong>:</p>
              <ul class="mb-0 ps-3">
                <li><strong>Character filter:</strong> Strip HTML tags, normalise Unicode</li>
                <li><strong>Tokeniser:</strong> Split "System Design" ‚Üí ["System", "Design"]</li>
                <li><strong>Lowercase filter:</strong> "Azure" ‚Üí "azure"</li>
                <li><strong>Stop word filter:</strong> Remove "the", "a", "is", "and"</li>
                <li><strong>Stemmer:</strong> "running" ‚Üí "run", "designing" ‚Üí "design"</li>
                <li><strong>Synonym filter:</strong> "k8s" ‚Üî "kubernetes"</li>
              </ul>
              <p class="mt-2 mb-0"><small>The same pipeline runs on queries ‚Äî ensuring consistent term matching between index and query</small></p>
            </div></div>
          </div>

          <h2>Elasticsearch Architecture</h2>
          <div class="row g-3 mt-1">
            <div class="col-md-6"><div class="card border-0 bg-gradient-yellow p-3 rounded-3 h-100">
              <h6 class="fw-bold">‚ö° Core Architecture</h6>
              <ul class="mb-0 ps-3">
                <li>Built on <strong>Apache Lucene</strong> (open-source, per-node search library)</li>
                <li><strong>Index</strong> = logical namespace (like a database table)</li>
                <li><strong>Shard</strong> = one Lucene instance; index is split across shards for parallel search</li>
                <li><strong>Replica shard</strong> = copy of a primary shard for HA and read scale</li>
                <li><strong>Node</strong> = one running ES instance; cluster = multiple nodes</li>
                <li><strong>Near Real-Time (NRT):</strong> Documents become searchable within ~1 second of indexing</li>
                <li>REST API + JSON query DSL for all operations</li>
              </ul>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-purple p-3 rounded-3 h-100">
              <h6 class="fw-bold">üìä Supported Query Types</h6>
              <ul class="mb-0 ps-3">
                <li><strong>Full-text:</strong> <code>match</code>, <code>multi_match</code>, <code>match_phrase</code></li>
                <li><strong>Exact / structured:</strong> <code>term</code>, <code>range</code>, <code>exists</code></li>
                <li><strong>Fuzzy:</strong> <code>fuzzy</code> ‚Äî handles up to N character edit distance (typo tolerance)</li>
                <li><strong>Geo:</strong> <code>geo_distance</code>, <code>geo_bounding_box</code> ‚Äî location-based search</li>
                <li><strong>Compound:</strong> <code>bool</code> (must/should/must_not) ‚Äî combine query clauses</li>
                <li><strong>Aggregations:</strong> Terms agg (facets), Date histogram, Range buckets</li>
                <li><strong>Highlight:</strong> Return matched text snippets with search terms highlighted</li>
              </ul>
            </div></div>
          </div>

          <h2>Relevance Scoring Algorithms</h2>
          <div class="table-responsive mt-2">
            <table class="table table-bordered table-striped">
              <thead><tr><th>Algorithm</th><th>How it Works</th><th>When Used</th></tr></thead>
              <tbody>
                <tr><td><strong>TF-IDF</strong></td><td>Score = Term Frequency √ó Inverse Document Frequency. High score if term appears often in document but rarely across corpus.</td><td>Classic scoring, still used as the baseline for understanding</td></tr>
                <tr><td><strong>BM25</strong></td><td>Probabilistic extension of TF-IDF with saturation (prevents very long documents from dominating) and field length normalisation. ES default since v5.</td><td>Default relevance scoring in Elasticsearch and Lucene</td></tr>
                <tr><td><strong>Learning to Rank (LTR)</strong></td><td>ML model trained on click data / ratings reranks initial BM25 results using features (click-through rate, recency, user preferences)</td><td>E-commerce, personalised search (Google, Bing, Netflix)</td></tr>
                <tr><td><strong>Vector / Semantic Search</strong></td><td>Encode query and documents as dense vectors; find closest matches by cosine similarity or dot product (ANN search with HNSW index)</td><td>Semantic similarity, RAG pipelines, image search</td></tr>
              </tbody>
            </table>
          </div>

          <h2>Integration Pattern ‚Äî Never Use ES as Primary Store</h2>
          <div class="callout">
            <strong>The Dual-Write Pattern (Recommended):</strong><br/>
            Primary DB (PostgreSQL / MongoDB) = <strong>source of truth</strong> ‚Üí Change Data Capture (Debezium / Kafka Connect) or application-level event emission ‚Üí <strong>Search Index (Elasticsearch)</strong> updated asynchronously
          </div>
          <div class="row g-3 mt-2">
            <div class="col-md-4"><div class="card border-0 bg-gradient-teal p-3 rounded-3 h-100"><strong>üîÑ CDC via Debezium</strong><p class="mt-1 mb-0"><small>Reads the database transaction log (WAL / binlog) and streams every change as an event to Kafka, which feeds Elasticsearch. Zero code in the application layer ‚Äî completely transparent sync.</small></p></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-pink p-3 rounded-3 h-100"><strong>üì® Application-Level Events</strong><p class="mt-1 mb-0"><small>On every write, the application also publishes an event to a queue (RabbitMQ / Azure Service Bus). A consumer updates the search index. Simple but requires both writes to succeed or be retried.</small></p></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100"><strong>üîÅ Periodic Re-indexing</strong><p class="mt-1 mb-0"><small>Batch job re-indexes all changed records on a schedule (hourly, nightly). Simplest to implement; acceptable when near-real-time search is not required. Used for catalogue data.</small></p></div></div>
          </div>

          <div class="callout mt-4">üí° <strong>Lucene / ES in the Cloud:</strong> AWS OpenSearch Service, Azure AI Search, and Elastic Cloud all provide managed Elasticsearch-compatible deployments. Azure AI Search additionally supports built-in vector search, semantic ranker, and integrated Azure OpenAI embeddings ‚Äî making it the go-to choice for RAG (Retrieval-Augmented Generation) architectures on Azure.</div>
        </section>

        <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ BLOOM FILTERS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
        <section id="bloom-filters" role="article">
          <h1>üéØ Bloom Filters & Probabilistic Data Structures</h1>
          <span class="badge">bloom filter</span> <span class="badge">probabilistic</span> <span class="badge">space-efficient</span>

          <h2>Introduction</h2>
          <p>Bloom filters solve a fundamental problem: <strong>"Does this element exist in this set?"</strong> ‚Äî but using 10-100√ó less memory than storing the actual set. The trade-off: they are <em>probabilistic</em> ‚Äî false positives are possible ("maybe in set"), but false negatives are impossible ("definitely not in set").</p>
          <p>This property makes Bloom filters invaluable for <strong>avoiding expensive disk or network lookups</strong>. Before checking if a key exists on disk, query the Bloom filter in RAM ‚Äî if it says "not present", skip the disk read entirely. If it says "maybe present", perform the lookup. The space savings are so dramatic that they are embedded in nearly every write-optimized database.</p>

          <div class="callout">
            <strong>üí° Real-World Impact ‚Äî Cassandra's Disk Read Savings</strong><br/>
            Cassandra stores a Bloom filter per SSTable (on-disk sorted file). When reading key "user_12345", Cassandra checks all SSTable Bloom filters first. If 9 out of 10 SSTables say "key definitely not here", Cassandra avoids 9 disk seeks ‚Äî reducing query latency from 100ms to 10ms. Total memory cost: ~8 KB per million keys per SSTable.
          </div>

          <h2>How a Bloom Filter Works</h2>
          <div class="mermaid-container mt-3">
            <pre class="mermaid">
graph TD
    Start([Add Key: user_42]) --> Hash1[Hash Function 1<br/>hash1 = 3]
    Start --> Hash2[Hash Function 2<br/>hash2 = 7]
    Start --> Hash3[Hash Function 3<br/>hash3 = 11]
    
    Hash1 --> Bit1[Set Bit 3 = 1]
    Hash2 --> Bit2[Set Bit 7 = 1]
    Hash3 --> Bit3[Set Bit 11 = 1]
    
    Bit1 --> Array["Bit Array (16 bits)<br/>[0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0]"]
    Bit2 --> Array
    Bit3 --> Array
    
    Array --> Query([Query: Is user_99 present?])
    Query --> QHash1[Hash1 = 2]
    Query --> QHash2[Hash2 = 7]
    Query --> QHash3[Hash3 = 9]
    
    QHash1 --> Check{All bits = 1?}
    QHash2 --> Check
    QHash3 --> Check
    
    Check -->|Bit 2 = 0| No[‚ùå Definitely NOT in set]
    Check -->|All = 1| Maybe[‚ö†Ô∏è MAYBE in set<br/>Perform actual lookup]
    
    style Start fill:#e1f5ff
    style Array fill:#fff4e1
    style No fill:#d4edda
    style Maybe fill:#fff3cd
    style Check fill:#f8d7da
            </pre>
          </div>

          <h2>Key Properties</h2>
          <div class="row g-3 mt-2">
            <div class="col-md-3"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100 text-center"><strong>‚úÖ No False Negatives</strong><p class="mt-1 mb-0"><small>If filter says "not present", the key is 100% guaranteed absent. Safe to skip expensive lookup.</small></p></div></div>
            <div class="col-md-3"><div class="card border-0 bg-gradient-yellow p-3 rounded-3 h-100 text-center"><strong>‚ö†Ô∏è False Positives Possible</strong><p class="mt-1 mb-0"><small>If filter says "maybe present", must verify with actual lookup. False positive rate tunable via filter size and hash count.</small></p></div></div>
            <div class="col-md-3"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100 text-center"><strong>üóúÔ∏è Space-Efficient</strong><p class="mt-1 mb-0"><small>~10 bits per element for 1% false positive rate. Storing 1M keys: 1.25 MB vs 16+ MB for a hash set.</small></p></div></div>
            <div class="col-md-3"><div class="card border-0 bg-gradient-red p-3 rounded-3 h-100 text-center"><strong>‚ùå No Deletions</strong><p class="mt-1 mb-0"><small>Cannot remove elements (clearing a bit may affect other keys). Use Counting Bloom Filter or rebuild filter periodically.</small></p></div></div>
          </div>

          <h2>Configuration Trade-offs</h2>
          <div class="table-responsive mt-2">
            <table class="table table-bordered table-striped">
              <thead><tr><th>False Positive Rate</th><th>Bits per Element</th><th>Optimal Hash Functions</th><th>Use Case</th></tr></thead>
              <tbody>
                <tr><td><strong>1% (0.01)</strong></td><td>~10 bits</td><td>7 hash functions</td><td>Standard Cassandra / HBase ‚Äî good default balance</td></tr>
                <tr><td><strong>0.1% (0.001)</strong></td><td>~15 bits</td><td>10 hash functions</td><td>When disk seeks are very expensive; memory is cheap</td></tr>
                <tr><td><strong>5% (0.05)</strong></td><td>~7 bits</td><td>4 hash functions</td><td>Memory-constrained; can tolerate more false lookups</td></tr>
              </tbody>
            </table>
          </div>

          <h2>Real-World Applications</h2>
          <div class="row g-3 mt-1">
            <div class="col-md-4"><div class="card border-0 bg-gradient-purple p-3 rounded-3 h-100"><strong>üóÑÔ∏è Cassandra / HBase / RocksDB</strong><p class="mt-1 mb-0"><small>One Bloom filter per SSTable. Before disk read, check filter ‚Äî if negative, skip that SSTable entirely. Dramatically reduces read amplification.</small></p></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-teal p-3 rounded-3 h-100"><strong>üåê Web Crawlers (Google)</strong><p class="mt-1 mb-0"><small>Track billions of crawled URLs. Before fetching a page, check Bloom filter ‚Äî if negative, definitely new URL. Saves redundant HTTP requests.</small></p></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-pink p-3 rounded-3 h-100"><strong>üõ°Ô∏è Malicious URL Detection</strong><p class="mt-1 mb-0"><small>Chrome / Firefox store Bloom filters of known phishing sites locally. Check filter in-browser before sending URL to cloud API ‚Äî faster and privacy-preserving.</small></p></div></div>
          </div>

          <h2>Variants & Related Structures</h2>
          <div class="table-responsive mt-3">
            <table class="table table-bordered table-striped">
              <thead><tr><th>Data Structure</th><th>Problem Solved</th><th>Trade-off</th></tr></thead>
              <tbody>
                <tr><td><strong>Counting Bloom Filter</strong></td><td>Allows deletions ‚Äî use counters instead of bits</td><td>4-8√ó more memory than standard Bloom filter</td></tr>
                <tr><td><strong>Cuckoo Filter</strong></td><td>Supports deletions with better space efficiency than Counting Bloom</td><td>Slightly higher false positive rate; more complex implementation</td></tr>
                <tr><td><strong>HyperLogLog</strong></td><td>Count unique elements (cardinality estimation) with ~0.5% error</td><td>Cannot test membership ‚Äî only count distinct items</td></tr>
                <tr><td><strong>Count-Min Sketch</strong></td><td>Estimate frequency of elements in a stream</td><td>Overestimates frequency (never underestimates); no exact counts</td></tr>
              </tbody>
            </table>
          </div>

          <div class="callout mt-4">üí° <strong>When to Use Bloom Filters:</strong> Any time you have a large set in persistent storage and need to frequently check "is X in the set?" before doing an expensive lookup. Classic examples: database read path optimization, duplicate detection in streams, cache admission policies, and CDN negative caching (remembering which objects definitely don't exist to avoid origin requests).</div>
        </section>

        <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ LSM TREES ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
        <section id="lsm-trees" role="article">
          <h1>üå≥ LSM Trees ‚Äî Write-Optimized Storage</h1>
          <span class="badge">lsm tree</span> <span class="badge">storage engine</span> <span class="badge">write-heavy</span>

          <h2>Introduction</h2>
          <p>Traditional B-tree storage engines (used by PostgreSQL, MySQL InnoDB, SQL Server) are optimized for <strong>random reads</strong> ‚Äî they maintain a sorted tree on disk. Every write requires finding the right leaf page, updating it in place, and potentially rebalancing the tree. This is slow for write-heavy workloads.</p>
          <p><strong>Log-Structured Merge (LSM) trees</strong> invert this trade-off: they optimize for <strong>sequential writes</strong> instead. All writes go to an in-memory structure (MemTable), which is periodically flushed to disk as an immutable sorted file (SSTable). Reads must check multiple files, but writes are blazing fast. This is the foundation of Cassandra, RocksDB, LevelDB, HBase, and ScyllaDB.</p>

          <div class="callout">
            <strong>üí° Why LSM Trees Dominate Write-Heavy Systems</strong><br/>
            Sequential disk writes are 100-1000√ó faster than random writes (HDDs: 100 MB/s sequential vs 1 MB/s random; SSDs: 500 MB/s vs 50 MB/s). LSM trees convert random writes into sequential writes by buffering in memory and batch-flushing to disk. Result: Cassandra and RocksDB can sustain 100k+ writes/sec/node.
          </div>

          <h2>LSM Tree Architecture</h2>
          <div class="mermaid-container mt-3">
            <pre class="mermaid">
graph TB
    Write([Write: key=A, val=1]) --> MemTable["üìù MemTable (In-Memory)<br/>Sorted BST / Skip List<br/>Size: 64 MB"]
    MemTable -->|When full| Flush[Flush to Disk]
    
    Flush --> SSTable0["üíæ SSTable L0<br/>(Immutable sorted file)<br/>A=1, B=2, C=3"]
    
    SSTable0 -->|Compaction| L1["üìä Level 1<br/>(10x larger than L0)<br/>Merged SSTables"]
    L1 -->|Compaction| L2["üìä Level 2<br/>(10x larger than L1)<br/>Fewer, larger files"]
    L2 -->|Compaction| L3["üìä Level 3<br/>(10x larger than L2)<br/>Final sorted data"]
    
    Read([Read: key=A?]) --> CheckMem{In MemTable?}
    CheckMem -->|Yes| ReturnMem[Return from Memory ‚úÖ]
    CheckMem -->|No| CheckL0{In L0?}
    CheckL0 -->|Yes| ReturnL0[Return from L0 ‚úÖ]
    CheckL0 -->|No| CheckL1{In L1?}
    CheckL1 -->|Yes| ReturnL1[Return ‚úÖ]
    CheckL1 -->|No| CheckL2{In L2?}
    CheckL2 -->|Eventually found or not found| Result
    
    Result([Query Result])
    
    style MemTable fill:#d4edda,stroke:#28a745
    style SSTable0 fill:#fff3cd,stroke:#ffc107
    style L1 fill:#d1ecf1,stroke:#17a2b8
    style L2 fill:#e7d4f5,stroke:#6f42c1
    style L3 fill:#f8d7da,stroke:#dc3545
    style Write fill:#e1f5ff
    style Read fill:#e1f5ff
            </pre>
          </div>

          <h2>Write Path ‚Äî Why It's Fast</h2>
          <div class="row g-3 mt-2">
            <div class="col-md-4"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100"><strong>1Ô∏è‚É£ Write to WAL (Write-Ahead Log)</strong><p class="mt-1 mb-0"><small>Append-only log for crash recovery. Sequential disk write ‚Äî extremely fast (~1ms). Ensures durability even if MemTable is lost.</small></p></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100"><strong>2Ô∏è‚É£ Write to MemTable</strong><p class="mt-1 mb-0"><small>In-memory sorted structure (Red-Black Tree or Skip List). Write completes immediately. Acknowledged to client ‚Äî total latency < 5ms.</small></p></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-yellow p-3 rounded-3 h-100"><strong>3Ô∏è‚É£ Background Flush</strong><p class="mt-1 mb-0"><small>When MemTable reaches 64 MB, flush to disk as immutable SSTable. Sorted file format ‚Äî cannot be modified, only replaced during compaction.</small></p></div></div>
          </div>

          <h2>Read Path ‚Äî The Cost of Write Optimization</h2>
          <p class="mt-3">Reads must check <strong>multiple locations</strong> in order of recency (MemTable ‚Üí L0 SSTables ‚Üí L1 SSTables ‚Üí L2‚Ä¶) until the key is found or proven absent. This is called <strong>read amplification</strong>.</p>
          <div class="row g-3 mt-1">
            <div class="col-md-6"><div class="card border-0 bg-gradient-purple p-3 rounded-3 h-100"><strong>‚ùå Read Amplification Problem</strong><p class="mt-1 mb-0"><small>Reading a single key may require checking 10+ SSTables. Each SSTable is on disk ‚Äî potential 10+ disk seeks = 100ms+ latency.</small></p></div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-teal p-3 rounded-3 h-100"><strong>‚úÖ Mitigations</strong><ul class="mt-1 mb-0 ps-3"><li><strong>Bloom filters:</strong> Skip SSTables that definitely don't contain the key (90%+ of lookups avoided)</li><li><strong>Compaction:</strong> Merge small SSTables into larger ones ‚Äî reduces file count</li><li><strong>Block cache:</strong> Cache recently-read SSTable blocks in RAM</li></ul></div></div>
          </div>

          <h2>Compaction Strategies</h2>
          <div class="table-responsive mt-3">
            <table class="table table-bordered table-striped">
              <thead><tr><th>Strategy</th><th>How It Works</th><th>Pros</th><th>Cons</th></tr></thead>
              <tbody>
                <tr><td><strong>Size-Tiered (STCS)</strong></td><td>Merge SSTables of similar size when N files accumulate at a level</td><td>Simple; good for write-heavy, low space amplification</td><td>Temporary space spike during compaction (need 2√ó space); read amplification grows over time</td></tr>
                <tr><td><strong>Leveled (LCS)</strong></td><td>Each level is 10√ó larger; merge one L(n) file into L(n+1) incrementally</td><td>Predictable read performance ‚Äî each key in only one SSTable per level</td><td>Write amplification (same data rewritten multiple times); more I/O overhead</td></tr>
                <tr><td><strong>Time-Window (TWCS)</strong></td><td>Group SSTables by time window (e.g. hourly); expire old windows entirely</td><td>Perfect for time-series; old data deleted without compaction</td><td>Only works for time-series workloads with TTL</td></tr>
              </tbody>
            </table>
          </div>

          <h2>LSM vs B-Tree: When to Choose What</h2>
          <div class="table-responsive mt-3">
            <table class="table table-bordered table-striped">
              <thead><tr><th>Workload</th><th>Best Choice</th><th>Reasoning</th></tr></thead>
              <tbody>
                <tr><td>Write-heavy (logs, events, IoT)</td><td><strong>LSM Tree</strong></td><td>Sequential writes are 100√ó faster than random; handles 100k+ writes/sec</td></tr>
                <tr><td>Read-heavy (user profiles, inventory)</td><td><strong>B-Tree</strong></td><td>Single-seek reads; no read amplification; simpler queries (JOINs, transactions)</td></tr>
                <tr><td>Time-series with TTL</td><td><strong>LSM Tree (TWCS)</strong></td><td>Old SSTables deleted wholesale ‚Äî no tombstone overhead</td></tr>
                <tr><td>Strong consistency + ACID</td><td><strong>B-Tree</strong></td><td>PostgreSQL, MySQL provide full ACID; LSM systems typically eventual consistency</td></tr>
              </tbody>
            </table>
          </div>

          <h2>Databases Using LSM Trees</h2>
          <div class="row g-3 mt-2">
            <div class="col-md-3"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100 text-center"><strong>Cassandra / ScyllaDB</strong><p class="mt-1 mb-0"><small>Distributed wide-column store. LCS or STCS compaction. Handles petabyte-scale.</small></p></div></div>
            <div class="col-md-3"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100 text-center"><strong>RocksDB / LevelDB</strong><p class="mt-1 mb-0"><small>Embedded KV store. Used in blockchain, CockroachDB, TiDB. Leveled compaction default.</small></p></div></div>
            <div class="col-md-3"><div class="card border-0 bg-gradient-yellow p-3 rounded-3 h-100 text-center"><strong>HBase / BigTable</strong><p class="mt-1 mb-0"><small>Google's BigTable and its open-source clone. LSM on top of HDFS / GFS.</small></p></div></div>
            <div class="col-md-3"><div class="card border-0 bg-gradient-purple p-3 rounded-3 h-100 text-center"><strong>ClickHouse (MergeTree)</strong><p class="mt-1 mb-0"><small>OLAP database. LSM-like MergeTree engine. Handles trillion-row analytics.</small></p></div></div>
          </div>

          <div class="callout mt-4">üí° <strong>The LSM Trade-off:</strong> Write speed and storage efficiency come at the cost of read complexity and compaction overhead. For write-heavy systems (event logs, IoT, time-series), this trade-off is overwhelmingly worth it. For read-heavy OLTP systems, B-trees remain the better default. Know your access pattern before choosing.</div>
        </section>

        <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ DATABASE INDEXING ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
        <section id="db-indexing" role="article">
          <h1>üìá Database Indexing Deep Dive</h1>
          <span class="badge">indexing</span> <span class="badge">b-tree</span> <span class="badge">query optimization</span>

          <h2>Introduction</h2>
          <p>Indexes are the single most powerful tool for query performance ‚Äî and the most misunderstood. An index is a <strong>separate data structure</strong> that stores a sorted copy of one or more columns, plus pointers back to the full row. The database uses the index to jump directly to matching rows instead of scanning the entire table.</p>
          <p>Without an index, a query like <code>SELECT * FROM users WHERE email = 'user@example.com'</code> must scan every row in the table ‚Äî O(n). With an index on <code>email</code>, the database performs a binary search in the index ‚Äî O(log n) ‚Äî and jumps to the exact row. On a 10M row table, this is the difference between 10ms and 10 seconds.</p>

          <div class="callout">
            <strong>üí° The Index Golden Rule</strong><br/>
            Every query's WHERE, JOIN, and ORDER BY columns should be backed by an index ‚Äî unless the table is tiny (&lt; 1000 rows) or you genuinely need a full scan. Indexes are not optional performance hints; they are mandatory for any production query workload.
          </div>

          <h2>B+ Tree ‚Äî The Dominant Index Structure</h2>
          <div class="mermaid-container mt-3">
            <pre class="mermaid">
graph TB
    Root["üå≥ Root Node<br/>[40, 80]"]
    
    Root -->|"< 40"| L1A["Branch Node<br/>[20, 30]"]
    Root -->|"40-80"| L1B["Branch Node<br/>[50, 60, 70]"]
    Root -->|"‚â• 80"| L1C["Branch Node<br/>[90, 100]"]
    
    L1A -->|"< 20"| Leaf1["üçÉ Leaf: 10, 15, 18<br/>‚Üí Row pointers"]
    L1A -->|"20-30"| Leaf2["üçÉ Leaf: 22, 25, 28<br/>‚Üí Row pointers"]
    L1A -->|"‚â• 30"| Leaf3["üçÉ Leaf: 32, 35, 38<br/>‚Üí Row pointers"]
    
    L1B -->|"..."| LeafB["üçÉ Leaves..."]
    L1C -->|"..."| LeafC["üçÉ Leaves..."]
    
    Leaf1 -.->|Next Leaf| Leaf2
    Leaf2 -.->|Next Leaf| Leaf3
    Leaf3 -.->|Next Leaf| LeafB
    
    Query(["Query: WHERE age = 25"]) --> Root
    Root --> L1A
    L1A --> Leaf2
    Leaf2 --> RowPtr["Jump to row #1428<br/>‚úÖ O(log n) lookups"]
    
    style Root fill:#e1f5ff,stroke:#0066cc
    style L1A fill:#fff4e1,stroke:#ff9800
    style L1B fill:#fff4e1,stroke:#ff9800
    style L1C fill:#fff4e1,stroke:#ff9800
    style Leaf1 fill:#d4edda,stroke:#28a745
    style Leaf2 fill:#d4edda,stroke:#28a745
    style Leaf3 fill:#d4edda,stroke:#28a745
    style RowPtr fill:#d1ecf1
            </pre>
          </div>

          <h2>Clustered vs Non-Clustered Indexes</h2>
          <div class="table-responsive mt-2">
            <table class="table table-bordered table-striped">
              <thead><tr><th>Index Type</th><th>How Data is Stored</th><th>Read Performance</th><th>Write Cost</th></tr></thead>
              <tbody>
                <tr><td><strong>Clustered Index</strong></td><td>Table rows are physically sorted by the index key. Only one per table (usually the primary key). Leaf nodes ARE the data.</td><td>Range queries are extremely fast ‚Äî rows are contiguous on disk. Single-row lookup requires only one tree traversal.</td><td>INSERT/UPDATE that change sort order require moving rows physically ‚Äî expensive. Sequential inserts (auto-increment PK) are fast.</td></tr>
                <tr><td><strong>Non-Clustered (Secondary) Index</strong></td><td>Separate sorted structure. Leaf nodes contain index key + pointer to row (either PK or row address). Can have many per table.</td><td>Requires two lookups: (1) index tree traversal, (2) jump to row using pointer. Slightly slower than clustered.</td><td>Faster writes than clustered ‚Äî only update index, not move row. But every index adds write overhead.</td></tr>
              </tbody>
            </table>
          </div>

          <h2>Index Types & Use Cases</h2>
          <div class="row g-3 mt-1">
            <div class="col-md-6"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100">
              <h6 class="fw-bold">üîë Primary Key Index (Clustered)</h6>
              <ul class="mb-0 ps-3">
                <li><code>PRIMARY KEY (user_id)</code> ‚Äî uniqueness enforced, table sorted by key</li>
                <li>‚úÖ Single-row lookup by PK: O(log n) ‚Äî fastest possible</li>
                <li>‚úÖ Range scans (<code>WHERE user_id BETWEEN 1000 AND 2000</code>) read contiguous blocks</li>
                <li>‚ùå Random inserts cause page splits ‚Äî prefer auto-increment or ULID if insert-heavy</li>
              </ul>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100">
              <h6 class="fw-bold">üîç Secondary Index (Non-Clustered)</h6>
              <ul class="mb-0 ps-3">
                <li><code>CREATE INDEX idx_email ON users(email)</code> ‚Äî separate sorted structure</li>
                <li>‚úÖ Speeds up <code>WHERE email = 'x'</code> from O(n) to O(log n)</li>
                <li>‚úÖ Supports range queries, <code>ORDER BY email</code>, and equality checks</li>
                <li>‚ùå Every index slows down writes ‚Äî only index columns you query frequently</li>
              </ul>
            </div></div>
          </div>

          <div class="row g-3 mt-3">
            <div class="col-md-6"><div class="card border-0 bg-gradient-yellow p-3 rounded-3 h-100">
              <h6 class="fw-bold">üìö Composite (Multi-Column) Index</h6>
              <ul class="mb-0 ps-3">
                <li><code>CREATE INDEX idx_name_age ON users(last_name, first_name, age)</code></li>
                <li>‚úÖ Speeds up queries filtering/sorting by <strong>leftmost prefix</strong>: <code>(last_name)</code>, <code>(last_name, first_name)</code>, or all three</li>
                <li>‚ùå Does NOT help <code>WHERE first_name = 'John'</code> ‚Äî wrong column order</li>
                <li><strong>Index column order matters:</strong> most selective column first</li>
              </ul>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-purple p-3 rounded-3 h-100">
              <h6 class="fw-bold">üéØ Covering Index</h6>
              <ul class="mb-0 ps-3">
                <li>Index contains <strong>all columns needed by query</strong> ‚Äî no need to lookup row</li>
                <li><code>CREATE INDEX idx_cover ON orders(customer_id, order_date, total)</code></li>
                <li><code>SELECT order_date, total WHERE customer_id = 123</code> ‚Üí satisfied entirely from index</li>
                <li>‚úÖ Avoids row lookup ‚Äî cuts query time in half for high-cardinality scans</li>
              </ul>
            </div></div>
          </div>

          <div class="row g-3 mt-3">
            <div class="col-md-6"><div class="card border-0 bg-gradient-teal p-3 rounded-3 h-100">
              <h6 class="fw-bold">üé≠ Partial (Filtered) Index</h6>
              <ul class="mb-0 ps-3">
                <li><code>CREATE INDEX idx_active ON users(email) WHERE is_active = true</code></li>
                <li>‚úÖ Index only subset of rows ‚Äî smaller, faster, less write overhead</li>
                <li>PostgreSQL, SQL Server support this; MySQL does not</li>
                <li>Use case: index only "pending" orders, only "verified" users, etc.</li>
              </ul>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-pink p-3 rounded-3 h-100">
              <h6 class="fw-bold">üî† Unique Index</h6>
              <ul class="mb-0 ps-3">
                <li><code>CREATE UNIQUE INDEX idx_email ON users(email)</code></li>
                <li>‚úÖ Enforces uniqueness ‚Äî DB rejects duplicate inserts</li>
                <li>‚úÖ Slightly faster than non-unique index (can stop at first match)</li>
                <li>Automatically created for <code>PRIMARY KEY</code> and <code>UNIQUE</code> constraints</li>
              </ul>
            </div></div>
          </div>

          <h2>When Indexes Are NOT Used</h2>
          <div class="table-responsive mt-3">
            <table class="table table-bordered table-striped">
              <thead><tr><th>Query Pattern</th><th>Why Index is Ignored</th><th>Solution</th></tr></thead>
              <tbody>
                <tr><td><code>WHERE LOWER(email) = 'user@x.com'</code></td><td>Function on indexed column prevents index use</td><td>Create function-based index: <code>CREATE INDEX ON users(LOWER(email))</code> (PostgreSQL)</td></tr>
                <tr><td><code>WHERE age + 10 > 50</code></td><td>Expression on column ‚Äî index not applicable</td><td>Rewrite as <code>WHERE age > 40</code></td></tr>
                <tr><td><code>WHERE email LIKE '%@gmail.com'</code></td><td>Leading wildcard ‚Äî index cannot narrow search</td><td>Use full-text search (Elasticsearch) or trigram index (PostgreSQL <code>pg_trgm</code>)</td></tr>
                <tr><td><code>WHERE user_id != 100</code></td><td>Negation often scans most rows ‚Äî index unhelpful</td><td>Use positive condition or partition data</td></tr>
                <tr><td>Table has &lt; 1000 rows</td><td>Database optimizer chooses full scan ‚Äî faster than index overhead</td><td>This is correct behavior ‚Äî small tables don't benefit from indexes</td></tr>
              </tbody>
            </table>
          </div>

          <h2>Index Maintenance</h2>
          <div class="row g-3 mt-2">
            <div class="col-md-4"><div class="card border-0 bg-gradient-yellow p-3 rounded-3 h-100"><strong>üîß Reindex / Rebuild</strong><p class="mt-1 mb-0"><small>Indexes fragment over time (especially with UPDATE/DELETE). PostgreSQL: <code>REINDEX</code>. SQL Server: <code>ALTER INDEX REBUILD</code>. MySQL: <code>OPTIMIZE TABLE</code>. Schedule monthly for high-churn tables.</small></p></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-red p-3 rounded-3 h-100"><strong>‚ùå Remove Unused Indexes</strong><p class="mt-1 mb-0"><small>Every index adds write overhead. Query <code>pg_stat_user_indexes</code> (PostgreSQL) or <code>sys.dm_db_index_usage_stats</code> (SQL Server) to find zero-read indexes. Drop them.</small></p></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100"><strong>üìä Analyze Statistics</strong><p class="mt-1 mb-0"><small>Database maintains column cardinality stats to choose optimal index. Run <code>ANALYZE</code> (PostgreSQL) or <code>UPDATE STATISTICS</code> (SQL Server) after bulk loads.</small></p></div></div>
          </div>

          <div class="callout mt-4">üí° <strong>Index Design Checklist:</strong> (1) Index all foreign keys ‚Äî JOINs are unworkable without them. (2) Index WHERE clause columns in composite indexes with most selective first. (3) Use covering indexes for report queries to avoid row lookups. (4) Monitor index usage ‚Äî drop indexes with zero reads. (5) Rebuild fragmented indexes monthly. (6) Never index low-cardinality columns (gender, boolean) unless using partial indexes.</div>
        </section>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê ARCHITECTURE PATTERNS GROUP ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <section id="arch-patterns" role="article">
          <h1>üìå Architecture Patterns</h1>
          <span class="badge">architecture</span> <span class="badge">patterns</span> <span class="badge">design</span>

          <h2>Introduction</h2>
          <p>Architecture patterns define the <strong>macro-structure of your system</strong> ‚Äî how components are decomposed, how they communicate, and how failures are contained. Choosing the wrong pattern is one of the most expensive mistakes a team can make: it creates friction in every sprint for years and often requires a full system rewrite to escape.</p>
          <p>The patterns in this section span two concerns: <em>structural patterns</em> (how the system is organised ‚Äî monolith vs microservices, API Gateway, BFF) and <em>resilience patterns</em> (how the system behaves under failure or partial degradation ‚Äî message queues, sagas, circuit breakers, idempotency). Both concerns must be addressed for a production-grade system design.</p>

          <div class="callout">
            <strong>üí° Why Architecture Patterns Are Hard to Change Later</strong>
            <ul>
              <li>‚úÖ <strong>Coupling propagates:</strong> A tightly-coupled monolith embeds business logic across layers ‚Äî extracting a service requires untangling hundreds of dependencies simultaneously</li>
              <li>‚úÖ <strong>Distributed system bugs are subtle:</strong> Race conditions, partial failures, and eventual consistency issues only surface under production load ‚Äî not in unit tests</li>
              <li>‚úÖ <strong>Team structure follows architecture (Conway's Law):</strong> Microservices work best when team boundaries match service boundaries ‚Äî retrofitting org structure is as hard as the technical change</li>
              <li>‚úÖ <strong>Infrastructure investment:</strong> Service mesh, distributed tracing, and per-service CI/CD pipelines require significant platform investment before they pay dividends</li>
            </ul>
          </div>

          <h2>What's Covered in This Section</h2>

          <h3>üèõÔ∏è Monolith vs Microservices</h3>
          <p>The foundational decomposition decision. Covers the full spectrum from modular monolith to macro-services to fine-grained microservices, the hidden operational costs of distribution, Conway's Law, and the concrete signals that indicate when extraction is warranted.</p>

          <h3>üö™ API Gateway &amp; Backend-for-Frontend (BFF)</h3>
          <p>How to create a stable, client-optimised front door for a system with multiple backend services. API Gateway handles cross-cutting concerns (auth, rate limiting, routing); BFF tailors response shape per client type (mobile, web, IoT) to avoid over-fetching and under-fetching.</p>

          <h3>üì® Message Queues &amp; Pub/Sub</h3>
          <p>Async messaging decouples producers from consumers, enabling independent scaling and resilience. Covers point-to-point queues (Azure Service Bus, SQS, RabbitMQ) vs publish-subscribe fan-out (Kafka, Event Hub), and the critical Kafka concepts every engineer must know.</p>

          <h3>üîó Distributed Transactions &amp; Sagas</h3>
          <p>When a single business operation spans multiple services with their own databases, traditional 2PC is too fragile. The Saga pattern ‚Äî either choreography-based (event-driven) or orchestration-based (central coordinator) ‚Äî provides eventual consistency without distributed locking.</p>

          <h3>üîÅ Idempotency &amp; Retry Patterns</h3>
          <p>In distributed systems, every call can fail, timeout, or be retried. Idempotent operations ensure retries are safe. Covers idempotency keys, at-least-once vs at-most-once delivery semantics, exponential backoff with jitter, and dead-letter queues.</p>

          <h3>üåø Strangler Fig Pattern</h3>
          <p>The recommended approach for incrementally replacing a legacy system without a big-bang rewrite. Route traffic through a fa√ßade, migrate capability by capability to the new system, and retire the legacy only when 100% of routes are migrated ‚Äî with easy rollback at every step.</p>

          <div class="callout mt-3">
            <strong>üîó How These Patterns Layer Together</strong><br/>
            <em>Monolith vs Microservices</em> governs decomposition ‚Üí <em>API Gateway / BFF</em> provides unified client access ‚Üí <em>Message Queues</em> decouple inter-service communication ‚Üí <em>Sagas</em> coordinate multi-service transactions ‚Üí <em>Idempotency + Retry</em> make every operation safe under failure ‚Üí <em>Strangler Fig</em> enables evolution of all of the above over time.
          </div>

          <h2>Topics at a Glance</h2>
          <div class="row g-3 mt-1">
            <div class="col-md-4"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100"><h6 class="fw-bold">üèõÔ∏è Monolith vs Microservices</h6><ul class="mb-0 ps-3"><li>Monolith pros/cons and when it's the right choice</li><li>Microservices complexity tax ‚Äî real costs</li><li>Conway's Law and team topology alignment</li><li>Signals that indicate it's time to extract</li></ul></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100"><h6 class="fw-bold">üö™ API Gateway &amp; BFF</h6><ul class="mb-0 ps-3"><li>Cross-cutting concerns: auth, rate limit, routing</li><li>BFF per client type: mobile, web, IoT</li><li>Aggregation and protocol translation</li><li>Layering: Gateway in front of BFFs</li></ul></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-yellow p-3 rounded-3 h-100"><h6 class="fw-bold">üì® Message Queues &amp; Pub/Sub</h6><ul class="mb-0 ps-3"><li>Queue vs Pub/Sub: point-to-point vs fan-out</li><li>Kafka: topics, partitions, consumer groups, offsets</li><li>Kafka vs RabbitMQ vs Azure Service Bus</li><li>Backpressure and dead-letter queues</li></ul></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-purple p-3 rounded-3 h-100"><h6 class="fw-bold">üîó Distributed Transactions</h6><ul class="mb-0 ps-3"><li>Why 2PC fails in microservices</li><li>Saga: choreography vs orchestration</li><li>Compensating transactions for rollback</li><li>Eventual vs strong consistency trade-offs</li></ul></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-teal p-3 rounded-3 h-100"><h6 class="fw-bold">üîÅ Idempotency &amp; Retry</h6><ul class="mb-0 ps-3"><li>Idempotency keys for payment APIs</li><li>At-least-once vs at-most-once delivery</li><li>Exponential backoff with jitter</li><li>Dead-letter queues for persistent failures</li></ul></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-pink p-3 rounded-3 h-100"><h6 class="fw-bold">üåø Strangler Fig Pattern</h6><ul class="mb-0 ps-3"><li>Intercept ‚Üí Migrate ‚Üí Retire lifecycle</li><li>Fa√ßade / proxy as the routing layer</li><li>Data synchronisation during transition</li><li>Anti-corruption layer between old and new</li></ul></div></div>
          </div>
        </section>

        <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ MONOLITH VS MICROSERVICES ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
        <section id="monolith-microservices" role="article">
          <h1>üèõÔ∏è Monolith vs Microservices Architecture</h1>
          <span class="badge">monolith</span> <span class="badge">microservices</span> <span class="badge">architecture</span>

          <h2>Introduction</h2>
          <p>The monolith-vs-microservices decision is the most consequential structural choice in system design ‚Äî and the most frequently misunderstood. It is not a binary choice but a <strong>spectrum of decomposition</strong>, and the right position on that spectrum depends on team size, domain complexity, scale requirements, and operational maturity.</p>
          <p>The industry's hard-won lesson: <strong>most teams should start with a well-structured monolith</strong> and extract services only when they encounter concrete, measurable pain ‚Äî not in anticipation of future scale that may never arrive.</p>

          <div class="callout">
            <strong>üí° Conway's Law ‚Äî The Invisible Constraint</strong><br/>
            <em>"Any organization that designs a system will produce a design whose structure is a copy of the organization's communication structure."</em> ‚Äî Melvin Conway (1967)<br/><br/>
            This means: if you have 3 teams, you'll end up with 3 services ‚Äî regardless of whether that decomposition is technically optimal. Microservices work best when service boundaries intentionally align with team boundaries. Misaligned boundaries create cross-team coupling that negates all the autonomy benefits.
          </div>

          <h2>Monolith vs Microservices: The Real Trade-offs</h2>
          <div class="row g-3 mt-1">
            <div class="col-md-6"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100">
              <h6 class="fw-bold">üß± Monolith</h6>
              <p class="mb-2">A single deployable unit containing all domain logic, data access, and infrastructure code. Internal module calls are in-process function calls.</p>
              <ul class="mb-0 ps-3">
                <li>‚úÖ Simple to develop, test, debug, and deploy as a team grows</li>
                <li>‚úÖ In-process calls ‚Äî no network latency between modules</li>
                <li>‚úÖ ACID transactions span the entire domain ‚Äî no distributed transaction complexity</li>
                <li>‚úÖ Single deployment artifact, single observability surface, single log stream</li>
                <li>‚ùå Scales as a whole ‚Äî cannot independently scale the checkout module vs the search module</li>
                <li>‚ùå Single tech stack for the entire application lifecycle</li>
                <li>‚ùå Large codebase becomes hard to navigate without strong module boundaries</li>
                <li>‚ùå Long CI/CD pipelines as the codebase grows ‚Äî everyone's code tested together</li>
              </ul>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100">
              <h6 class="fw-bold">ü¶† Microservices</h6>
              <p class="mb-2">A suite of small, independently deployable services. Each service owns its own database and communicates via APIs or messages.</p>
              <ul class="mb-0 ps-3">
                <li>‚úÖ Scale individual services independently based on their specific load profile</li>
                <li>‚úÖ Technology heterogeneity ‚Äî use the best tool per service (Go for latency-sensitive, Python for ML)</li>
                <li>‚úÖ Smaller, focused teams deploy independently without coordination</li>
                <li>‚úÖ Failure isolation ‚Äî a crashed payment service does not crash the catalog service</li>
                <li>‚ùå Network calls between services introduce latency, timeouts, and partial failures</li>
                <li>‚ùå Data consistency across service boundaries requires sagas, eventual consistency</li>
                <li>‚ùå Observability complexity ‚Äî distributed tracing required to follow a request across 10 services</li>
                <li>‚ùå Operational overhead: separate CI/CD, per-service monitoring, service mesh, secret management</li>
              </ul>
            </div></div>
          </div>

          <h2>Side-by-Side Comparison</h2>
          <div class="table-responsive mt-2">
            <table class="table table-bordered table-striped">
              <thead><tr><th>Dimension</th><th>Monolith</th><th>Microservices</th></tr></thead>
              <tbody>
                <tr><td><strong>Deployment unit</strong></td><td>One binary / container image</td><td>N independent deployable services</td></tr>
                <tr><td><strong>Inter-module calls</strong></td><td>In-process function calls (~nanoseconds)</td><td>Network API / message (~milliseconds)</td></tr>
                <tr><td><strong>Transactions</strong></td><td>Single ACID transaction spans everything</td><td>Cross-service requires sagas / eventual consistency</td></tr>
                <tr><td><strong>Scaling</strong></td><td>Scale the whole app ‚Äî wasteful if load is uneven</td><td>Scale each service independently to its exact load</td></tr>
                <tr><td><strong>Team model</strong></td><td>One shared codebase ‚Äî coordination required</td><td>Team per service ‚Äî full autonomy within bounded context</td></tr>
                <tr><td><strong>Debugging</strong></td><td>Local stack trace, single log stream</td><td>Distributed traces across services (Jaeger, Zipkin)</td></tr>
                <tr><td><strong>Best starting point?</strong></td><td>‚úÖ Yes ‚Äî for most teams and products</td><td>‚ùå Only when team + domain complexity genuinely warrants it</td></tr>
              </tbody>
            </table>
          </div>

          <h2>The Decomposition Spectrum</h2>
          <div class="row g-2 mt-1">
            <div class="col text-center"><div class="card border-0 bg-gradient-blue p-2 rounded-3"><small><strong>Monolith</strong><br/>1 deployment</small></div></div>
            <div class="col-1 d-flex align-items-center justify-content-center">‚Üí</div>
            <div class="col text-center"><div class="card border-0 bg-gradient-green p-2 rounded-3"><small><strong>Modular Monolith</strong><br/>1 deployment, strong module boundaries</small></div></div>
            <div class="col-1 d-flex align-items-center justify-content-center">‚Üí</div>
            <div class="col text-center"><div class="card border-0 bg-gradient-yellow p-2 rounded-3"><small><strong>Macro-Services</strong><br/>3‚Äì5 coarse services</small></div></div>
            <div class="col-1 d-flex align-items-center justify-content-center">‚Üí</div>
            <div class="col text-center"><div class="card border-0 bg-gradient-purple p-2 rounded-3"><small><strong>Microservices</strong><br/>10‚Äì100+ fine-grained services</small></div></div>
          </div>

          <h2>Signals That It's Time to Extract a Service</h2>
          <div class="row g-3 mt-1">
            <div class="col-md-4"><div class="card border-0 bg-gradient-teal p-3 rounded-3 h-100"><strong>üìà Scaling Pressure</strong><p class="mt-1 mb-0"><small>One module consumes 10√ó the CPU/memory of the rest. Need to scale it independently without scaling the entire app.</small></p></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-pink p-3 rounded-3 h-100"><strong>üöÄ Deployment Velocity</strong><p class="mt-1 mb-0"><small>Two teams are blocking each other's releases on the same codebase 3+ times per week. Service boundary aligns with team boundary.</small></p></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-purple p-3 rounded-3 h-100"><strong>üîí Different NFRs</strong><p class="mt-1 mb-0"><small>A payment module needs PCI-DSS isolation, or a video processing module needs GPU nodes ‚Äî requirements incompatible with the rest of the app's hosting model.</small></p></div></div>
          </div>

          <div class="callout mt-4">üí° <strong>Martin Fowler's Rule:</strong> <em>"Don't start with microservices. Start with a monolith, and extract services when you feel the pain."</em> This is not laziness ‚Äî it is pragmatism. You cannot design correct service boundaries before you understand the domain deeply. Premature decomposition creates the wrong boundaries, which are then expensive to fix.</div>
        </section>

        <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ API GATEWAY & BFF ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
        <section id="api-gateway-bff" role="article">
          <h1>üö™ API Gateway &amp; Backend-for-Frontend (BFF)</h1>
          <span class="badge">api gateway</span> <span class="badge">bff</span> <span class="badge">backend for frontend</span>

          <h2>Introduction</h2>
          <p>As systems grow from a single service to tens or hundreds of services, clients cannot be expected to know how to call each individual service directly. The <strong>API Gateway</strong> provides a single, stable entry point that enforces cross-cutting concerns uniformly ‚Äî authentication, rate limiting, routing, caching, observability ‚Äî so that each backend service doesn't implement them independently.</p>
          <p>The <strong>Backend-for-Frontend (BFF)</strong> pattern extends this by recognising that different client types (mobile app, web SPA, IoT device) have fundamentally different data needs. Rather than one generic API that over-fetches for mobile and under-fetches for desktop, each client type gets a dedicated backend that returns exactly what it needs in exactly the shape it needs.</p>

          <div class="callout">
            <strong>üí° Why a Generic "One API Fits All" Fails</strong>
            <ul>
              <li>‚úÖ <strong>Mobile clients</strong> are on constrained bandwidth ‚Äî they want one call returning exactly what one screen needs</li>
              <li>‚úÖ <strong>Web SPAs</strong> may want richer data, real-time updates via WebSocket, and coarser aggregations</li>
              <li>‚úÖ <strong>Internal dashboards</strong> need admin-level aggregations that should never be exposed externally</li>
              <li>‚úÖ <strong>IoT devices</strong> may speak MQTT or CoAP, requiring protocol translation before reaching HTTP services</li>
              <li>‚úÖ A single generic API becomes a negotiation between all clients' conflicting needs ‚Äî resulting in a bloated, fragile contract</li>
            </ul>
          </div>

          <h2>API Gateway with BFF Pattern Architecture</h2>
          <div class="mermaid">
graph TB
    subgraph Clients["üì± Client Layer"]
        Mobile["üì± Mobile App"]
        Web["üíª Web SPA"]
        IoT["üìü IoT Device"]
    end
    
    subgraph Gateway["üö™ API Gateway Layer<br/>(Auth, Rate Limiting, SSL, Routing, Observability)"]
        APIGW["üõ°Ô∏è API Gateway<br/>(Azure APIM / Kong / AWS)"]
    end
    
    subgraph BFFLayer["üé® BFF Layer (Client-Specific Backends)"]
        BFF1["üì± Mobile BFF<br/>(Node.js)<br/>Owned by Mobile Team"]
        BFF2["üíª Web BFF<br/>(Go)<br/>Owned by Web Team"]
        BFF3["üìü IoT BFF<br/>(Python)<br/>Owned by IoT Team"]
    end
    
    subgraph Services["‚öôÔ∏è Backend Microservices"]
        UserSvc["üë§ User Service"]
        OrderSvc["üì¶ Order Service"]
        InvSvc["üìä Inventory Service"]
        PaySvc["üí≥ Payment Service"]
    end
    
    Mobile -->|"HTTPS"| APIGW
    Web -->|"HTTPS"| APIGW
    IoT -->|"MQTT ‚Üí HTTP"| APIGW
    
    APIGW -->|"/mobile/v1/*"| BFF1
    APIGW -->|"/web/v1/*"| BFF2
    APIGW -->|"/iot/v1/*"| BFF3
    
    BFF1 -->|"Aggregate<br/>3 calls"| UserSvc
    BFF1 --> OrderSvc
    BFF1 --> InvSvc
    
    BFF2 -->|"Aggregate<br/>4 calls"| UserSvc
    BFF2 --> OrderSvc
    BFF2 --> InvSvc
    BFF2 --> PaySvc
    
    BFF3 -->|"Single call"| OrderSvc
    BFF3 --> InvSvc
    
    style Mobile fill:#dbeafe,stroke:#3b82f6,stroke-width:2px
    style Web fill:#dbeafe,stroke:#3b82f6,stroke-width:2px
    style IoT fill:#dbeafe,stroke:#3b82f6,stroke-width:2px
    style APIGW fill:#dcfce7,stroke:#10b981,stroke-width:3px
    style BFF1 fill:#fef3c7,stroke:#f59e0b,stroke-width:2px
    style BFF2 fill:#fed7aa,stroke:#ea580c,stroke-width:2px
    style BFF3 fill:#fce7f3,stroke:#ec4899,stroke-width:2px
    style UserSvc fill:#e9d5ff,stroke:#a855f7
    style OrderSvc fill:#e9d5ff,stroke:#a855f7
    style InvSvc fill:#e9d5ff,stroke:#a855f7
    style PaySvc fill:#e9d5ff,stroke:#a855f7
          </div>

          <h2>API Gateway &amp; BFF Deep Dive</h2>
          <div class="row g-3 mt-1">
            <div class="col-md-6"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100">
              <h6 class="fw-bold">üö™ API Gateway ‚Äî Cross-Cutting Concerns</h6>
              <p class="mb-2"><small>Sits at the network edge. All client traffic enters here. Every cross-cutting concern enforced once, for all services.</small></p>
              <ul class="mb-0 ps-3">
                <li><strong>Authentication &amp; Authorisation:</strong> Validate JWT / OAuth2 tokens before traffic reaches any service</li>
                <li><strong>Rate limiting &amp; throttling:</strong> Per-client, per-route limits to prevent abuse</li>
                <li><strong>Request routing:</strong> Route <code>/orders/*</code> to order service, <code>/users/*</code> to user service</li>
                <li><strong>SSL termination:</strong> TLS at the gateway; services communicate over plain HTTP inside the VPC</li>
                <li><strong>Response caching:</strong> Cache identical GET responses to relieve backend load</li>
                <li><strong>Observability:</strong> Centralised access logs, metrics per route, correlation ID injection</li>
                <li><strong>Protocol translation:</strong> REST ‚Üí gRPC, HTTP/1.1 ‚Üí HTTP/2, REST ‚Üí GraphQL</li>
              </ul>
              <div class="mt-2"><span class="badge bg-primary">Azure API Management</span> <span class="badge bg-success">AWS API Gateway</span> <span class="badge bg-warning text-dark">Kong</span> <span class="badge bg-secondary">Nginx</span></div>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100">
              <h6 class="fw-bold">üé® Backend-for-Frontend (BFF) ‚Äî Client-Optimised Layer</h6>
              <p class="mb-2"><small>A dedicated backend service maintained by the frontend team, optimised for one specific client type's exact data needs.</small></p>
              <ul class="mb-0 ps-3">
                <li><strong>Client-tailored responses:</strong> Aggregate calls to multiple backend services; return a single client-shaped payload</li>
                <li><strong>Owned by the frontend team:</strong> Mobile team owns mobile BFF ‚Äî no cross-team API contract negotiation</li>
                <li><strong>Eliminates over-fetch and under-fetch:</strong> Mobile BFF returns only the fields needed for the screen</li>
                <li><strong>Per-client security model:</strong> Mobile BFF enforces PKCE; web BFF handles session cookies</li>
                <li><strong>Technology autonomy:</strong> Mobile BFF in Node.js; web BFF in Go ‚Äî each optimised for its use case</li>
                <li><strong>Independent deployment:</strong> Mobile BFF updated independently of web BFF ‚Äî no shared deployment coupling</li>
              </ul>
              <div class="mt-2"><span class="badge bg-info text-dark">Coined by Sam Newman</span> <span class="badge bg-secondary">Netflix, SoundCloud</span></div>
            </div></div>
          </div>

          <h2>Comparison: API Gateway vs BFF vs Direct Service Call</h2>
          <div class="table-responsive mt-2">
            <table class="table table-bordered table-striped">
              <thead><tr><th>Criterion</th><th>API Gateway</th><th>BFF</th><th>Direct Client ‚Üí Service</th></tr></thead>
              <tbody>
                <tr><td><strong>Primary purpose</strong></td><td>Cross-cutting enforcement (security, routing, limits)</td><td>Client-optimised aggregation and shaping</td><td>Simplest path, no intermediary</td></tr>
                <tr><td><strong>Who owns it?</strong></td><td>Platform / infra team</td><td>Frontend / client-specific team</td><td>N/A</td></tr>
                <tr><td><strong>Response shape</strong></td><td>Passes through as-is from backend</td><td>Transforms and aggregates for the specific client</td><td>Raw service contract</td></tr>
                <tr><td><strong>When to use</strong></td><td>Always ‚Äî every production system needs it</td><td>When 2+ client types have divergent data needs</td><td>Only acceptable for internal service-to-service calls</td></tr>
                <tr><td><strong>Caching</strong></td><td>At the gateway layer ‚Äî shared across clients</td><td>At the BFF layer ‚Äî client-specific cache</td><td>At the service layer</td></tr>
              </tbody>
            </table>
          </div>

          <h2>Common Topology: Gateway in Front of BFFs</h2>
          <div class="row g-3 mt-1">
            <div class="col-md-4"><div class="card border-0 bg-gradient-purple p-3 rounded-3 h-100"><strong>Gateway ‚Üí Mobile BFF</strong><p class="mt-1 mb-0"><small>Handles auth + rate limiting, then routes <code>/mobile/v1/*</code> to the mobile BFF. BFF aggregates user service + order service + inventory service into one optimised payload.</small></p></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-teal p-3 rounded-3 h-100"><strong>Gateway ‚Üí Web BFF</strong><p class="mt-1 mb-0"><small>Routes <code>/web/v1/*</code> to the web BFF. Web BFF returns richer data with embedded relationships, supports server-sent events for real-time dashboard updates.</small></p></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-pink p-3 rounded-3 h-100"><strong>Gateway ‚Üí Internal API</strong><p class="mt-1 mb-0"><small>Routes <code>/internal/v1/*</code> to an admin BFF. Enforces internal-only IP allowlist and admin roles. Returns aggregate analytics not exposed to external clients.</small></p></div></div>
          </div>

          <h2>API Versioning Strategies</h2>
          <div class="row g-3 mt-2">
            <div class="col-md-4"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100">
              <h6 class="fw-bold">üîó URI Path Versioning</h6>
              <p class="mb-2"><small>Embed version in the URL path: <code>/v1/users</code>, <code>/v2/users</code></small></p>
              <ul class="mb-0 ps-3">
                <li><small>‚úÖ <strong>Explicit and visible:</strong> Version is obvious in API calls and logs</small></li>
                <li><small>‚úÖ <strong>Easy routing:</strong> Simple to route different versions to different services</small></li>
                <li><small>‚úÖ <strong>Client control:</strong> Clients choose when to migrate to new version</small></li>
                <li><small>‚ùå <strong>URL pollution:</strong> Multiple versions clutter API surface area</small></li>
                <li><small>‚ùå <strong>Not RESTful:</strong> Same resource has different URIs across versions</small></li>
              </ul>
              <div class="mt-2"><span class="badge bg-primary">Stripe</span> <span class="badge bg-success">Twitter API</span></div>
            </div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100">
              <h6 class="fw-bold">üìã Header Versioning</h6>
              <p class="mb-2"><small>Specify version via custom HTTP header: <code>X-API-Version: 2</code> or <code>Accept</code> header with version in media type</small></p>
              <ul class="mb-0 ps-3">
                <li><small>‚úÖ <strong>Clean URLs:</strong> Resource URIs remain stable ‚Äî <code>/users</code> works across versions</small></li>
                <li><small>‚úÖ <strong>RESTful:</strong> Aligns with REST content negotiation principles</small></li>
                <li><small>‚úÖ <strong>Flexible:</strong> Per-endpoint versioning possible with fine-grained headers</small></li>
                <li><small>‚ùå <strong>Hidden:</strong> Version not visible in URL ‚Äî harder to debug from logs</small></li>
                <li><small>‚ùå <strong>Tooling friction:</strong> Browser testing and cURL calls require explicit headers</small></li>
              </ul>
              <div class="mt-2"><span class="badge bg-warning text-dark">GitHub API</span> <span class="badge bg-secondary">Azure</span></div>
            </div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-yellow p-3 rounded-3 h-100">
              <h6 class="fw-bold">üîç Query Parameter Versioning</h6>
              <p class="mb-2"><small>Version as query string: <code>/users?version=2</code> or <code>/users?api-version=2024-01-15</code></small></p>
              <ul class="mb-0 ps-3">
                <li><small>‚úÖ <strong>Optional fallback:</strong> Can default to latest version if param omitted</small></li>
                <li><small>‚úÖ <strong>Gradual rollout:</strong> Easy A/B testing with feature flags per version</small></li>
                <li><small>‚ùå <strong>Caching issues:</strong> Query params often bypass CDN caching layers</small></li>
                <li><small>‚ùå <strong>URL pollution:</strong> Every API call requires version param</small></li>
                <li><small>‚ùå <strong>Rarely recommended:</strong> Considered anti-pattern by most API design guides</small></li>
              </ul>
              <div class="mt-2"><span class="badge bg-danger">Avoid in new APIs</span></div>
            </div></div>
          </div>
          <div class="callout mt-2">üí° <strong>Recommendation:</strong> Use <strong>URI path versioning</strong> (<code>/v1/</code>, <code>/v2/</code>) for public APIs where explicit versioning aids client debugging and stability. Use <strong>header versioning</strong> for internal APIs or when RESTful purity matters. Support at least 2 major versions simultaneously (N and N-1) with a documented deprecation timeline (minimum 6‚Äì12 months notice before retiring old versions).</div>

          <div class="callout mt-4">üí° <strong>BFF is not always needed.</strong> If you have only one client type or all clients have similar needs, a single gateway with a well-designed service API is sufficient. Introduce BFF when you find yourself adding <code>?fields=</code> params to strip data, or writing multiple endpoint versions for different clients.</div>
        </section>

        <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ MESSAGE QUEUES & PUB/SUB ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
        <section id="message-queues" role="article">
          <h1>üì® Message Queues &amp; Pub/Sub (Kafka, RabbitMQ)</h1>
          <span class="badge">kafka</span> <span class="badge">rabbitmq</span> <span class="badge">pub/sub</span> <span class="badge">queues</span>

          <h2>Introduction</h2>
          <p>Synchronous request-response (REST, gRPC) is intuitive but creates tight temporal coupling: the caller must wait, and if the callee is slow or unavailable, the caller is blocked. <strong>Async messaging</strong> decouples producers from consumers in both time and space ‚Äî the producer writes a message and moves on, while the consumer processes at its own pace.</p>
          <p>The choice between a <strong>message queue</strong> (point-to-point) and a <strong>pub/sub topic</strong> (fan-out) depends on whether one consumer or many consumers need to act on each message. Production systems typically need both patterns.</p>

          <div class="callout">
            <strong>üí° Why Async Messaging Matters</strong>
            <ul>
              <li>‚úÖ <strong>Temporal decoupling:</strong> Producer finishes fast regardless of consumer speed or availability</li>
              <li>‚úÖ <strong>Independent scaling:</strong> Consumer instances scale out independently based on queue depth</li>
              <li>‚úÖ <strong>Resilience:</strong> Messages persist in the queue if the consumer is down ‚Äî no data loss on transient failures</li>
              <li>‚úÖ <strong>Backpressure signal:</strong> Growing queue depth indicates consumers are falling behind ‚Äî trigger auto-scaling</li>
              <li>‚úÖ <strong>Stable integration contract:</strong> A queue acts as a version-stable interface between services that evolve independently</li>
            </ul>
          </div>

          <h2>Queue vs Pub/Sub: Core Distinction</h2>
          <div class="mermaid">
graph LR
    subgraph "Message Queue (Point-to-Point)"
        P1["üì§ Producer"] -->|message| Q["üì• Queue"]
        Q -->|consumed by ONE| C1["‚öôÔ∏è Worker 1"]
        Q -.->|OR| C2["‚öôÔ∏è Worker 2"]
        Q -.->|OR| C3["‚öôÔ∏è Worker 3"]
    end
    
    subgraph "Pub/Sub (Fan-Out)"
        P2["üì° Publisher"] -->|event| T["üì¢ Topic"]
        T -->|copy to ALL| S1["üîî Email Service"]
        T -->|copy to ALL| S2["üìä Analytics"]
        T -->|copy to ALL| S3["üíæ Inventory"]
    end
    
    style Q fill:#dbeafe,stroke:#3b82f6,stroke-width:2px
    style T fill:#dcfce7,stroke:#10b981,stroke-width:2px
    style P1 fill:#fef3c7,stroke:#f59e0b
    style P2 fill:#fef3c7,stroke:#f59e0b
    style C1 fill:#e9d5ff,stroke:#a855f7
    style C2 fill:#e9d5ff,stroke:#a855f7
    style C3 fill:#e9d5ff,stroke:#a855f7
    style S1 fill:#fce7f3,stroke:#ec4899
    style S2 fill:#fce7f3,stroke:#ec4899
    style S3 fill:#fce7f3,stroke:#ec4899
          </div>
          <div class="row g-3 mt-3">
            <div class="col-md-6"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100">
              <h6 class="fw-bold">üìã Message Queue (Point-to-Point)</h6>
              <p class="mb-2"><small>Each message consumed by <strong>exactly one</strong> consumer. Deleted from queue after acknowledgement.</small></p>
              <ul class="mb-0 ps-3">
                <li><strong>Work distribution:</strong> Distribute tasks across a pool of worker instances (load levelling)</li>
                <li><strong>Per-message processing:</strong> Each order processed once by exactly one worker</li>
                <li><strong>Visibility timeout:</strong> Message hidden while processing; reappears if consumer crashes before ack</li>
                <li><strong>Dead-letter queue (DLQ):</strong> Messages failing N times move to DLQ for manual investigation</li>
                <li><strong>Deduplication IDs:</strong> Prevent double-processing when producers retry</li>
              </ul>
              <div class="mt-2"><span class="badge bg-primary">Azure Service Bus Queue</span> <span class="badge bg-warning text-dark">AWS SQS</span> <span class="badge bg-success">RabbitMQ</span></div>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100">
              <h6 class="fw-bold">üì° Pub/Sub (Fan-Out)</h6>
              <p class="mb-2"><small>Each message published to a topic delivered to <strong>all subscribed consumers</strong>. Each subscriber gets its own copy.</small></p>
              <ul class="mb-0 ps-3">
                <li><strong>Event broadcasting:</strong> OrderPlaced event ‚Üí inventory service + email service + analytics simultaneously</li>
                <li><strong>Durable subscription:</strong> Subscribers can pause and resume ‚Äî they don't miss messages while offline</li>
                <li><strong>Consumer groups (Kafka):</strong> Multiple instances form a group ‚Äî each message reaches the group once, partitions load-balanced across instances</li>
                <li><strong>Replay:</strong> Kafka retains messages for days/weeks ‚Äî new downstream services can replay entire event history</li>
                <li><strong>Filtering:</strong> Subscribers filter on attributes without the publisher needing to know about filters</li>
              </ul>
              <div class="mt-2"><span class="badge bg-danger">Apache Kafka</span> <span class="badge bg-primary">Azure Event Hub</span> <span class="badge bg-info text-dark">Azure Service Bus Topic</span></div>
            </div></div>
          </div>

          <h2>Apache Kafka ‚Äî Key Concepts</h2>
          <div class="row g-3 mt-1">
            <div class="col-md-3"><div class="card border-0 bg-gradient-yellow p-3 rounded-3 h-100"><strong>üìí Topic</strong><p class="mt-1 mb-0"><small>A named stream of messages. Analogous to a database table. Messages in a topic are ordered by offset within each partition.</small></p></div></div>
            <div class="col-md-3"><div class="card border-0 bg-gradient-purple p-3 rounded-3 h-100"><strong>üß± Partition</strong><p class="mt-1 mb-0"><small>Topics split into partitions for parallelism. Same key ‚Üí same partition (preserving per-key order). Partition count sets the upper bound on consumer parallelism.</small></p></div></div>
            <div class="col-md-3"><div class="card border-0 bg-gradient-teal p-3 rounded-3 h-100"><strong>üë• Consumer Group</strong><p class="mt-1 mb-0"><small>Set of consumer instances sharing consumption. Kafka assigns each partition to exactly one consumer in the group. Add consumers (up to partition count) to scale throughput linearly.</small></p></div></div>
            <div class="col-md-3"><div class="card border-0 bg-gradient-pink p-3 rounded-3 h-100"><strong>üìç Offset</strong><p class="mt-1 mb-0"><small>A monotonically increasing integer identifying message position within a partition. Consumers commit their offset to track progress. Reset offset to replay historical messages.</small></p></div></div>
          </div>

          <h2>Delivery Guarantees</h2>
          <div class="row g-3 mt-1">
            <div class="col-md-4"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100"><strong>üîÅ At-Least-Once</strong><p class="mt-1 mb-0"><small>Message delivered one or more times. Retried on failure. Possible duplicate processing. <strong>Consumer must be idempotent.</strong> Default in Kafka, SQS. Safest for no data loss.</small></p></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-yellow p-3 rounded-3 h-100"><strong>üì§ At-Most-Once</strong><p class="mt-1 mb-0"><small>Message delivered zero or one times. No retry on failure ‚Äî message may be lost. No duplicate processing. Acceptable for telemetry/metrics where occasional loss is tolerable.</small></p></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100"><strong>‚úÖ Exactly-Once</strong><p class="mt-1 mb-0"><small>Message delivered exactly once. Requires distributed transactions or idempotency + deduplication. Kafka transactions + idempotent producers support this. Complex and slow ‚Äî only for financial transactions.</small></p></div></div>
          </div>

          <h2>Kafka vs RabbitMQ vs Azure Service Bus</h2>
          <div class="table-responsive mt-2">
            <table class="table table-bordered table-striped">
              <thead><tr><th>Dimension</th><th>Apache Kafka</th><th>RabbitMQ</th><th>Azure Service Bus</th></tr></thead>
              <tbody>
                <tr><td><strong>Model</strong></td><td>Distributed append-only log; consumers pull</td><td>Broker with push delivery; message deleted on ack</td><td>Managed broker (queues + topics); cloud-native</td></tr>
                <tr><td><strong>Message retention</strong></td><td>Days to weeks (configurable)</td><td>Deleted on ack (unless DLQ)</td><td>Max 14 days (Premium)</td></tr>
                <tr><td><strong>Replay</strong></td><td>‚úÖ Yes ‚Äî reset offset to replay history</td><td>‚ùå No replay after ack</td><td>‚ùå No replay (except sessions)</td></tr>
                <tr><td><strong>Throughput</strong></td><td>Millions messages/sec with horizontal partitions</td><td>Tens of thousands messages/sec</td><td>Thousands messages/sec (scales with tier)</td></tr>
                <tr><td><strong>Ordering</strong></td><td>Per-partition order guaranteed</td><td>Per-queue order with single consumer</td><td>Per-session order; FIFO queues available</td></tr>
                <tr><td><strong>Best for</strong></td><td>Event streaming, audit log, analytics pipelines, CDC</td><td>Task queues, RPC-style, complex routing topologies</td><td>Enterprise integration, Azure-native workloads</td></tr>
              </tbody>
            </table>
          </div>

          <div class="callout mt-4">üí° <strong>Queue Depth Monitoring is essential.</strong> A growing queue depth is both a backpressure signal and an SLA breach indicator. Set CloudWatch / Azure Monitor alarms on queue depth to trigger consumer auto-scaling before consumers fall too far behind producers.</div>
        </section>

        <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ DISTRIBUTED TRANSACTIONS & SAGAS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
        <section id="distributed-transactions" role="article">
          <h1>üîó Distributed Transactions &amp; Sagas</h1>
          <span class="badge">saga</span> <span class="badge">transactions</span> <span class="badge">distributed</span>

          <h2>Introduction</h2>
          <p>In microservices, a single business operation may span multiple services, each with its own database. The classic solution ‚Äî <strong>Two-Phase Commit (2PC)</strong> ‚Äî requires a distributed lock coordinator and is too slow, too fragile, and incompatible with independently-scaled services.</p>
          <p>The <strong>Saga pattern</strong> replaces 2PC with a sequence of local transactions, each publishing an event or calling the next step. If any step fails, compensating transactions undo the preceding steps ‚Äî achieving eventual consistency without distributed locking.</p>

          <div class="callout">
            <strong>‚ö†Ô∏è Why 2PC Fails in Microservices</strong>
            <ul>
              <li>‚úÖ <strong>Blocking protocol:</strong> All participants must hold locks until the coordinator sends COMMIT ‚Äî locks span network round-trips, creating contention</li>
              <li>‚úÖ <strong>Single point of failure:</strong> If the coordinator crashes between Phase 1 and Phase 2, participants block indefinitely waiting for resolution</li>
              <li>‚úÖ <strong>Incompatible with NoSQL:</strong> Most microservice databases (DynamoDB, MongoDB, Cosmos DB) do not support XA distributed transactions</li>
              <li>‚úÖ <strong>Violates service autonomy:</strong> 2PC requires all participants to be available simultaneously ‚Äî negates the resilience benefit of microservices decomposition</li>
            </ul>
          </div>

          <h2>Two Saga Implementations</h2>
          <div class="mermaid">
sequenceDiagram
    participant O as Order Service
    participant I as Inventory Service
    participant P as Payment Service
    participant S as Shipping Service
    
    Note over O,S: Choreography Saga (Event-Driven)
    O->>O: Create Order
    O->>I: OrderCreated Event
    I->>I: Reserve Stock
    I->>P: StockReserved Event
    P->>P: Charge Card
    P->>S: PaymentSucceeded Event
    S->>S: Ship Order
    S->>O: OrderShipped Event
    O->>O: Mark CONFIRMED
    
    Note over O,S: Orchestration Saga (Workflow)
    O->>I: Reserve Stock (RPC)
    I-->>O: OK
    O->>P: Charge Card (RPC)
    P-->>O: OK
    O->>S: Ship Order (RPC)
    S-->>O: OK
    O->>O: Mark CONFIRMED
          </div>
          <div class="row g-3 mt-3">
            <div class="col-md-6"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100">
              <h6 class="fw-bold">üîÑ Choreography Saga</h6>
              <p class="mb-2"><small>Each service reacts to domain events and emits events to trigger the next step. No central orchestrator ‚Äî fully event-driven.</small></p>
              <ul class="mb-0 ps-3">
                <li>‚úÖ Loose coupling ‚Äî services don't know about each other, only about events</li>
                <li>‚úÖ No single point of failure ‚Äî distributed by design</li>
                <li>‚úÖ Scales naturally ‚Äî add consumers to event topics without changing producers</li>
                <li>‚ùå Hard to visualise the overall business flow across many services</li>
                <li>‚ùå Difficult to debug ‚Äî event chains can create cyclic dependencies</li>
                <li>‚ùå Testing requires spinning up the full event mesh</li>
              </ul>
              <div class="mt-2"><small><em>Pattern: OrderService publishes OrderCreated ‚Üí InventoryService reserves stock ‚Üí PaymentService charges card ‚Üí FulfillmentService ships</em></small></div>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100">
              <h6 class="fw-bold">üéõÔ∏è Orchestration Saga</h6>
              <p class="mb-2"><small>A central orchestrator (Saga Orchestrator or workflow engine) explicitly commands each service step in turn and handles failures.</small></p>
              <ul class="mb-0 ps-3">
                <li>‚úÖ Clear, single-place visibility of overall business flow</li>
                <li>‚úÖ Easy to add compensating transactions ‚Äî orchestrator handles rollback logic</li>
                <li>‚úÖ Simpler to test ‚Äî mock individual service responses</li>
                <li>‚ùå Orchestrator becomes a SPOF if not made HA</li>
                <li>‚ùå Introduces one more service to deploy, monitor, and maintain</li>
                <li>‚ùå Risk of the orchestrator accreting business logic it shouldn't own</li>
              </ul>
              <div class="mt-2"><span class="badge bg-warning text-dark">AWS Step Functions</span> <span class="badge bg-primary">Azure Logic Apps</span> <span class="badge bg-secondary">Temporal</span></div>
            </div></div>
          </div>

          <h2>Order Saga ‚Äî End-to-End Example with Compensating Transactions</h2>
          <div class="table-responsive mt-2">
            <table class="table table-bordered table-striped">
              <thead><tr><th>Step</th><th>Service</th><th>Action</th><th>Compensating Transaction</th></tr></thead>
              <tbody>
                <tr><td>1</td><td>Order Service</td><td>Create order (PENDING)</td><td>Cancel order ‚Üí set status CANCELLED</td></tr>
                <tr><td>2</td><td>Inventory Service</td><td>Reserve stock for order items</td><td>Release stock reservation</td></tr>
                <tr><td>3</td><td>Payment Service</td><td>Charge customer credit card</td><td>Issue refund to customer</td></tr>
                <tr><td>4</td><td>Shipping Service</td><td>Create shipping label &amp; schedule pickup</td><td>Cancel shipment label</td></tr>
                <tr><td>5</td><td>Order Service</td><td>Set order status CONFIRMED</td><td>N/A ‚Äî final step, all previous steps succeeded</td></tr>
              </tbody>
            </table>
          </div>

          <h2>When to Choose Each Saga Style</h2>
          <div class="row g-3 mt-1">
            <div class="col-md-6"><div class="card border-0 bg-gradient-purple p-3 rounded-3 h-100"><strong>Use Choreography When:</strong><ul class="mt-1 mb-0 ps-3"><li>Steps are loosely related and independently owned by separate teams</li><li>You want maximum decoupling and event-driven extensibility</li><li>You have mature event streaming infrastructure (Kafka / Event Hub)</li><li>Business flow is relatively simple (3‚Äì5 steps)</li></ul></div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-teal p-3 rounded-3 h-100"><strong>Use Orchestration When:</strong><ul class="mt-1 mb-0 ps-3"><li>Business flow has complex conditional logic, branching, or retries</li><li>You need a visible audit trail of saga execution state</li><li>Cross-team coordination requires a clear contract (orchestrator = contract)</li><li>Operations team needs to manually resume or replay failed sagas</li></ul></div></div>
          </div>

          <div class="callout mt-4">üí° Sagas guarantee <strong>eventual consistency</strong>, not strong consistency. The system may pass through intermediate observable states (e.g. order is created but not yet paid). Design your UI, error messages, and customer communications to handle these intermediate states gracefully.</div>
        </section>

        <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ IDEMPOTENCY & RETRY ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
        <section id="idempotency-retry" role="article">
          <h1>üîÅ Idempotency &amp; Retry Patterns</h1>
          <span class="badge">idempotency</span> <span class="badge">retry</span> <span class="badge">resilience</span>

          <h2>Introduction</h2>
          <p>In distributed systems, every network call can fail, timeout, or succeed but have its response lost in transit. The caller cannot distinguish between "the operation failed" and "the operation succeeded but I didn't get the response." This ambiguity makes <strong>blindly retrying any operation dangerous</strong> unless that operation is idempotent.</p>
          <p><strong>Idempotency</strong> is the property that performing an operation multiple times has the same effect as performing it once. <strong>Retry patterns</strong> define the strategy for re-attempting failed calls safely, without thundering herd effects or wasted resources.</p>

          <div class="callout">
            <strong>‚ö†Ô∏è The Double-Charge Problem ‚Äî Why This Matters</strong><br/>
            A user clicks "Pay". The payment service receives the request, charges the card successfully, but the response is lost due to a network blip. The client times out and retries. Without idempotency protection, the card is charged twice. With an <code>Idempotency-Key</code> header, the second request returns the first request's result from cache ‚Äî charge happens once, no refund needed.
          </div>

          <h2>Idempotency: Making Operations Safe to Retry</h2>
          <div class="row g-3 mt-1">
            <div class="col-md-6"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100">
              <h6 class="fw-bold">üîë Idempotent HTTP Methods</h6>
              <ul class="mb-0 ps-3">
                <li><strong>GET:</strong> Read-only ‚Äî safe and idempotent by definition</li>
                <li><strong>PUT:</strong> Replace a resource ‚Äî calling twice with same body = same state</li>
                <li><strong>DELETE:</strong> Idempotent ‚Äî deleting an already-deleted resource is a no-op (return 204)</li>
                <li><strong>POST:</strong> NOT idempotent by default ‚Äî creates new resource on each call</li>
                <li><strong>PATCH:</strong> Depends on the operation ‚Äî <code>set price = 10</code> is idempotent; <code>increment price by 10</code> is not</li>
              </ul>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100">
              <h6 class="fw-bold">üóùÔ∏è Idempotency Key Pattern (for POST)</h6>
              <ul class="mb-0 ps-3">
                <li>Client generates a UUID and sends it as <code>Idempotency-Key: &lt;uuid&gt;</code> header</li>
                <li>Server stores <code>(idempotency_key, response)</code> in a database or cache with a TTL (e.g. 24 hours)</li>
                <li>On retry: server finds the existing key ‚Üí returns stored response ‚Äî operation not re-executed</li>
                <li>On first request: execute operation, persist result, return it</li>
                <li><strong>Used by:</strong> Stripe payments, PayPal, AWS API calls, GitHub webhooks</li>
              </ul>
            </div></div>
          </div>

          <h2>Retry Strategies</h2>
          <div class="table-responsive mt-2">
            <table class="table table-bordered table-striped">
              <thead><tr><th>Strategy</th><th>Wait Pattern</th><th>When to Use</th><th>Risk</th></tr></thead>
              <tbody>
                <tr><td><strong>Immediate Retry</strong></td><td>No wait ‚Äî retry once immediately</td><td>Transient single-packet drop</td><td>May hit same overloaded instance</td></tr>
                <tr><td><strong>Fixed Backoff</strong></td><td>Wait N seconds between each attempt</td><td>Known periodic maintenance windows</td><td>Thundering herd if all clients retry at the same time</td></tr>
                <tr><td><strong>Exponential Backoff</strong></td><td>Wait doubles each attempt: 1s, 2s, 4s, 8s‚Ä¶</td><td>Most transient failures</td><td>Long waits before final failure ‚Äî set max retry count</td></tr>
                <tr><td><strong>Exponential Backoff + Jitter</strong></td><td>Backoff * random(0.5‚Äì1.5)</td><td>Any system with many clients retrying simultaneously</td><td>Slight unpredictability ‚Äî but prevents thundering herd</td></tr>
                <tr><td><strong>Circuit Breaker</strong></td><td>Stop retrying after N consecutive failures; wait for recovery window</td><td>Downstream fully down; don't waste resources retrying</td><td>May open prematurely under load spikes</td></tr>
              </tbody>
            </table>
          </div>

          <div class="mermaid-container mt-4">
            <pre class="mermaid">
graph TD
    Start([Request Initiated]) --> CheckKey{Idempotency<br/>Key Exists?}
    CheckKey -->|Yes| CheckCache{Key in<br/>Cache?}
    CheckCache -->|Found| ReturnCached[Return Cached Response<br/>‚úÖ No Re-execution]
    CheckCache -->|Not Found| Execute
    CheckKey -->|No/New Request| Execute[Execute Operation]
    
    Execute --> Result{Result?}
    Result -->|Success| SaveResponse[Save Response with Key<br/>TTL: 24h]
    SaveResponse --> Return[Return Success ‚úÖ]
    
    Result -->|Transient Failure<br/>429, 503, Timeout| CheckRetries{Retry<br/>Count &lt; Max?}
    CheckRetries -->|Yes| CheckCircuit{Circuit<br/>Breaker Open?}
    CheckCircuit -->|Closed| Backoff[Wait: 2^attempt √ó jitter<br/>1s ‚Üí 2s ‚Üí 4s ‚Üí 8s]
    Backoff --> Retry[Retry Request]
    Retry --> Execute
    
    CheckRetries -->|No| Failed[Mark Failed ‚ùå<br/>Return Error]
    CheckCircuit -->|Open| Failed
    
    Result -->|Permanent Failure<br/>400, 401, 404| Failed
    
    ReturnCached --> End([Request Complete])
    Return --> End
    Failed --> End
    
    style Start fill:#e1f5ff
    style Execute fill:#fff4e1
    style Return fill:#d4edda
    style ReturnCached fill:#d4edda
    style Failed fill:#f8d7da
    style Backoff fill:#fff3cd
    style SaveResponse fill:#d1ecf1
    style End fill:#e1f5ff
            </pre>
          </div>

          <h2>Delivery Semantics &amp; Their Idempotency Requirements</h2>
          <div class="row g-3 mt-1">
            <div class="col-md-4"><div class="card border-0 bg-gradient-purple p-3 rounded-3 h-100"><strong>At-Least-Once + Idempotent Consumer</strong><p class="mt-1 mb-0"><small>Producer retries until it gets an ack. Consumer may receive the same message 2+ times. Consumer <strong>must</strong> be idempotent (check: have I already processed this message ID?). Most robust pattern.</small></p></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-teal p-3 rounded-3 h-100"><strong>Dead-Letter Queue (DLQ)</strong><p class="mt-1 mb-0"><small>After N failed processing attempts, the message is moved to a DLQ instead of blocking the main queue. Operations team inspects DLQ messages to diagnose and replay. Prevents one bad message from blocking all processing.</small></p></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-pink p-3 rounded-3 h-100"><strong>Circuit Breaker Connection</strong><p class="mt-1 mb-0"><small>Retry + exponential backoff protects individual calls. Circuit Breaker protects the system holistically: once enough consecutive failures occur, it stops calling the downstream service entirely, giving it time to recover without retry storms.</small></p></div></div>
          </div>

          <div class="callout mt-4">‚ö†Ô∏è <strong>Only retry on idempotent operations ‚Äî or operations protected by an idempotency key.</strong> Retrying a non-idempotent POST without an idempotency key may cause double-charges, duplicate orders, or duplicate notifications. Always pair retry logic with idempotency key storage.</div>
        </section>

        <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ STRANGLER PATTERN ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
        <section id="strangler-pattern" role="article">
          <h1>üåø Strangler Fig Pattern for Modernization</h1>
          <span class="badge">strangler</span> <span class="badge">modernization</span> <span class="badge">migration</span>

          <h2>Introduction</h2>
          <p>The <strong>Strangler Fig pattern</strong> ‚Äî named after the strangler fig tree that envelopes and gradually replaces the host tree ‚Äî is the recommended strategy for incrementally replacing a legacy system. The new system grows around the old one, capability by capability, until the legacy withers and can be switched off.</p>
          <p>It is the antidote to the <strong>Big Bang Rewrite</strong>: the high-risk strategy of rewriting the entire system from scratch. History is littered with failed big bang rewrites that ran 2‚Äì3x over time/budget and delivered less functionality than the legacy they replaced.</p>

          <div class="callout">
            <strong>‚ö†Ô∏è Why Big-Bang Rewrites Fail</strong>
            <ul>
              <li>‚úÖ <strong>Years of implicit knowledge:</strong> Legacy systems contain years of edge-case handling that is not documented anywhere ‚Äî only in the code. A rewrite starts with incomplete requirements.</li>
              <li>‚úÖ <strong>Moving target:</strong> The business continues using the legacy while the rewrite progresses ‚Äî the legacy changes, and the rewrite falls further behind</li>
              <li>‚úÖ <strong>No early feedback:</strong> Nothing ships until the entire rewrite is done ‚Äî no opportunity to validate assumptions with real users</li>
              <li>‚úÖ <strong>All-or-nothing cutover:</strong> Switching from legacy to new system in one step is the highest-risk deployment possible ‚Äî any regression affects 100% of users simultaneously</li>
            </ul>
          </div>

          <h2>The Three Phases</h2>
          <div class="mermaid">
---
title: "Strangler Fig Pattern: Three Phases of Incremental Modernization"
---
graph TB
    subgraph Phase1["Phase 1: Intercept üü¶"]
        Users1["üë• All Users"] -->|"100% traffic"| Facade1["üö™ Fa√ßade / Gateway
(New Stable Interface)"]
        Facade1 -->|"100% ‚Üí Legacy"| Legacy1["üèöÔ∏è Legacy Monolith"]
        Legacy1 -.->|"All features"| DB1[("üíæ Legacy DB")]
    end
    
    subgraph Phase2["Phase 2: Migrate üü©"]
        Users2["üë• All Users"] -->|"100% traffic"| Facade2["üö™ Fa√ßade / Gateway"]
        Facade2 -->|"60% ‚Üí Legacy
(Orders, Reports)"| Legacy2["üèöÔ∏è Legacy Monolith"]
        Facade2 -->|"40% ‚Üí New
(Users, Auth)"| New2["‚ú® New Service(s)"]
        Legacy2 -.->|"Read/Write"| DB2[("üíæ Legacy DB")]
        New2 -.->|"Read/Write"| NewDB2[("üíæ New DB")]
        DB2 <-.->|"CDC<br/>Sync"| NewDB2
    end
    
    subgraph Phase3["Phase 3: Retire üü®"]
        Users3["üë• All Users"] -->|"100% traffic"| Facade3["üö™ Fa√ßade / Gateway"]
        Facade3 -->|"100% ‚Üí New"| New3["‚ú® Microservices
(Fully Migrated)"]
        Legacy3["üèöÔ∏è Legacy
DECOMMISSIONED ‚úÖ"]
        New3 -.->|"All data"| NewDB3[("üíæ New DB(s)")]
    end
    
    Phase1 -.->|"Next"| Phase2
    Phase2 -.->|"Next"| Phase3
    
    style Users1 fill:#dbeafe,stroke:#3b82f6,stroke-width:2px
    style Users2 fill:#dbeafe,stroke:#3b82f6,stroke-width:2px
    style Users3 fill:#dbeafe,stroke:#3b82f6,stroke-width:2px
    style Facade1 fill:#dcfce7,stroke:#10b981,stroke-width:2px
    style Facade2 fill:#dcfce7,stroke:#10b981,stroke-width:2px
    style Facade3 fill:#dcfce7,stroke:#10b981,stroke-width:2px
    style Legacy1 fill:#fee2e2,stroke:#dc2626
    style Legacy2 fill:#fed7aa,stroke:#ea580c
    style Legacy3 fill:#fee2e2,stroke:#dc2626,stroke-dasharray: 5 5
    style New2 fill:#fef3c7,stroke:#f59e0b,stroke-width:2px
    style New3 fill:#dcfce7,stroke:#10b981,stroke-width:3px
    style DB1 fill:#e9d5ff,stroke:#a855f7
    style DB2 fill:#e9d5ff,stroke:#a855f7
    style NewDB2 fill:#dbeafe,stroke:#3b82f6,stroke-width:2px
    style NewDB3 fill:#dbeafe,stroke:#3b82f6,stroke-width:2px
          </div>
          <div class="row g-3 mt-3">
            <div class="col-md-4"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100 text-center">
              <h6 class="fw-bold">Phase 1 ‚Äî Intercept</h6>
              <p class="mt-1 mb-0"><small>Place a <strong>fa√ßade / API Gateway / reverse proxy</strong> in front of the legacy system. All traffic routes through it ‚Äî 100% still going to legacy. No visible change to users. Fa√ßade becomes the stable external contract.</small></p>
            </div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100 text-center">
              <h6 class="fw-bold">Phase 2 ‚Äî Migrate</h6>
              <p class="mt-1 mb-0"><small>Build new capability in the new system (one domain/feature at a time). Update the fa√ßade to <strong>route that capability's traffic to the new system</strong>. Legacy still handles everything else. Dark launch to subset of users for safety.</small></p>
            </div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-yellow p-3 rounded-3 h-100 text-center">
              <h6 class="fw-bold">Phase 3 ‚Äî Retire</h6>
              <p class="mt-1 mb-0"><small>Once 100% of routes point to the new system, the fa√ßade no longer routes to the legacy. <strong>Decommission the legacy system.</strong> No big-bang cutover ‚Äî each capability was cut over individually with easy rollback.</small></p>
            </div></div>
          </div>

          <h2>Strangler Fig vs Big-Bang Rewrite</h2>
          <div class="table-responsive mt-2">
            <table class="table table-bordered table-striped">
              <thead><tr><th width="25%">Dimension</th><th>Strangler Fig</th><th>Big-Bang Rewrite</th></tr></thead>
              <tbody>
                <tr><td><strong>Risk profile</strong></td><td>Low ‚Äî each migration step is small and independently reversible</td><td>Extreme ‚Äî entire system switches at once, every bug hits all users</td></tr>
                <tr><td><strong>Business continuity</strong></td><td>‚úÖ Legacy serves users throughout migration; no downtime</td><td>‚ùå Business paused or at risk during cutover window</td></tr>
                <tr><td><strong>Feedback loop</strong></td><td>‚úÖ Real users validate each migrated capability in production</td><td>‚ùå No user feedback until the entire system is rewritten</td></tr>
                <tr><td><strong>Time to first value</strong></td><td>Weeks ‚Äî first capability migrated and in production quickly</td><td>Months to years before anything ships to users</td></tr>
                <tr><td><strong>Legacy knowledge</strong></td><td>‚úÖ Captured incrementally by working alongside the legacy</td><td>‚ùå Must understand &amp; replicate all legacy behaviour upfront</td></tr>
                <tr><td><strong>Team morale</strong></td><td>‚úÖ Visible, incremental progress keeps teams motivated</td><td>‚ùå Years of work before visible user impact ‚Äî high risk of abandonment</td></tr>
              </tbody>
            </table>
          </div>

          <h2>Key Implementation Challenges</h2>
          <div class="row g-3 mt-1">
            <div class="col-md-4"><div class="card border-0 bg-gradient-teal p-3 rounded-3 h-100"><strong>üóÉÔ∏è Data Synchronisation</strong><p class="mt-1 mb-0"><small>During migration, both old and new systems may write data. Use CDC (Change Data Capture) or event streaming to keep both databases in sync. Decide on a primary source of truth per entity.</small></p></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-purple p-3 rounded-3 h-100"><strong>üõ°Ô∏è Anti-Corruption Layer</strong><p class="mt-1 mb-0"><small>The new system should not directly understand the legacy data model. Build a translation layer (Anti-Corruption Layer) that converts legacy concepts to the new domain model ‚Äî keeps new system clean.</small></p></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-pink p-3 rounded-3 h-100"><strong>‚ö†Ô∏è Completion Pressure</strong><p class="mt-1 mb-0"><small>Teams may lose motivation to fully retire the legacy once the new system handles 80% of traffic. Establish a hard decommission deadline and track legacy usage metrics to maintain momentum.</small></p></div></div>
          </div>

          <div class="callout mt-4">üí° This pattern is endorsed by Martin Fowler and is the <strong>recommended approach</strong> for any significant system Modernization. It was used by Amazon (moving from monolith to microservices), Netflix (data centre to cloud), and many others. Strangle, don't rewrite.</div>
        </section>

        <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ REAL-TIME COMMUNICATION PATTERNS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
        <section id="realtime-communication" role="article">
          <h1>‚ö° Real-Time Communication Patterns</h1>
          <span class="badge">websocket</span> <span class="badge">sse</span> <span class="badge">polling</span> <span class="badge">real-time</span>

          <h2>Introduction</h2>
          <p>Traditional HTTP follows a <strong>request-response model</strong> ‚Äî the client asks, the server answers, then the connection closes. This works for static content but breaks down for <strong>real-time data</strong> (live chat, stock tickers, notifications, dashboards). The server has new data but no way to push it to the client until the client asks again.</p>
          <p>Real-time communication patterns solve this problem by either keeping the connection open (WebSocket, SSE) or repeatedly asking for updates (polling). Each pattern has different complexity, browser support, scalability, and failure modes.</p>

          <div class="callout">
            <strong>üí° Real-World Use Cases</strong>
            <ul>
              <li>‚úÖ <strong>Live chat / messaging:</strong> WhatsApp, Slack, Teams ‚Äî instant message delivery (WebSocket)</li>
              <li>‚úÖ <strong>Collaborative editing:</strong> Google Docs, Figma ‚Äî real-time cursor positions, edit conflicts (WebSocket)</li>
              <li>‚úÖ <strong>Live dashboards:</strong> Monitoring, analytics ‚Äî auto-refreshing metrics (SSE or Long Polling)</li>
              <li>‚úÖ <strong>Stock / crypto tickers:</strong> Real-time price updates (WebSocket for professional, SSE for casual)</li>
              <li>‚úÖ <strong>Notifications:</strong> Push notifications, alert banners (SSE or Short Polling)</li>
            </ul>
          </div>

          <h2>Communication Patterns Comparison</h2>
          <div class="mermaid-container mt-3">
            <pre class="mermaid">
graph TB
    subgraph SP["üì° Short Polling"]
        C1[Client] -->|1. Request| S1[Server]
        S1 -->|2. Response<br/>No new data| C1
        C1 -.->|Wait 5s| C1
        C1 -->|3. Request again| S1
        S1 -->|4. Response<br/>New data!| C1
    end
    
    subgraph LP["‚è≥ Long Polling"]
        C2[Client] -->|1. Request| S2[Server]
        S2 -.->|Holds connection<br/>until new data<br/>or timeout| S2
        S2 -->|2. Response<br/>New data after 30s| C2
        C2 -->|3. Immediate<br/>new request| S2
    end
    
    subgraph SSE["üì® Server-Sent Events"]
        C3[Client] -->|1. Open connection| S3[Server]
        S3 -->|2. Stream: event1| C3
        S3 -->|3. Stream: event2| C3
        S3 -->|4. Stream: event3| C3
        note3[" Connection stays open<br/>Server pushes data"]
    end
    
    subgraph WS["üîå WebSocket"]
        C4[Client] <-->|Bi-directional<br/>Full-duplex| S4[Server]
        C4 -->|Message: chat text| S4
        S4 -->|Message: ACK| C4
        S4 -->|Message: new msg| C4
        C4 -->|Message: typing| S4
    end
    
    style C1 fill:#dbeafe,stroke:#3b82f6
    style C2 fill:#dbeafe,stroke:#3b82f6
    style C3 fill:#dbeafe,stroke:#3b82f6
    style C4 fill:#dbeafe,stroke:#3b82f6
    style S1 fill:#dcfce7,stroke:#10b981
    style S2 fill:#fef3c7,stroke:#f59e0b
    style S3 fill:#fed7aa,stroke:#ea580c
    style S4 fill:#e9d5ff,stroke:#a855f7
            </pre>
          </div>

          <h2>Pattern Details</h2>
          <div class="table-responsive mt-2">
            <table class="table table-bordered table-striped">
              <thead><tr><th>Pattern</th><th>How It Works</th><th>Latency</th><th>Scalability</th><th>Complexity</th></tr></thead>
              <tbody>
                <tr>
                  <td><strong>Short Polling</strong></td>
                  <td>Client sends HTTP request every N seconds. Server immediately responds with current data or "no change".</td>
                  <td>High ‚Äî average delay = polling interval / 2 (e.g. poll every 10s ‚Üí 5s avg delay)</td>
                  <td>Poor ‚Äî wastes bandwidth with many empty responses; high server load</td>
                  <td>Simple ‚Äî standard HTTP; works everywhere</td>
                </tr>
                <tr>
                  <td><strong>Long Polling</strong></td>
                  <td>Client sends HTTP request. Server holds connection open until new data available or timeout (30-60s), then responds. Client immediately re-requests.</td>
                  <td>Low ‚Äî near-instant when data arrives (server pushes immediately)</td>
                  <td>Moderate ‚Äî requires one connection per client; connection pool exhaustion risk</td>
                  <td>Moderate ‚Äî requires server-side async handling; timeouts complicate retry logic</td>
                </tr>
                <tr>
                  <td><strong>Server-Sent Events (SSE)</strong></td>
                  <td>Client opens persistent HTTP connection. Server streams newline-delimited events over that connection indefinitely. Unidirectional: server ‚Üí client only.</td>
                  <td>Very low ‚Äî server pushes instantly; no polling overhead</td>
                  <td>Good ‚Äî one connection per client; lightweight protocol; auto-reconnect on disconnect</td>
                  <td>Simple ‚Äî built into browsers (EventSource API); text-only format; falls back to chunked transfer encoding</td>
                </tr>
                <tr>
                  <td><strong>WebSocket</strong></td>
                  <td>Upgrade HTTP to persistent, bi-directional TCP connection. Both client and server can send messages at any time. Full-duplex.</td>
                  <td>Very low ‚Äî no request/response overhead; messages sent immediately in both directions</td>
                  <td>Best ‚Äî efficient binary framing; minimal overhead per message; supports millions of connections per server</td>
                  <td>Higher ‚Äî requires WebSocket server library; complex reconnection logic; firewall/proxy compatibility issues</td>
                </tr>
              </tbody>
            </table>
          </div>

          <h2>When to Choose Each Pattern</h2>
          <div class="row g-3 mt-2">
            <div class="col-md-6"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100">
              <h6 class="fw-bold">üì° Short Polling</h6>
              <p class="mb-2"><small><strong>Use when:</strong> Updates are infrequent (once per minute or slower), simplicity is critical, or real-time isn't truly required.</small></p>
              <ul class="mb-0 ps-3">
                <li>‚úÖ Works with any HTTP server ‚Äî no special infrastructure</li>
                <li>‚úÖ Compatible with all proxies, firewalls, load balancers</li>
                <li>‚ùå High latency ‚Äî average delay = half the polling interval</li>
                <li>‚ùå Wastes bandwidth ‚Äî 90%+ responses may be "no change"</li>
              </ul>
              <div class="mt-2"><small><strong>Examples:</strong> Email client checking for new mail every 5 min, weather dashboard updating hourly.</small></div>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-yellow p-3 rounded-3 h-100">
              <h6 class="fw-bold">‚è≥ Long Polling</h6>
              <p class="mb-2"><small><strong>Use when:</strong> You need near-real-time updates but can't use WebSocket (firewall/proxy restrictions).</small></p>
              <ul class="mb-0 ps-3">
                <li>‚úÖ Lower latency than short polling ‚Äî data pushed when available</li>
                <li>‚úÖ Works over standard HTTP ‚Äî no protocol upgrade</li>
                <li>‚ùå Connection management complexity ‚Äî timeouts, reconnects</li>
                <li>‚ùå Connection pool exhaustion ‚Äî one connection per client</li>
              </ul>
              <div class="mt-2"><small><strong>Examples:</strong> Facebook Messenger (pre-WebSocket), older chat systems.</small></div>
            </div></div>
          </div>

          <div class="row g-3 mt-3">
            <div class="col-md-6"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100">
              <h6 class="fw-bold">üì® Server-Sent Events (SSE)</h6>
              <p class="mb-2"><small><strong>Use when:</strong> Only server ‚Üí client push is needed (no client messages, or client uses separate POST requests).</small></p>
              <ul class="mb-0 ps-3">
                <li>‚úÖ Simple ‚Äî built into browsers with <code>EventSource</code> API</li>
                <li>‚úÖ Auto-reconnect with last-event-id ‚Äî resume from disconnect</li>
                <li>‚úÖ Works over HTTP/2 ‚Äî multiplexed, efficient</li>
                <li>‚ùå Unidirectional ‚Äî server ‚Üí client only</li>
                <li>‚ùå Text-only (workaround: send JSON strings)</li>
              </ul>
              <div class="mt-2"><small><strong>Examples:</strong> Live sports scores, stock tickers, dashboard metrics, server logs streaming to browser.</small></div>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-purple p-3 rounded-3 h-100">
              <h6 class="fw-bold">üîå WebSocket</h6>
              <p class="mb-2"><small><strong>Use when:</strong> You need <strong>bi-directional</strong>, low-latency, high-frequency messaging (both client ‚Üí server and server ‚Üí client).</small></p>
              <ul class="mb-0 ps-3">
                <li>‚úÖ Full-duplex ‚Äî both sides send messages at any time</li>
                <li>‚úÖ Binary support ‚Äî efficient for video, audio, game state</li>
                <li>‚úÖ Lowest latency ‚Äî no HTTP overhead after handshake</li>
                <li>‚ùå Complex ‚Äî requires WebSocket server library (Socket.IO, SignalR)</li>
                <li>‚ùå Firewall issues ‚Äî some corporate proxies block WS</li>
              </ul>
              <div class="mt-2"><small><strong>Examples:</strong> Live chat (Slack, WhatsApp), multiplayer games, collaborative editing (Figma, Google Docs), trading platforms.</small></div>
            </div></div>
          </div>

          <h2>Implementation Considerations</h2>
          <div class="row g-3 mt-2">
            <div class="col-md-4"><div class="card border-0 bg-gradient-teal p-3 rounded-3 h-100"><strong>üîÑ Reconnection Logic</strong><p class="mt-1 mb-0"><small>All persistent connections drop eventually (network blip, server restart, load balancer timeout). Implement exponential backoff for reconnects. SSE has auto-reconnect; WebSocket requires manual handling.</small></p></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-pink p-3 rounded-3 h-100"><strong>üìà Scalability</strong><p class="mt-1 mb-0"><small>Each persistent connection consumes server memory (8-64 KB). For 100k concurrent users: 800 MB - 6 GB RAM. Use stateless servers + Redis Pub/Sub or Kafka for fan-out to avoid broadcasting to all server instances.</small></p></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-yellow p-3 rounded-3 h-100"><strong>üõ°Ô∏è Authentication</strong><p class="mt-1 mb-0"><small>WebSocket handshake is HTTP ‚Äî send auth token in initial request headers. SSE: send token as query param or via custom headers (if supported). Long Polling: standard HTTP auth per request.</small></p></div></div>
          </div>

          <h2>Hybrid Approach ‚Äî SignalR / Socket.IO</h2>
          <div class="callout mt-3">
            <strong>‚ú® Best of Both Worlds</strong><br/>
            Libraries like <strong>SignalR</strong> (.NET), <strong>Socket.IO</strong> (Node.js), and <strong>Phoenix Channels</strong> (Elixir) provide an abstraction layer that automatically falls back through transports:<br/>
            <code>WebSocket ‚Üí SSE ‚Üí Long Polling ‚Üí Short Polling</code><br/>
            The library detects what the client and network support, and uses the best available option. This solves firewall/proxy compatibility while maintaining real-time performance where possible.
          </div>

          <h2>Decision Tree</h2>
          <div class="table-responsive mt-3">
            <table class="table table-bordered table-striped">
              <thead><tr><th>Requirement</th><th>Recommended Pattern</th></tr></thead>
              <tbody>
                <tr><td>Update frequency &gt; once per minute</td><td>Short Polling (simplest)</td></tr>
                <tr><td>Server ‚Üí client push only (no client messages)</td><td>Server-Sent Events (SSE)</td></tr>
                <tr><td>Bi-directional messaging (chat, gaming, collaboration)</td><td>WebSocket</td></tr>
                <tr><td>Firewall/proxy blocks WebSocket</td><td>Long Polling or SSE (with automatic fallback via SignalR)</td></tr>
                <tr><td>Binary data (video, audio, protobuf)</td><td>WebSocket (binary frames)</td></tr>
                <tr><td>Millions of concurrent connections</td><td>WebSocket (most efficient after handshake)</td></tr>
              </tbody>
            </table>
          </div>

          <div class="callout mt-4">üí° <strong>Production Checklist:</strong> (1) Always implement exponential backoff on reconnect to prevent thundering herd. (2) Use stateless app servers + Redis Pub/Sub or Kafka for horizontal scaling. (3) Monitor connection count and memory usage ‚Äî set per-user connection limits. (4) Test reconnection logic ‚Äî simulate network partition, server restart, load balancer timeout. (5) For WebSocket, use a library (SignalR, Socket.IO) with automatic fallback unless you need raw performance.</div>
        </section>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê CLOUD & PLATFORM ENGINEERING GROUP ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <section id="cloud-platform" role="article">
          <h1>‚òÅÔ∏è Cloud &amp; Platform Engineering</h1>
          <span class="badge">cloud</span> <span class="badge">platform</span> <span class="badge">engineering</span>
        </section>

        <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ CLOUD & PLATFORM INTRODUCTION ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
        <section id="cloud-platform-introduction" role="article">
          <h1>üìñ Introduction</h1>
          <span class="badge">cloud</span> <span class="badge">platform</span> <span class="badge">overview</span>

          <h2>About Cloud &amp; Platform Engineering</h2>
          <p>Cloud engineering is not simply "running servers in someone else's data centre." It is a <strong>fundamentally different operational model</strong> ‚Äî ephemeral compute, pay-per-use economics, global distribution, and shared responsibility for security. Success requires adopting a new mental model: design for failure, automate everything, and treat infrastructure as code.</p>
          <p>This section covers the six pillars that separate production-grade cloud systems from hobby projects: resilience patterns, deployment automation, security architecture, and multi-region strategy.</p>

          <div class="callout">
            <strong>üí° The Cloud-Native Mental Model Shift</strong>
            <ul>
              <li>‚úÖ <strong>Expect failure:</strong> Hardware fails, networks partition, availability zones go down ‚Äî design so failures are graceful, not catastrophic</li>
              <li>‚úÖ <strong>Automate everything:</strong> If you can click through a wizard to deploy, someone will click through it differently next time ‚Äî infrastructure must be code</li>
              <li>‚úÖ <strong>Assume breach:</strong> The perimeter security model is dead ‚Äî every call must be authenticated and authorised, even internal service-to-service calls</li>
              <li>‚úÖ <strong>Measure before you fix:</strong> Observability (logs, metrics, traces) must be built in from day one ‚Äî you cannot debug what you cannot see</li>
              <li>‚úÖ <strong>Design for global scale:</strong> Multi-region is not a luxury for large systems ‚Äî a single-region outage can take down your entire business</li>
            </ul>
          </div>

          <h2>What's Covered in This Section</h2>

          <h3>üõ°Ô∏è Fault Tolerance &amp; High Availability</h3>
          <p>The foundational patterns for building systems that survive component failures: redundancy (Active-Active vs Active-Passive), health checks and automated failover, graceful degradation, and the hard numbers behind availability SLAs ‚Äî what "four nines" actually means in terms of downtime per year.</p>

          <h3>‚ö° Circuit Breaker &amp; Bulkhead</h3>
          <p>Two complementary resilience patterns that prevent cascade failures. Circuit Breaker stops calling a failing downstream service immediately (fail fast). Bulkhead compartmentalises resource pools so one slow dependency cannot starve others. Used together, they contain blast radius.</p>

          <h3>‚òÅÔ∏è Serverless &amp; Event-Driven Architecture</h3>
          <p>Serverless removes infrastructure management entirely ‚Äî no servers to patch, no idle cost, scales from zero to thousands of instances automatically. Event-Driven Architecture decouples services through events so they evolve, scale, and fail independently. The combination is powerful for elastic, cost-efficient systems.</p>

          <h3>üèóÔ∏è Infrastructure as Code (IaC)</h3>
          <p>Every cloud resource ‚Äî networks, databases, compute, policies ‚Äî defined in version-controlled, peer-reviewed, machine-readable configuration files. Eliminates configuration drift, enables disaster recovery in minutes, and makes every infrastructure change auditable and reversible.</p>

          <h3>üîí Zero-Trust Architecture</h3>
          <p>The security model that replaced perimeter-based "castle and moat" thinking. Zero-Trust operates on three principles: verify every identity explicitly, enforce least-privilege access, and assume breach at all times. Covers identity pillars, mTLS service mesh, and the NIST / Microsoft implementation model.</p>

          <h3>üåç Multi-Region Active-Active / Active-Passive</h3>
          <p>Running across multiple geographic regions eliminates single-region outages as a business risk and reduces latency for global users. Covers the trade-offs between Active-Active (zero failover time, complex writes) and Active-Passive (simpler consistency, non-zero RTO/RPO), and the data replication strategies that make each viable.</p>

          <div class="callout mt-3">üîó <strong>How these topics interconnect:</strong> IaC provisions the infrastructure ‚Üí Fault Tolerance patterns make it resilient ‚Üí Circuit Breakers contain failures ‚Üí Serverless + EDA make it elastic ‚Üí Zero-Trust secures every call ‚Üí Multi-Region ensures it survives regional disasters.</div>

          <h2>Topics at a Glance</h2>
          <div class="row g-3 mt-1">
            <div class="col-md-4"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100"><h6 class="fw-bold">üõ°Ô∏è Fault Tolerance &amp; HA</h6><ul class="mb-0 ps-3"><li>Active-Active vs Active-Passive redundancy</li><li>Liveness vs readiness health probes</li><li>Graceful degradation and feature flags</li><li>Availability nines and their business cost</li></ul></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100"><h6 class="fw-bold">‚ö° Circuit Breaker &amp; Bulkhead</h6><ul class="mb-0 ps-3"><li>Closed / Open / Half-Open circuit states</li><li>Fail-fast vs waiting for timeouts</li><li>Thread pool and connection pool isolation</li><li>Polly, Resilience4j, Envoy implementations</li></ul></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-yellow p-3 rounded-3 h-100"><h6 class="fw-bold">‚òÅÔ∏è Serverless &amp; Event-Driven</h6><ul class="mb-0 ps-3"><li>Function triggers: HTTP, queue, schedule, event</li><li>Cold start mitigation strategies</li><li>Event schema evolution and versioning</li><li>EDA vs request-response trade-offs</li></ul></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-purple p-3 rounded-3 h-100"><h6 class="fw-bold">üèóÔ∏è Infrastructure as Code</h6><ul class="mb-0 ps-3"><li>Terraform, Bicep, Pulumi, AWS CDK</li><li>Declarative vs imperative approaches</li><li>GitOps: infra changes via pull request</li><li>Drift detection and state management</li></ul></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-teal p-3 rounded-3 h-100"><h6 class="fw-bold">üîí Zero-Trust Architecture</h6><ul class="mb-0 ps-3"><li>Verify identity explicitly ‚Äî MFA, short-lived tokens</li><li>Least-privilege: RBAC, ABAC, JIT access</li><li>Assume breach: mTLS, network segmentation</li><li>6 NIST pillars: identity, devices, apps, data, infra, network</li></ul></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-pink p-3 rounded-3 h-100"><h6 class="fw-bold">üåç Multi-Region Strategy</h6><ul class="mb-0 ps-3"><li>Active-Active: zero RTO, complex write conflicts</li><li>Active-Passive: simple consistency, non-zero RTO</li><li>RPO and RTO targets and how to meet them</li><li>DNS geo-routing and traffic manager</li></ul></div></div>
          </div>
        </section>

        <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ FAULT TOLERANCE & HA ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
        <section id="fault-tolerance-ha" role="article">
          <h1>üõ°Ô∏è Designing for Fault Tolerance &amp; High Availability</h1>
          <span class="badge">fault tolerance</span> <span class="badge">ha</span> <span class="badge">availability</span>

          <h2>Introduction</h2>
          <p><strong>Fault tolerance</strong> is the ability to continue operating correctly when one or more components fail. <strong>High Availability (HA)</strong> is the ability to remain accessible for a specified percentage of time ‚Äî expressed as "nines" (99.9%, 99.99%, etc.). They are related but distinct: a system can have HA through rapid failover without being truly fault tolerant (if failover causes a brief outage).</p>
          <p>The key insight for distributed systems: <strong>individual component failure is not a question of "if" but "when."</strong> Hardware degrades, networks partition, deployments introduce bugs, dependencies have outages. Fault-tolerant design accepts this reality and engineers graceful handling rather than hoping failure won't occur.</p>

          <div class="callout">
            <strong>üí° The Cost of Downtime ‚Äî Why HA Investment is Justified</strong>
            <ul>
              <li>‚úÖ <strong>Revenue loss:</strong> Amazon reported ~$220M/hour loss during a major outage ‚Äî even brief outages are expensive for transactional systems</li>
              <li>‚úÖ <strong>Reputation damage:</strong> A 2-hour outage can drive users to competitors permanently ‚Äî especially in competitive markets</li>
              <li>‚úÖ <strong>SLA penalties:</strong> Enterprise contracts include financial penalties for availability breaches ‚Äî each minute of downtime has a dollar cost</li>
              <li>‚úÖ <strong>Data loss risk:</strong> Unplanned downtime often accompanies data corruption or loss ‚Äî the recovery cost dwarfs the prevention cost</li>
            </ul>
          </div>

          <h2>Core Fault Tolerance Patterns</h2>
          <div class="row g-3 mt-1">
            <div class="col-md-4"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100">
              <h6 class="fw-bold">üîÄ Redundancy</h6>
              <p class="mb-2"><small>Eliminate single points of failure by running multiple instances of every critical component.</small></p>
              <ul class="mb-0 ps-3">
                <li><strong>Active-Active:</strong> All nodes serve live traffic simultaneously ‚Äî zero failover time, maximum utilisation</li>
                <li><strong>Active-Passive:</strong> Primary serves all traffic; standby activates on failure ‚Äî simpler consistency, brief failover window</li>
                <li><strong>N+1 redundancy:</strong> Always have one more instance than needed to absorb failures without impact</li>
                <li><strong>Geographic redundancy:</strong> Spread instances across availability zones (AZs) within a region ‚Äî AZ-level faults don't cause outage</li>
              </ul>
            </div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100">
              <h6 class="fw-bold">üè• Health Checks &amp; Automated Failover</h6>
              <p class="mb-2"><small>Continuously verify instance health so load balancers and orchestrators can route away from unhealthy nodes automatically.</small></p>
              <ul class="mb-0 ps-3">
                <li><strong>Liveness probe:</strong> "Is the process alive?" ‚Äî if it fails, restart the container/pod</li>
                <li><strong>Readiness probe:</strong> "Is it ready to serve traffic?" ‚Äî if it fails, remove from load balancer pool but don't restart</li>
                <li><strong>Startup probe:</strong> Prevents premature liveness checks on slow-starting services</li>
                <li><strong>Heartbeat timeout:</strong> If no heartbeat in N seconds, mark instance dead and trigger replacement</li>
              </ul>
            </div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-yellow p-3 rounded-3 h-100">
              <h6 class="fw-bold">üì¶ Graceful Degradation</h6>
              <p class="mb-2"><small>When a dependency fails, serve reduced but still useful functionality rather than failing completely.</small></p>
              <ul class="mb-0 ps-3">
                <li><strong>Stale cache fallback:</strong> Return cached data from Redis even if the source database is down</li>
                <li><strong>Feature flags:</strong> Disable non-critical features (recommendation engine, analytics) to protect core functionality</li>
                <li><strong>Static fallback:</strong> Serve a static page or default response when the dynamic service is unavailable</li>
                <li><strong>Queue and retry:</strong> Accept the request, queue it for later processing rather than rejecting it</li>
              </ul>
            </div></div>
          </div>

          <h2>Failure Taxonomy ‚Äî What You're Designing Against</h2>
          <div class="table-responsive mt-2">
            <table class="table table-bordered table-striped">
              <thead><tr><th>Failure Type</th><th>Example</th><th>Primary Mitigation</th></tr></thead>
              <tbody>
                <tr><td><strong>Node / hardware failure</strong></td><td>VM crash, disk failure, network card failure</td><td>Multiple availability zones, auto-replacement via ASG/VMSS</td></tr>
                <tr><td><strong>Availability zone outage</strong></td><td>AWS us-east-1a AZ power failure</td><td>AZ-aware deployment with inter-AZ load balancing</td></tr>
                <tr><td><strong>Regional outage</strong></td><td>Full Azure East US region outage</td><td>Multi-region Active-Active or Active-Passive deployment</td></tr>
                <tr><td><strong>Network partition</strong></td><td>Firewall misconfiguration; split brain</td><td>Circuit Breaker, timeout + retry, fallback responses</td></tr>
                <tr><td><strong>Dependency failure</strong></td><td>Payment API is down; database unreachable</td><td>Circuit Breaker, Bulkhead, graceful degradation</td></tr>
                <tr><td><strong>Deployment failure</strong></td><td>Bad release introduces bug at 2AM</td><td>Blue/green deployment, canary releases, automatic rollback on error rate spike</td></tr>
                <tr><td><strong>Data corruption</strong></td><td>Bug writes bad data to database</td><td>Point-in-time restore (PITR), soft deletes, event sourcing for auditability</td></tr>
              </tbody>
            </table>
          </div>

          <h2>Availability Nines ‚Äî The Business Reality</h2>
          <div class="table-responsive mt-2">
            <table class="table table-bordered table-striped">
              <thead><tr><th>SLA</th><th>Downtime/Year</th><th>Downtime/Month</th><th>Typical Use Case</th></tr></thead>
              <tbody>
                <tr><td><strong>99% (two nines)</strong></td><td>~3.65 days</td><td>~7.2 hours</td><td>Internal tooling, batch jobs ‚Äî user-facing is rarely acceptable</td></tr>
                <tr><td><strong>99.9% (three nines)</strong></td><td>~8.7 hours</td><td>~43.8 minutes</td><td>Most SaaS products, B2B APIs with maintenance windows</td></tr>
                <tr><td><strong>99.95%</strong></td><td>~4.4 hours</td><td>~21.9 minutes</td><td>Azure App Service, AWS ECS ‚Äî typical managed service SLA</td></tr>
                <tr><td><strong>99.99% (four nines)</strong></td><td>~52.6 minutes</td><td>~4.4 minutes</td><td>Financial platforms, payment APIs ‚Äî requires multi-AZ Active-Active</td></tr>
                <tr><td><strong>99.999% (five nines)</strong></td><td>~5.3 minutes</td><td>~26 seconds</td><td>Telecom, emergency services, critical infrastructure ‚Äî requires multi-region</td></tr>
              </tbody>
            </table>
          </div>

          <div class="callout mt-4">üí° <strong>Composite SLA Warning:</strong> If Service A has 99.9% availability and Service B has 99.9% availability, a system that requires <em>both</em> to work has 99.9% √ó 99.9% = <strong>99.8%</strong> availability. Each dependency you add multiplies the risk downward ‚Äî design fallbacks and redundancy at every integration point.</div>
        </section>

        <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ CIRCUIT BREAKER & BULKHEAD ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
        <section id="circuit-bulkhead" role="article">
          <h1>‚ö° Circuit Breaker &amp; Bulkhead Patterns</h1>
          <span class="badge">circuit breaker</span> <span class="badge">bulkhead</span> <span class="badge">resilience</span>

          <h2>Introduction</h2>
          <p>In a microservices architecture, services call other services. When a downstream service becomes slow or unavailable, callers naturally wait for responses ‚Äî consuming threads and connections. Without protection, this slowness cascades upstream: the payment service slows down, so the order service slows down, so the API slows down, so the entire system becomes unresponsive. This is a <strong>cascade failure</strong>.</p>
          <p>Two complementary patterns contain cascade failures. <strong>Circuit Breaker</strong> stops making calls to a failing service (fail fast). <strong>Bulkhead</strong> limits how many resources any single dependency can consume, so others remain available even when one is degraded.</p>

          <div class="callout">
            <strong>‚ö†Ô∏è How a Cascade Failure Unfolds (Without These Patterns)</strong><br/>
            Recommendation service starts timing out at 3s ‚Üí Order service waits for 3s per request √ó 100 concurrent requests = 300 thread-seconds consumed ‚Üí Order service thread pool exhausted ‚Üí API layer waiting ‚Üí API layer thread pool exhausted ‚Üí All endpoints timeout for all users ‚Üí Full outage caused by one slow non-critical dependency.
          </div>

          <h2>Circuit Breaker ‚Äî Fail Fast, Recover Gracefully</h2>
          <div class="mermaid">
graph LR
    CLOSED["üü¢ CLOSED
    (Normal Operation)"]
    OPEN["üî¥ OPEN
    (Failing Fast)"]
    HALF["üü° HALF-OPEN
    (Testing Recovery)"]
    
    CLOSED -->|"Failure rate > threshold"| OPEN
    OPEN -->|"After sleep window"| HALF
    HALF -->|"Trial requests succeed"| CLOSED
    HALF -->|"Trial requests fail"| OPEN
    CLOSED -->|"Success rate normal"| CLOSED
    
    style CLOSED fill:#dcfce7,stroke:#10b981,stroke-width:3px
    style OPEN fill:#fee2e2,stroke:#ef4444,stroke-width:3px
    style HALF fill:#fef3c7,stroke:#f59e0b,stroke-width:3px
          </div>
          <div class="row g-3 mt-1">
            <div class="col-md-7"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100">
              <h6 class="fw-bold">‚ö° Circuit Breaker ‚Äî Three States</h6>
              <p class="mb-2"><small>Wraps every remote call. Monitors error rate and trips open when a threshold is exceeded, then probes periodically for recovery.</small></p>
              <div class="table-responsive"><table class="table table-sm table-bordered mb-0">
                <thead><tr><th>State</th><th>Behaviour</th><th>Transition</th></tr></thead>
                <tbody>
                  <tr><td><span class="badge bg-success">Closed</span></td><td>Normal operation. Requests pass through. Error rate counted.</td><td>Transitions to Open when error rate exceeds threshold (e.g. 50% in 60s)</td></tr>
                  <tr><td><span class="badge bg-danger">Open</span></td><td>Fail fast ‚Äî return error immediately without making the network call. No further load on the failing service.</td><td>After a sleep window (e.g. 30s), transitions to Half-Open</td></tr>
                  <tr><td><span class="badge bg-warning text-dark">Half-Open</span></td><td>Allow a limited number of trial requests through. Measure their success rate.</td><td>Success ‚Üí Closed. Failure ‚Üí back to Open with reset timer.</td></tr>
                </tbody>
              </table></div>
              <div class="mt-2"><span class="badge bg-info">Polly (.NET)</span> <span class="badge bg-success">Resilience4j (Java)</span> <span class="badge bg-warning text-dark">Hystrix</span> <span class="badge bg-secondary">Envoy Proxy</span></div>
            </div></div>
            <div class="col-md-5"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100">
              <h6 class="fw-bold">‚öôÔ∏è Key Configuration Parameters</h6>
              <ul class="mb-0 ps-3">
                <li><strong>Failure threshold:</strong> % of requests that must fail before opening (e.g. 50%)</li>
                <li><strong>Minimum request volume:</strong> Don't open circuit on 1 failure out of 2 requests ‚Äî require at least N calls in the window</li>
                <li><strong>Sleep window:</strong> Time the circuit stays Open before transitioning to Half-Open</li>
                <li><strong>Trial request count:</strong> Number of test requests to allow in Half-Open state</li>
                <li><strong>Fallback response:</strong> What to return when the circuit is Open ‚Äî cached data, default value, or explicit error</li>
              </ul>
            </div></div>
          </div>

          <h2>Bulkhead ‚Äî Containing Blast Radius</h2>
          <div class="row g-3 mt-1">
            <div class="col-md-6"><div class="card border-0 bg-gradient-purple p-3 rounded-3 h-100">
              <h6 class="fw-bold">üö¢ Bulkhead Pattern</h6>
              <p class="mb-2"><small>Named after ship bulkheads that contain flooding to a single compartment. Allocates separate, isolated resource pools per downstream dependency.</small></p>
              <ul class="mb-0 ps-3">
                <li><strong>Thread pool isolation:</strong> Payments service gets its own thread pool (max 20 threads). Orders service gets 20 threads. Users service gets 10 threads. Slow payments cannot starve orders.</li>
                <li><strong>Connection pool isolation:</strong> Each database or external API gets a separate HTTP connection pool with a max size limit</li>
                <li><strong>Queue isolation:</strong> Each category of work has its own bounded queue ‚Äî overflow fails fast instead of blocking everything</li>
                <li><strong>Semaphore isolation:</strong> Lighter-weight alternative to thread pools ‚Äî limit concurrent in-flight calls rather than dedicating threads</li>
              </ul>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-teal p-3 rounded-3 h-100">
              <h6 class="fw-bold">üîÄ Circuit Breaker + Bulkhead Together</h6>
              <p class="mb-2"><small>These patterns complement each other and should always be used together:</small></p>
              <ul class="mb-0 ps-3">
                <li><strong>Bulkhead</strong> ensures a failing dependency can only consume its pre-allocated resource pool ‚Äî it cannot starve other dependencies</li>
                <li><strong>Circuit Breaker</strong> monitors the bulkhead's request outcomes and, once error rate spikes, stops making calls entirely ‚Äî preserving even the bulkhead's resources</li>
                <li><strong>Together:</strong> Bulkhead limits the blast radius; Circuit Breaker stops the bleeding</li>
                <li><strong>Add Timeout:</strong> Every network call must have a timeout ‚Äî the combination of Timeout + Bulkhead + Circuit Breaker is the standard resilience trio</li>
              </ul>
              <div class="mt-2"><span class="badge bg-primary">Resilience trinity: Timeout + Bulkhead + Circuit Breaker</span></div>
            </div></div>
          </div>

          <div class="callout mt-4">üí° Use <strong>Circuit Breaker</strong> to stop calling a failing service and return a fallback immediately. Use <strong>Bulkhead</strong> to prevent one slow dependency from monopolising all threads/connections. Use both together on every outbound service call in production.</div>
        </section>

        <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ SERVERLESS & EVENT-DRIVEN ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
        <section id="serverless-eda" role="article">
          <h1>‚òÅÔ∏è Serverless Architecture &amp; Event-Driven Design</h1>
          <span class="badge">serverless</span> <span class="badge">event-driven</span> <span class="badge">functions</span>

          <h2>Introduction</h2>
          <p><strong>Serverless</strong> does not mean "no servers" ‚Äî it means someone else manages the servers. You provide a function; the cloud provider handles provisioning, scaling, OS patching, and billing. The result: elastic compute that scales from zero to thousands of concurrent invocations, charged per execution, with no idle cost and no operational overhead.</p>
          <p><strong>Event-Driven Architecture (EDA)</strong> is a design approach where components communicate through events rather than direct synchronous calls. Producers publish events without knowing who will consume them; consumers subscribe independently. This decoupling enables services to evolve, scale, and fail independently ‚Äî one of the most powerful patterns in distributed systems design.</p>

          <div class="callout">
            <strong>üí° Why Serverless + EDA is a Natural Combination</strong>
            <ul>
              <li>‚úÖ <strong>Perfect trigger model:</strong> Serverless functions are made to be triggered by events ‚Äî a message in a queue, a file uploaded, a record changed in a database, a HTTP request</li>
              <li>‚úÖ <strong>Zero idle cost:</strong> An event-driven function that is invoked 1,000 times/day costs almost nothing; a dedicated server running 24/7 for the same workload costs significantly more</li>
              <li>‚úÖ <strong>Elastic fan-out:</strong> One event can trigger many functions in parallel ‚Äî email + SMS + analytics + audit log all write concurrently without coordinating</li>
              <li>‚úÖ <strong>Natural decoupling:</strong> Neither the event producer nor the cloud runtime knows about each other ‚Äî add new event consumers without changing producers or infrastructure</li>
            </ul>
          </div>

          <h2>Serverless Functions</h2>
          <div class="row g-3 mt-1">
            <div class="col-md-6"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100">
              <h6 class="fw-bold">‚ö° Serverless ‚Äî Core Properties</h6>
              <ul class="mb-0 ps-3">
                <li><strong>Event-triggered execution:</strong> HTTP request, queue message, blob upload, schedule (cron), database change stream</li>
                <li><strong>Auto-scaling:</strong> Platform scales from 0 to N concurrent instances based on trigger volume ‚Äî no manual capacity planning</li>
                <li><strong>Pay-per-use:</strong> Billed per invocation + execution duration ‚Äî no charge when idle. Cost-efficient for spiky, unpredictable workloads</li>
                <li><strong>Stateless:</strong> Functions must not rely on in-memory state between invocations ‚Äî store state in databases, caches, or storage</li>
                <li><strong>Max execution time:</strong> Azure Functions = 5‚Äì60 min; AWS Lambda = 15 min; Cloud Run = 60 min ‚Äî not suitable for long-running processes</li>
              </ul>
              <div class="mt-2"><span class="badge bg-primary">Azure Functions</span> <span class="badge bg-warning text-dark">AWS Lambda</span> <span class="badge bg-success">Google Cloud Run</span></div>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-yellow p-3 rounded-3 h-100">
              <h6 class="fw-bold">‚ùÑÔ∏è Cold Start ‚Äî The Main Drawback</h6>
              <p class="mb-2"><small>A cold start occurs when a new function instance must be provisioned from scratch because no warm instances are available.</small></p>
              <ul class="mb-0 ps-3">
                <li><strong>Cause:</strong> First invocation after idle period, or traffic spike requiring new instances beyond the warm pool</li>
                <li><strong>Impact:</strong> 100ms‚Äì3s added latency on cold invocations ‚Äî unacceptable for synchronous user-facing APIs</li>
                <li><strong>Mitigation: Provisioned Concurrency / Always Hot:</strong> Pre-warm a set number of instances ‚Äî eliminates cold starts for that capacity, at a constant cost</li>
                <li><strong>Mitigation: Keep warm ping:</strong> Schedule a timer trigger every 5 minutes to keep instances warm ‚Äî free but hacky</li>
                <li><strong>Mitigation: Smaller runtime:</strong> Smaller deployment packages initialise faster ‚Äî use native AOT compilation (.NET) or GraalVM (Java)</li>
              </ul>
            </div></div>
          </div>

          <h2>Serverless vs Containers vs Traditional Servers</h2>
          <div class="table-responsive mt-2">
            <table class="table table-bordered table-striped">
              <thead><tr><th>Dimension</th><th>Serverless Functions</th><th>Containers (AKS, EKS)</th><th>Traditional VMs</th></tr></thead>
              <tbody>
                <tr><td><strong>Scaling</strong></td><td>Automatic, instant, to zero</td><td>Auto-scale but requires cluster capacity pre-provisioned</td><td>Manual or slow auto-scale</td></tr>
                <tr><td><strong>Cost model</strong></td><td>Pay per invocation + ms of execution</td><td>Pay for cluster nodes (running 24/7)</td><td>Pay for VMs (running 24/7)</td></tr>
                <tr><td><strong>Execution limit</strong></td><td>5‚Äì60 minutes maximum</td><td>Unlimited (long-running supported)</td><td>Unlimited</td></tr>
                <tr><td><strong>Cold start</strong></td><td>Yes ‚Äî 100ms‚Äì3s unless mitigated</td><td>Pod start ~10‚Äì30s (but pods stay warm)</td><td>VM boot = minutes</td></tr>
                <tr><td><strong>Operational overhead</strong></td><td>None ‚Äî fully managed</td><td>Moderate ‚Äî cluster management, upgrades</td><td>High ‚Äî OS patching, capacity planning</td></tr>
                <tr><td><strong>Best for</strong></td><td>Event handlers, webhooks, scheduled jobs, async processing</td><td>Long-running services, stateful applications, complex workloads</td><td>Legacy applications, BYOL licensing</td></tr>
              </tbody>
            </table>
          </div>

          <h2>Serverless Cost Optimization Strategies</h2>
          <div class="row g-3 mt-1">
            <div class="col-md-4"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100">
              <h6 class="fw-bold">üí∞ Right-Size Memory Allocation</h6>
              <ul class="mb-0 ps-3">
                <li><small><strong>Memory = CPU:</strong> In Lambda/Functions, CPU scales linearly with memory ‚Äî 1 GB = ~0.6 vCPU, 10 GB = ~6 vCPU</small></li>
                <li><small><strong>Underpowered = expensive:</strong> 128 MB running for 10s costs more than 1 GB running for 1s due to execution duration</small></li>
                <li><small><strong>Benchmark:</strong> Use Lambda Power Tuning or Azure Functions profiling to find optimal memory for your workload</small></li>
                <li><small><strong>Sweet spot:</strong> Often 1‚Äì2 GB for most I/O-bound functions ‚Äî minimizes execution time without over-provisioning</small></li>
              </ul>
            </div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100">
              <h6 class="fw-bold">‚è±Ô∏è Minimize Cold Start Impact</h6>
              <ul class="mb-0 ps-3">
                <li><small><strong>Provisioned concurrency:</strong> Pre-warm N instances (cost = 24/7 runtime) ‚Äî use only for latency-critical user-facing APIs</small></li>
                <li><small><strong>Scheduled warm pings:</strong> Every 5 min invoke a lightweight ping to keep warm ‚Äî free tier friendly for low-traffic functions</small></li>
                <li><small><strong>Smaller package size:</strong> Reduce deployment package ‚Äî exclude unnecessary dependencies, use Lambda layers for shared libs</small></li>
                <li><small><strong>Language choice:</strong> Node.js/Python start <100ms. .NET Native AOT <200ms. Java/JVM <1s. Choose wisely for sync paths.</small></li>
              </ul>
            </div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-yellow p-3 rounded-3 h-100">
              <h6 class="fw-bold">üìä Async & Batch Where Possible</h6>
              <ul class="mb-0 ps-3">
                <li><small><strong>Queue-based invocation:</strong> Async processing costs ~50% less than HTTP sync ‚Äî no waiting threads on client side</small></li>
                <li><small><strong>Batch processing:</strong> Process 10 messages per invocation instead of 1 ‚Äî SQS/Event Hubs batch triggers reduce total invocation count</small></li>
                <li><small><strong>Event filtering:</strong> Use EventBridge content filtering or queue dead-lettering to avoid invoking functions for irrelevant events</small></li>
                <li><small><strong>Schedule-based aggregation:</strong> Instead of per-record processing, aggregate records hourly then process batch ‚Äî fewer invocations</small></li>
              </ul>
            </div></div>
          </div>
          <div class="row g-3 mt-2">
            <div class="col-md-6"><div class="card border-0 bg-gradient-purple p-3 rounded-3 h-100">
              <h6 class="fw-bold">üéØ Reserved Capacity & Savings Plans</h6>
              <ul class="mb-0 ps-3">
                <li><small><strong>AWS Lambda Savings Plans:</strong> Commit to $X/month spend ‚Äî up to 17% discount for consistent workloads</small></li>
                <li><small><strong>Azure Functions Premium Plan:</strong> Always-warm instances + VNET integration ‚Äî better for steady moderate load than consumption plan</small></li>
                <li><small><strong>Compute Savings Plans:</strong> Cross-service savings (Lambda + Fargate + EC2) ‚Äî use when you have predictable baseline compute</small></li>
                <li><small><strong>Cost threshold:</strong> If monthly serverless bill >$500, analyze baseline vs spike usage ‚Äî hybrid provisioned + consumption may be cheaper</small></li>
              </ul>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-pink p-3 rounded-3 h-100">
              <h6 class="fw-bold">üîç Monitoring & Cost Attribution</h6>
              <ul class="mb-0 ps-3">
                <li><small><strong>Tag everything:</strong> Tag functions by team, application, environment ‚Äî enable cost allocation reports per business unit</small></li>
                <li><small><strong>CloudWatch / App Insights cost:</strong> Logs and metrics can exceed function execution costs ‚Äî set retention policies (7-30 days for non-prod)</small></li>
                <li><small><strong>Cost anomaly alerts:</strong> Set up AWS Cost Anomaly Detection or Azure Cost Alerts ‚Äî catch runaway functions early (infinite loops, retry storms)</small></li>
                <li><small><strong>Execution trends:</strong> Track invocations, duration, and memory over time ‚Äî optimize top 20% of functions that drive 80% of cost</small></li>
              </ul>
            </div></div>
          </div>

          <h2>Event-Driven Architecture (EDA)</h2>
          <div class="row g-3 mt-1">
            <div class="col-md-6"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100">
              <h6 class="fw-bold">üì° Event-Driven Architecture</h6>
              <ul class="mb-0 ps-3">
                <li><strong>Producers</strong> publish events describing what happened: <code>OrderPlaced</code>, <code>PaymentReceived</code>, <code>UserRegistered</code></li>
                <li><strong>Consumers</strong> subscribe to events they care about and react asynchronously ‚Äî totally independent of the producer</li>
                <li>‚úÖ Easy to add new consumers without modifying producers or existing consumers</li>
                <li>‚úÖ Natural audit trail ‚Äî every event is a fact that happened; replay creates full history</li>
                <li>‚úÖ Services scale and fail independently ‚Äî a slow analytics consumer doesn't slow down the order service</li>
                <li>‚ùå End-to-end flow is harder to reason about than synchronous calls</li>
                <li>‚ùå Debugging requires distributed tracing across event chains</li>
              </ul>
              <div class="mt-2"><span class="badge bg-primary">Azure Event Grid</span> <span class="badge bg-warning text-dark">AWS EventBridge</span> <span class="badge bg-danger">Kafka</span></div>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-purple p-3 rounded-3 h-100">
              <h6 class="fw-bold">üìã Event Schema Best Practices</h6>
              <p class="mb-2"><small>Event schemas evolve over time ‚Äî poor schema management silently breaks consumers.</small></p>
              <ul class="mb-0 ps-3">
                <li><strong>Include event version:</strong> <code>"eventVersion": "1.2"</code> in every event payload so consumers can handle multiple versions</li>
                <li><strong>Additive changes only:</strong> Adding new optional fields is safe (backwards compatible). Removing or renaming fields breaks existing consumers.</li>
                <li><strong>Schema Registry:</strong> Use a central schema registry (Confluent Schema Registry, Azure Schema Registry) to validate producers and consumers against a shared contract</li>
                <li><strong>Dead-letter queue:</strong> Consumers that fail to process an event (due to schema mismatch or business error) should route to a DLQ for investigation</li>
                <li><strong>CloudEvents spec:</strong> Adopt the CNCF CloudEvents standard for event envelopes across different event brokers</li>
              </ul>
            </div></div>
          </div>

          <div class="callout mt-4">üí° <strong>EDA + Serverless design principle:</strong> Events describe <em>facts that happened</em> (past tense: <code>OrderPlaced</code>, not <code>PlaceOrder</code>). Commands instruct an action. Keep events immutable facts. Design your event schema carefully ‚Äî a breaking event schema change is a silent production bug.</div>
        </section>

        <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ IaC ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
        <section id="iac" role="article">
          <h1>üèóÔ∏è Infrastructure as Code ‚Äî Why It Matters</h1>
          <span class="badge">iac</span> <span class="badge">terraform</span> <span class="badge">bicep</span> <span class="badge">automation</span>

          <h2>Introduction</h2>
          <p>Infrastructure as Code (IaC) is the practice of managing and provisioning infrastructure through <strong>machine-readable configuration files</strong> instead of manual processes or interactive configuration tools. Everything ‚Äî networks, virtual machines, databases, firewall rules, DNS entries, managed identities ‚Äî is defined as code, version-controlled in Git, and applied via automated pipelines.</p>
          <p>IaC is not a nice-to-have: it is the foundation of reliable, auditable, and reproducible cloud operations. Without it, environments drift, deployments are unpredictable, and disaster recovery is measured in days rather than minutes.</p>

          <div class="callout">
            <strong>‚ö†Ô∏è The Cost of Manual Infrastructure (Snowflake Servers)</strong>
            <ul>
              <li>‚úÖ <strong>Configuration drift:</strong> Manually configured servers diverge over time ‚Äî production has a different set of packages, ports, and settings than staging ‚Äî bugs only appear in production</li>
              <li>‚úÖ <strong>No audit trail:</strong> "Who opened port 3306 to 0.0.0.0/0?" ‚Äî with manual infra, no one knows and it's not documented anywhere</li>
              <li>‚úÖ <strong>Slow disaster recovery:</strong> Recreating a manually-built environment after a disaster can take days ‚Äî with IaC, minutes</li>
              <li>‚úÖ <strong>One-person bus factor:</strong> Manual infra is typically understood by one person ‚Äî when they leave, the institutional knowledge leaves with them</li>
            </ul>
          </div>

          <h2>Declarative vs Imperative</h2>
          <div class="row g-3 mt-1">
            <div class="col-md-6"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100">
              <h6 class="fw-bold">üìã Declarative IaC</h6>
              <p class="mb-2"><small>You describe the <strong>desired end state</strong>. The tool computes the delta between current and desired state, then applies only the changes needed.</small></p>
              <ul class="mb-0 ps-3">
                <li>Idempotent ‚Äî running the same configuration twice produces the same result</li>
                <li>Safe to apply on existing infrastructure ‚Äî won't recreate resources that are already correct</li>
                <li>Self-documenting ‚Äî the files represent the current state of the environment</li>
                <li><strong>Tools:</strong> Terraform, Bicep, ARM Templates, Pulumi, AWS CDK (declarative mode)</li>
              </ul>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100">
              <h6 class="fw-bold">üîß Imperative IaC</h6>
              <p class="mb-2"><small>You describe <strong>the steps</strong> to execute. The tool runs each step in sequence regardless of the current state.</small></p>
              <ul class="mb-0 ps-3">
                <li>Flexible ‚Äî can handle complex conditional logic and loops</li>
                <li>Not idempotent by default ‚Äî running twice can create duplicate resources</li>
                <li>Good for configuration management and post-provisioning setup</li>
                <li><strong>Tools:</strong> Azure CLI scripts, Bash, PowerShell, Ansible tasks, Chef recipes</li>
              </ul>
            </div></div>
          </div>

          <h2>IaC Tool Comparison</h2>
          <div class="table-responsive mt-2">
            <table class="table table-bordered table-striped">
              <thead><tr><th>Tool</th><th>Language</th><th>Cloud Scope</th><th>State Management</th><th>Best For</th></tr></thead>
              <tbody>
                <tr><td><strong>Terraform</strong></td><td>HCL</td><td>Multi-cloud</td><td>State file (local or remote backend)</td><td>Multi-cloud or cloud-agnostic teams</td></tr>
                <tr><td><strong>Bicep</strong></td><td>Bicep DSL</td><td>Azure only</td><td>ARM layer ‚Äî no state file needed</td><td>Azure-first teams; cleaner syntax than ARM JSON</td></tr>
                <tr><td><strong>Pulumi</strong></td><td>TypeScript / Python / Go / .NET</td><td>Multi-cloud</td><td>Pulumi Cloud or self-hosted backend</td><td>Teams wanting IaC in a full programming language</td></tr>
                <tr><td><strong>AWS CDK</strong></td><td>TypeScript / Python / Java</td><td>AWS only</td><td>CloudFormation stacks</td><td>AWS-native teams comfortable with code constructs</td></tr>
                <tr><td><strong>Ansible</strong></td><td>YAML (declarative tasks)</td><td>Multi-cloud + on-prem</td><td>Stateless ‚Äî idempotent modules</td><td>Configuration management, OS-level setup, post-provisioning</td></tr>
              </tbody>
            </table>
          </div>

          <h2>GitOps ‚Äî IaC Meets DevOps</h2>
          <div class="row g-3 mt-1">
            <div class="col-md-4"><div class="card border-0 bg-gradient-purple p-3 rounded-3 h-100"><strong>üìÅ Git as Source of Truth</strong><p class="mt-1 mb-0"><small>All infrastructure configuration lives in a Git repository. The desired state of every environment is defined by the contents of a specific branch or tag.</small></p></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-teal p-3 rounded-3 h-100"><strong>üîÑ Pull Request Workflow</strong><p class="mt-1 mb-0"><small>Every infrastructure change is a pull request. Peers review the change. A <code>terraform plan</code> / <code>bicep what-if</code> output is posted as a PR comment showing exactly what will change before merge.</small></p></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-pink p-3 rounded-3 h-100"><strong>ü§ñ Automated Apply on Merge</strong><p class="mt-1 mb-0"><small>Merging to <code>main</code> triggers a CI/CD pipeline that applies the infrastructure changes automatically. Manual deployment is eliminated ‚Äî all changes flow through the controlled pipeline.</small></p></div></div>
          </div>

          <h2>State Management &amp; Drift Detection</h2>
          <div class="row g-3 mt-2">
            <div class="col-md-6"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100">
              <h6 class="fw-bold">üíæ Terraform State Best Practices</h6>
              <ul class="mb-0 ps-3">
                <li><small><strong>Remote state backend:</strong> Store state in Azure Blob Storage / S3 / Terraform Cloud ‚Äî never commit <code>terraform.tfstate</code> to Git</small></li>
                <li><small><strong>State locking:</strong> Enable locking (via DynamoDB on AWS, Azure Blob lease) to prevent concurrent modifications corrupting state</small></li>
                <li><small><strong>State encryption:</strong> Encrypt state at rest ‚Äî it contains sensitive values (connection strings, secrets references)</small></li>
                <li><small><strong>Separate state per environment:</strong> Dev, staging, prod each have independent state files ‚Äî blast radius containment</small></li>
                <li><small><strong>Workspace isolation:</strong> Use Terraform workspaces or separate backend configs to fully isolate environment state</small></li>
              </ul>
              <pre class="bg-dark text-light p-2 rounded mt-2" style="font-size:0.7rem;">terraform {
  backend "azurerm" {
    resource_group  = "tfstate-rg"
    storage_account = "tfstate12345"
    container_name  = "tfstate"
    key             = "prod.terraform.tfstate"
  }
}</pre>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100">
              <h6 class="fw-bold">üîç Configuration Drift Detection</h6>
              <p class="mb-2"><small>Drift occurs when infrastructure is modified outside of IaC (manual portal changes, CLI scripts). Undetected drift causes <code>terraform apply</code> to fail or produce unexpected changes.</small></p>
              <ul class="mb-2 ps-3">
                <li><small><strong>Scheduled drift checks:</strong> Run <code>terraform plan</code> nightly in CI ‚Äî any diff indicates manual drift</small></li>
                <li><small><strong>Alert on drift:</strong> If plan shows changes despite no commits, alert on-call team immediately</small></li>
                <li><small><strong>Policy enforcement:</strong> Azure Policy / AWS Service Control Policies prevent manual changes to critical resources</small></li>
                <li><small><strong>Drift resolution:</strong> Option 1 ‚Äî revert manual change via IaC. Option 2 ‚Äî import manual change into state (<code>terraform import</code>)</small></li>
              </ul>
              <pre class="bg-dark text-light p-2 rounded" style="font-size:0.7rem;"># Nightly drift detection pipeline
terraform plan -detailed-exitcode
# Exit code 2 = changes detected = drift!</pre>
            </div></div>
          </div>

          <div class="callout mt-4">üí° <strong>Best practice:</strong> Declarative IaC (Terraform / Bicep) for provisioning infrastructure; Ansible for configuration management. Store IaC in the same repository as the application code it supports. Use remote state backends (Azure Blob / Terraform Cloud) ‚Äî never commit state files to Git.</div>
        </section>

        <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ZERO TRUST ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
        <section id="zero-trust" role="article">
          <h1>üîí Zero-Trust Architecture Basics</h1>
          <span class="badge">zero trust</span> <span class="badge">security</span> <span class="badge">identity</span>

          <h2>Introduction</h2>
          <p>Zero-Trust is a security model built on one principle: <strong>"Never trust, always verify."</strong> It is the explicit rejection of the perimeter security model ("castle and moat") where everything inside the corporate network is trusted. In a zero-trust model, <em>every request is treated as potentially hostile</em> ‚Äî regardless of whether it comes from inside the network, from a trusted device, or from a known user account.</p>
          <p>The perimeter model collapsed because modern workloads have no perimeter: SaaS applications, remote workers, cloud services, third-party APIs, and compromised insider accounts all render the "trusted network" concept obsolete. Zero-Trust replaces network location as the basis for trust with <strong>identity, device health, and continuous authorisation</strong>.</p>

          <div class="callout">
            <strong>‚ö†Ô∏è Why the Perimeter Model Failed</strong>
            <ul>
              <li>‚úÖ <strong>Insider threats:</strong> 58% of data breaches involve insider actors ‚Äî the perimeter model grants full trust once inside, providing no lateral movement protection</li>
              <li>‚úÖ <strong>Phished credentials:</strong> Stolen credentials give attackers legitimate access that bypasses all perimeter controls</li>
              <li>‚úÖ <strong>Cloud eliminates the perimeter:</strong> SaaS tools, cloud services, and remote work mean there is no single network perimeter to defend</li>
              <li>‚úÖ <strong>Supply chain attacks:</strong> Compromised software dependencies or third-party integrations bypass perimeter controls entirely (e.g. SolarWinds 2020)</li>
            </ul>
          </div>

          <h2>The Three Zero-Trust Principles</h2>
          <div class="row g-3 mt-1">
            <div class="col-md-4"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100">
              <h6 class="fw-bold">ü™™ Verify Explicitly</h6>
              <p class="mb-2"><small>Authenticate and authorise every request using all available data points ‚Äî identity, location, device health, service/workload, data classification.</small></p>
              <ul class="mb-0 ps-3">
                <li>Strong MFA ‚Äî phishing-resistant (FIDO2, passkeys) where possible</li>
                <li>Short-lived access tokens (JWTs with 15-min expiry) rather than long-lived API keys</li>
                <li>Continuous access evaluation ‚Äî revoke sessions mid-flight on detected risk</li>
                <li>Conditional Access policies ‚Äî location, device compliance, risk score all factor in</li>
              </ul>
            </div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100">
              <h6 class="fw-bold">üîê Least Privilege Access</h6>
              <p class="mb-2"><small>Grant only the minimum permissions required for the specific task ‚Äî and only for the duration needed.</small></p>
              <ul class="mb-0 ps-3">
                <li><strong>RBAC:</strong> Role-based access control ‚Äî assign roles, not individual permissions</li>
                <li><strong>ABAC:</strong> Attribute-based access control ‚Äî dynamic policies based on user attributes, data sensitivity, time of day</li>
                <li><strong>Just-in-Time (JIT) access:</strong> Elevate to privileged roles for specific time windows ‚Äî no permanent admin accounts</li>
                <li><strong>Managed Identities:</strong> Services authenticate with a managed identity ‚Äî no service account passwords to rotate or leak</li>
              </ul>
            </div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-yellow p-3 rounded-3 h-100">
              <h6 class="fw-bold">üìä Assume Breach</h6>
              <p class="mb-2"><small>Design the system assuming an attacker is already inside. Minimise blast radius, segment everything, detect and respond fast.</small></p>
              <ul class="mb-0 ps-3">
                <li><strong>Network micro-segmentation:</strong> Services cannot communicate freely within a VNet ‚Äî explicit allow rules between each service pair</li>
                <li><strong>mTLS (mutual TLS):</strong> Every service-to-service call is mutually authenticated with certificates ‚Äî not just encrypted, but bidirectionally verified</li>
                <li><strong>Log everything:</strong> Every access decision, every API call, every privilege escalation logged for SIEM analysis</li>
                <li><strong>Detect &amp; respond:</strong> Anomaly detection ‚Äî flag unusual access patterns (new geography, time of day, volume spike)</li>
              </ul>
            </div></div>
          </div>

          <h2>Zero-Trust Architecture: Request Verification Flow</h2>
          <div class="mermaid">
graph TD
    User["üë§ User<br/>Remote Device"] -->|"1. Request Access"| ZT["üõ°Ô∏è Zero-Trust<br/>Policy Decision Point"]
    
    ZT -->|"2. Verify"| ID["ü™™ Identity<br/>(Azure Entra / Okta)<br/>‚Ä¢ MFA Required<br/>‚Ä¢ JWT Token<br/>‚Ä¢ User Attributes"]
    ZT -->|"2. Verify"| DEV["üíª Device Health<br/>(Intune / Endpoint Manager)<br/>‚Ä¢ Compliant OS<br/>‚Ä¢ Disk Encrypted<br/>‚Ä¢ EDR Running"]
    ZT -->|"2. Verify"| LOC["üåç Context<br/>(Conditional Access)<br/>‚Ä¢ Location / IP<br/>‚Ä¢ Time of Day<br/>‚Ä¢ Risk Score"]
    
    ID --> DECIDE{All Checks<br/>Pass?}
    DEV --> DECIDE
    LOC --> DECIDE
    
    DECIDE -->|"‚ùå Deny"| DENY["üö´ Access Denied<br/>Log Event<br/>Alert SOC"]
    DECIDE -->|"‚úÖ Allow"| ALLOW["‚úÖ Grant Access"]
    
    ALLOW -->|"3. Least Privilege"| RBAC["üîê Authorisation<br/>(RBAC / ABAC)<br/>Minimum Permissions<br/>Time-Limited"]
    
    RBAC -->|"4. Access Resource"| MSEG["üîí Micro-Segmented Network<br/>mTLS Service Mesh"]
    
    MSEG --> RES["üóÑÔ∏è Protected Resource<br/>(Data / Service / App)"]
    
    RES -.->|"5. Log Everything"| SIEM["üìä SIEM<br/>(Azure Sentinel /<br/>Splunk / Chronicle)<br/>Anomaly Detection"]
    
    SIEM -.->|"6. Detect Anomaly"| ALERT["üö® Alert & Revoke<br/>Continuous Evaluation"]
    
    style User fill:#dbeafe,stroke:#3b82f6,stroke-width:2px
    style ZT fill:#fef3c7,stroke:#f59e0b,stroke-width:3px
    style ID fill:#dcfce7,stroke:#10b981,stroke-width:2px
    style DEV fill:#dcfce7,stroke:#10b981,stroke-width:2px
    style LOC fill:#dcfce7,stroke:#10b981,stroke-width:2px
    style DECIDE fill:#fed7aa,stroke:#ea580c,stroke-width:2px
    style DENY fill:#fee2e2,stroke:#dc2626,stroke-width:3px
    style ALLOW fill:#dcfce7,stroke:#10b981,stroke-width:3px
    style RBAC fill:#e9d5ff,stroke:#a855f7,stroke-width:2px
    style MSEG fill:#fce7f3,stroke:#ec4899,stroke-width:2px
    style RES fill:#dbeafe,stroke:#3b82f6,stroke-width:2px
    style SIEM fill:#fed7aa,stroke:#ea580c
    style ALERT fill:#fee2e2,stroke:#dc2626,stroke-width:2px
          </div>

          <h2>The Six Zero-Trust Pillars (NIST SP 800-207)</h2>
          <div class="row g-3 mt-1">
            <div class="col-md-4"><div class="card border-0 bg-gradient-purple p-3 rounded-3 h-100"><strong>ü™™ Identities</strong><p class="mt-1 mb-0"><small>Users, services, and devices have verifiable digital identities. All access decisions start with identity verification. Azure: Entra ID + Conditional Access. AWS: IAM Identity Center.</small></p></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-teal p-3 rounded-3 h-100"><strong>üíª Devices</strong><p class="mt-1 mb-0"><small>Only compliant, managed devices can access sensitive resources. Device health (OS version, EDR status, disk encryption) is a factor in access decisions. Azure: Intune + Defender for Endpoint.</small></p></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-pink p-3 rounded-3 h-100"><strong>üì± Applications</strong><p class="mt-1 mb-0"><small>Apps are accessed via authorised paths only ‚Äî no direct internet exposure. Shadow IT discovered and governed. App-level access policies enforced via MCAS / Defender for Cloud Apps.</small></p></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100"><strong>üóÉÔ∏è Data</strong><p class="mt-1 mb-0"><small>Data classified by sensitivity (Public / Internal / Confidential / Highly Confidential). Access controls applied based on classification. Data encrypted at rest and in transit. Azure: Purview + Information Protection.</small></p></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100"><strong>üèóÔ∏è Infrastructure</strong><p class="mt-1 mb-0"><small>Cloud resources, VMs, containers, and APIs secured with least-privilege managed identities. IaC policies enforced via Azure Policy / AWS Service Control Policies. Vulnerability scanning automated.</small></p></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-yellow p-3 rounded-3 h-100"><strong>üåê Networks</strong><p class="mt-1 mb-0"><small>Micro-segmentation replaces flat networks. Private endpoints for PaaS services. mTLS between services. Network security groups (NSGs) / firewalls enforce least-privilege east-west traffic within the environment.</small></p></div></div>
          </div>

          <div class="callout mt-4">üí° <strong>Microsoft Reference Implementation:</strong> Azure Entra ID (identity) + Intune (device compliance) + Conditional Access (policy enforcement) + Defender for Cloud (threat detection) + Purview (data governance) + Azure Private Link (network isolation). This is the production-grade Zero-Trust stack for Azure workloads.</div>
        </section>

        <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ MULTI-REGION ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
        <section id="multi-region" role="article">
          <h1>üåç Multi-Region Active-Active vs Active-Passive</h1>
          <span class="badge">multi-region</span> <span class="badge">active-active</span> <span class="badge">active-passive</span>

          <h2>Introduction</h2>
          <p>Running a system across multiple geographic regions provides two distinct benefits: <strong>resilience against regional outages</strong> (an entire cloud region going down) and <strong>reduced latency for globally distributed users</strong> (routing users to the nearest region). Both concerns drive multi-region design, but they impose different requirements on the architecture.</p>
          <p>The key decision is which pattern to use: <strong>Active-Active</strong> (all regions serve live traffic simultaneously) or <strong>Active-Passive</strong> (one primary region handles all traffic, one or more standby regions activate only on failure). Neither is universally superior ‚Äî the right choice depends on your RTO, RPO, data consistency requirements, and budget.</p>

          <div class="callout">
            <strong>üí° Regional outages are not hypothetical</strong><br/>
            AWS us-east-1 has experienced multiple significant outages. Azure has had regional incidents. GCP has had zonal and regional events. Every major cloud provider has published post-mortems for regional-level disruptions. For systems where downtime has a material business cost, multi-region is not a luxury ‚Äî it is a risk management necessity.
          </div>

          <div class="mermaid">
graph TB
    subgraph ActiveActive["Active-Active Multi-Region"]
        UA["üë§ User A<br/>(Europe)"] -->|"Routed via DNS"| R1["üåê Region EU-West"]
        UB["üë§ User B<br/>(Asia)"] -->|"Routed via DNS"| R2["üåê Region Asia-Pacific"]
        UC["üë§ User C<br/>(US)"] -->|"Routed via DNS"| R3["üåê Region US-East"]
        
        R1 -.->|"Async replication"| R2
        R2 -.->|"Async replication"| R3
        R3 -.->|"Async replication"| R1
        
        R1 -->|"Writes"| DB1["üíæ DB Primary-EU"]
        R2 -->|"Writes"| DB2["üíæ DB Primary-AP"]
        R3 -->|"Writes"| DB3["üíæ DB Primary-US"]
    end
    
    subgraph ActivePassive["Active-Passive Multi-Region"]
        UP["üë§ All Users"] -->|"DNS points to primary"| RP["üü¢ Primary Region"]
        RP -->|"Writes + Reads"| DBP["üíæ Primary DB"]
        
        RS["üü° Standby Region<br/>(Idle/Warm)"]
        DBS["üíæ Read Replica"]
        
        DBP -.->|"Async replication"| DBS
        RP -.->|"On failure: DNS failover"| RS
        RS -->|"On failover: promoted"| DBS
    end
    
    style R1 fill:#dcfce7,stroke:#10b981,stroke-width:2px
    style R2 fill:#dcfce7,stroke:#10b981,stroke-width:2px
    style R3 fill:#dcfce7,stroke:#10b981,stroke-width:2px
    style RP fill:#dcfce7,stroke:#10b981,stroke-width:2px
    style RS fill:#fef3c7,stroke:#f59e0b,stroke-width:2px
    style DB1 fill:#e9d5ff,stroke:#a855f7
    style DB2 fill:#e9d5ff,stroke:#a855f7
    style DB3 fill:#e9d5ff,stroke:#a855f7
    style DBP fill:#e9d5ff,stroke:#a855f7
    style DBS fill:#fce7f3,stroke:#ec4899
    style UA fill:#dbeafe,stroke:#3b82f6
    style UB fill:#dbeafe,stroke:#3b82f6
    style UC fill:#dbeafe,stroke:#3b82f6
    style UP fill:#dbeafe,stroke:#3b82f6
          </div>

          <h2>Active-Active vs Active-Passive: The Core Trade-offs</h2>
          <div class="row g-3 mt-1">
            <div class="col-md-6"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100">
              <h6 class="fw-bold">üü¢ Active-Active</h6>
              <p class="mb-2"><small>All regions serve live traffic simultaneously. DNS geo-routing directs users to the nearest region. All regions can accept writes.</small></p>
              <ul class="mb-0 ps-3">
                <li>‚úÖ <strong>Zero RTO:</strong> When a region fails, DNS failover re-routes traffic to remaining regions instantly ‚Äî users experience no downtime (beyond DNS TTL propagation)</li>
                <li>‚úÖ <strong>Lowest latency:</strong> Users in Europe hit the European region; users in Asia hit the Asian region ‚Äî no cross-continental round trips</li>
                <li>‚úÖ <strong>Maximum infrastructure utilisation:</strong> No warm standby sitting idle ‚Äî all regions share the load</li>
                <li>‚ùå <strong>Write conflict complexity:</strong> Multi-master writes create concurrency issues ‚Äî requires conflict detection, resolution strategies, or eventual consistency models</li>
                <li>‚ùå <strong>Cross-region data synchronisation:</strong> Writes in Region A must replicate to Region B before Region B can serve consistent reads ‚Äî replication lag is the key challenge</li>
                <li>‚ùå <strong>Higher operational complexity and cost:</strong> Full infrastructure in all regions running all the time</li>
              </ul>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100">
              <h6 class="fw-bold">üü° Active-Passive</h6>
              <p class="mb-2"><small>Primary region handles all traffic and all writes. Secondary region is a warm (or cold) standby that activates on failure via manual or automated failover.</small></p>
              <ul class="mb-0 ps-3">
                <li>‚úÖ <strong>Simpler data model:</strong> Single writer ‚Äî no write conflicts, no conflict resolution logic. Standard primary/replica replication.</li>
                <li>‚úÖ <strong>Lower cost (warm standby):</strong> Secondary can run at reduced capacity ‚Äî scale up on failover activation</li>
                <li>‚úÖ <strong>Easier to reason about consistency:</strong> Reads from secondary may lag by seconds, but no write conflict scenarios</li>
                <li>‚ùå <strong>Non-zero RTO:</strong> Failover takes minutes (warm standby) to hours (cold standby) ‚Äî during which users experience degraded service or outage</li>
                <li>‚ùå <strong>Data loss on failover (RPO &gt; 0):</strong> Any writes that reached the primary but hadn't yet replicated to secondary are lost</li>
                <li>‚ùå <strong>Standby capacity waste:</strong> Secondary sits underutilised (unless used for read replicas or DR testing)</li>
              </ul>
            </div></div>
          </div>

          <h2>RTO &amp; RPO Comparison</h2>
          <div class="table-responsive mt-2">
            <table class="table table-bordered table-striped">
              <thead><tr><th>Metric</th><th>Definition</th><th>Active-Active</th><th>Active-Passive (Warm)</th><th>Active-Passive (Cold)</th></tr></thead>
              <tbody>
                <tr><td><strong>RTO</strong></td><td>Recovery Time Objective ‚Äî max acceptable service downtime</td><td>~0 (DNS TTL only)</td><td>1‚Äì10 minutes</td><td>30 min ‚Äì hours</td></tr>
                <tr><td><strong>RPO</strong></td><td>Recovery Point Objective ‚Äî max acceptable data loss</td><td>~0 (sync replication) or seconds (async)</td><td>Seconds to minutes (replication lag)</td><td>Hours (last backup)</td></tr>
              </tbody>
            </table>
          </div>

          <h2>Data Replication Strategies</h2>
          <div class="row g-3 mt-1">
            <div class="col-md-4"><div class="card border-0 bg-gradient-purple p-3 rounded-3 h-100"><strong>üîÑ Synchronous Replication</strong><p class="mt-1 mb-0"><small>Write does not commit until all replicas acknowledge. <strong>RPO = 0</strong>. Adds latency equal to the round-trip time to the furthest replica. Impractical for cross-continental deployments. Best for cross-AZ within a region.</small></p></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-teal p-3 rounded-3 h-100"><strong>‚è±Ô∏è Asynchronous Replication</strong><p class="mt-1 mb-0"><small>Write commits on primary immediately; replica receives the change with a small lag (typically &lt;1 second). <strong>Small RPO risk</strong> (seconds of replication lag). No write latency overhead. Standard for cross-region replication.</small></p></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-pink p-3 rounded-3 h-100"><strong>üìÜ Periodic Backup / Restore</strong><p class="mt-1 mb-0"><small>Snapshots taken every hour or day. Lowest cost. <strong>High RPO</strong> (hours of potential data loss). Acceptable only for non-critical workloads or as a last-resort DR option when RTO/RPO requirements are not strict.</small></p></div></div>
          </div>

          <h2>When to Use Each Pattern</h2>
          <div class="table-responsive mt-2">
            <table class="table table-bordered table-striped">
              <thead><tr><th>Scenario</th><th>Recommended Pattern</th><th>Reason</th></tr></thead>
              <tbody>
                <tr><td>Global consumer app with users on multiple continents</td><td>Active-Active</td><td>Latency reduction for all regions; zero-downtime regional failover</td></tr>
                <tr><td>Financial platform with strict RPO = 0 and RTO &lt; 1 min</td><td>Active-Active with sync replication</td><td>Cannot tolerate data loss or visible downtime</td></tr>
                <tr><td>B2B SaaS with single geographic region of users, RTO &lt; 10 min</td><td>Active-Passive (warm standby)</td><td>Cost-effective; users in one region; acceptable failover window</td></tr>
                <tr><td>Internal tooling, batch processing, non-critical workload</td><td>Active-Passive (cold standby or backup)</td><td>Lower budget; downtime measured in hours is acceptable</td></tr>
                <tr><td>Read-heavy workload with global users</td><td>Active-Active reads + Active-Passive writes</td><td>Serve reads from nearest region; all writes to single primary to avoid conflicts</td></tr>
              </tbody>
            </table>
          </div>

          <div class="callout mt-4">üí° <strong>Most enterprise systems use Active-Passive with warm standby</strong> as a cost-effective balance between resilience and complexity. Active-Active is justified only when your RTO/RPO SLAs are near-zero and your data model supports conflict resolution (e.g. Cosmos DB multi-region writes with last-write-wins or custom merge functions).</div>
        </section>

        <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ CONSENSUS ALGORITHMS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
        <section id="consensus-algorithms" role="article">
          <h1>ü§ù Consensus Algorithms ‚Äî Paxos & Raft</h1>
          <span class="badge">consensus</span> <span class="badge">raft</span> <span class="badge">paxos</span> <span class="badge">distributed systems</span>

          <h2>Introduction</h2>
          <p><strong>Consensus</strong> is the fundamental problem in distributed systems: how do independent nodes agree on a single value (or sequence of values) even when some nodes crash or messages are lost? Solving consensus enables distributed databases to remain consistent, distributed locks to be safe, and leader election to be automatic.</p>
          <p>Two algorithms dominate modern production systems: <strong>Paxos</strong> (theoretical foundation, notoriously complex) and <strong>Raft</strong> (designed for understandability, widely adopted). Both guarantee that once consensus is reached, all nodes agree on the same value permanently ‚Äî even if some nodes were unavailable during the decision.</p>

          <div class="callout">
            <strong>üí° Why Consensus Matters</strong><br/>
            Without consensus, distributed systems cannot provide strong consistency. Examples:<br/>
            ‚Ä¢ <strong>Leader election:</strong> etcd, Zookeeper, Consul use Raft to elect a leader when the old leader fails<br/>
            ‚Ä¢ <strong>Configuration management:</strong> Kubernetes API server stores cluster state in etcd (Raft-based)<br/>
            ‚Ä¢ <strong>Distributed locks:</strong> Lock acquisition requires consensus ‚Äî prevents two clients from believing they both hold the lock<br/>
            ‚Ä¢ <strong>Database replication:</strong> CockroachDB, TiDB, FoundationDB use Raft to replicate writes with strong consistency
          </div>

          <h2>The Consensus Problem</h2>
          <div class="row g-3 mt-1">
            <div class="col-md-4"><div class="card border-0 bg-gradient-yellow p-3 rounded-3 h-100 text-center"><strong>Agreement</strong><p class="mt-1 mb-0"><small>All non-faulty nodes must decide on the same value.</small></p></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100 text-center"><strong>Validity</strong><p class="mt-1 mb-0"><small>If all nodes propose value V, then V must be the decided value (no fabrication).</small></p></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100 text-center"><strong>Termination</strong><p class="mt-1 mb-0"><small>All non-faulty nodes eventually decide (no infinite waiting).</small></p></div></div>
          </div>

          <h2>Raft ‚Äî Consensus for the Rest of Us</h2>
          <p class="mt-3">Raft divides consensus into three subproblems: <strong>Leader Election</strong>, <strong>Log Replication</strong>, and <strong>Safety</strong>. At any time, each node is in one of three states: Leader, Follower, or Candidate.</p>
          
          <div class="mermaid-container mt-3">
            <pre class="mermaid">
stateDiagram-v2
    [*] --> Follower: Start
    
    Follower --> Candidate: Timeout (no heartbeat from leader)
    Candidate --> Leader: Receives majority of votes
    Candidate --> Follower: Discovers current leader or higher term
    Leader --> Follower: Discovers higher term
    
    Follower --> Follower: Receives heartbeat from leader
    Leader --> Leader: Send heartbeats to followers
    Candidate --> Candidate: Split vote, retry with new term
    
    note right of Follower
        ‚Ä¢ Passive state
        ‚Ä¢ Responds to RPCs
        ‚Ä¢ Resets timeout on heartbeat
    end note
    
    note right of Candidate
        ‚Ä¢ Starts election
        ‚Ä¢ Increments term
        ‚Ä¢ Votes for self
        ‚Ä¢ Requests votes from peers
    end note
    
    note right of Leader
        ‚Ä¢ Handles all client requests
        ‚Ä¢ Replicates log entries
        ‚Ä¢ Sends periodic heartbeats
    end note
            </pre>
          </div>

          <h2>Raft Algorithm Phases</h2>
          <div class="row g-3 mt-2">
            <div class="col-md-4"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100">
              <h6 class="fw-bold">1Ô∏è‚É£ Leader Election</h6>
              <p class="mb-2"><small><strong>Problem:</strong> If the leader fails, how do followers agree on a new leader?</small></p>
              <ul class="mb-0 ps-3">
                <li><strong>Heartbeat timeout:</strong> Followers expect periodic heartbeat from leader. If timeout expires, follower becomes Candidate.</li>
                <li><strong>Request votes:</strong> Candidate increments term number, votes for itself, sends RequestVote RPC to all peers.</li>
                <li><strong>Majority wins:</strong> Candidate receiving votes from majority of nodes (including itself) becomes new Leader.</li>
                <li><strong>Split vote handling:</strong> If no majority (split vote), candidates retry with new term and randomised timeout to break ties.</li>
              </ul>
            </div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100">
              <h6 class="fw-bold">2Ô∏è‚É£ Log Replication</h6>
              <p class="mb-2"><small><strong>Problem:</strong> How does the leader ensure all followers have the same log entries?</small></p>
              <ul class="mb-0 ps-3">
                <li><strong>Client request:</strong> Leader receives write request, appends to its own log (uncommitted).</li>
                <li><strong>Replicate:</strong> Leader sends AppendEntries RPC to all followers containing new log entry.</li>
                <li><strong>Majority acknowledgment:</strong> Once majority of followers acknowledge, leader commits the entry ‚Äî permanently agreed.</li>
                <li><strong>Apply to state machine:</strong> Leader applies the entry to its state machine, returns success to client, notifies followers to commit.</li>
              </ul>
            </div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-yellow p-3 rounded-3 h-100">
              <h6 class="fw-bold">3Ô∏è‚É£ Safety</h6>
              <p class="mb-2"><small><strong>Problem:</strong> How to prevent divergent logs if a node crashes and rejoins?</small></p>
              <ul class="mb-0 ps-3">
                <li><strong>Leader Completeness:</strong> A leader must have all committed entries from previous terms. Candidates with incomplete logs cannot win elections.</li>
                <li><strong>Log Matching:</strong> Logs must be identical up to a specific index. Leader forces followers to reconcile conflicting entries by overwriting with leader's log.</li>
                <li><strong>Commit restriction:</strong> Entry only committed if stored on majority ‚Äî guarantees it will survive into future terms.</li>
              </ul>
            </div></div>
          </div>

          <h2>Raft vs Paxos</h2>
          <div class="table-responsive mt-3">
            <table class="table table-bordered table-striped">
              <thead><tr><th>Dimension</th><th>Raft</th><th>Paxos</th></tr></thead>
              <tbody>
                <tr><td><strong>Design goal</strong></td><td>Understandability ‚Äî designed to be teachable and implementable</td><td>Theoretical correctness ‚Äî minimal proof of consensus</td></tr>
                <tr><td><strong>Leader</strong></td><td>Strong leader model ‚Äî all writes go through one leader at a time</td><td>Leaderless originally; Multi-Paxos added leader concept</td></tr>
                <tr><td><strong>Log structure</strong></td><td>Contiguous log with sequential indexes ‚Äî simple to reason about</td><td>Allows gaps and out-of-order decisions ‚Äî more flexible, more complex</td></tr>
                <tr><td><strong>Adoptability</strong></td><td>Widely adopted: etcd, Consul, CockroachDB, TiDB, FoundationDB</td><td>Used in Google Spanner/Chubby, Apache Cassandra (modified), Azure Cosmos DB</td></tr>
                <tr><td><strong>Ease of implementation</strong></td><td>Raft paper includes pseudocode; many reference implementations available</td><td>Notoriously difficult to implement correctly; "Paxos Made Simple" is still complex</td></tr>
                <tr><td><strong>Reconfiguration</strong></td><td>Joint consensus for adding/removing nodes ‚Äî complex but safe</td><td>Reconfiguration is a separate concern not addressed in basic Paxos</td></tr>
              </tbody>
            </table>
          </div>

          <h2>Real-World Consensus Systems</h2>
          <div class="row g-3 mt-2">
            <div class="col-md-3"><div class="card border-0 bg-gradient-purple p-3 rounded-3 h-100 text-center"><strong>etcd (Raft)</strong><p class="mt-1 mb-0"><small>Kubernetes' backing store for cluster state. Leader election, distributed config, service discovery.</small></p></div></div>
            <div class="col-md-3"><div class="card border-0 bg-gradient-teal p-3 rounded-3 h-100 text-center"><strong>Consul (Raft)</strong><p class="mt-1 mb-0"><small>HashiCorp service mesh and config store. Multi-datacenter Raft.</small></p></div></div>
            <div class="col-md-3"><div class="card border-0 bg-gradient-pink p-3 rounded-3 h-100 text-center"><strong>Zookeeper (ZAB)</strong><p class="mt-1 mb-0"><small>Apache coordination service. ZAB is Paxos-like. Used by Kafka, HBase, Hadoop.</small></p></div></div>
            <div class="col-md-3"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100 text-center"><strong>Spanner (Paxos)</strong><p class="mt-1 mb-0"><small>Google's globally-distributed SQL database. Multi-Paxos with TrueTime.</small></p></div></div>
          </div>

          <div class="callout mt-4">üí° <strong>When You Need Consensus:</strong> Use it for systems requiring strong consistency (leader election, distributed locks, configuration stores). Consensus is expensive ‚Äî requires majority quorum to commit, adding latency. For eventually-consistent systems or single-leader replication, consensus is overkill. Choose wisely.</div>
        </section>

        <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ DEPLOYMENT STRATEGIES ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
        <section id="deployment-strategies" role="article">
          <h1>üöÄ Deployment Strategies</h1>
          <span class="badge">deployment</span> <span class="badge">blue-green</span> <span class="badge">canary</span> <span class="badge">rollout</span>

          <h2>Introduction</h2>
          <p>How you deploy code to production is as critical as the code itself. A bad deployment strategy means every release is a high-risk event ‚Äî downtime, rollback chaos, user-facing bugs. <strong>Modern deployment strategies eliminate risk through gradual rollout, automated validation, and instant rollback</strong>.</p>
          <p>The goal: deploy multiple times per day with confidence, not dread. This section covers the four primary strategies ‚Äî each with different complexity, risk profiles, and infrastructure requirements.</p>

          <div class="callout">
            <strong>‚ö†Ô∏è Why Deployment Strategy Matters</strong><br/>
            ‚Ä¢ <strong>Zero-downtime:</strong> Users should never experience service interruption during a deployment<br/>
            ‚Ä¢ <strong>Fast rollback:</strong> If a release introduces a bug, revert in seconds, not hours<br/>
            ‚Ä¢ <strong>Blast radius control:</strong> Test on 1% of users before 100% ‚Äî limit exposure to bugs<br/>
            ‚Ä¢ <strong>Observability:</strong> Automated health checks and metrics-driven promotion or rollback
          </div>

          <h2>Deployment Strategies Comparison</h2>
          <div class="mermaid-container mt-3">
            <pre class="mermaid">
graph TB
    subgraph BG["üíôüíö Blue-Green Deployment"]
        LB1[Load Balancer]
        Blue1["üîµ Blue Environment<br/>(v1.0 - Current Production)"]
        Green1["üü¢ Green Environment<br/>(v1.1 - New Version)"]
        
        LB1 -->|"100% traffic"| Blue1
        LB1 -.->|"0% traffic<br/>(deploy & test)"| Green1
        
        Switch1["‚ö° Instant Switch"]
        Green1 --> Switch1
        Switch1 -->|"Route 100% to Green"| LB1
    end
    
    subgraph Canary["üê§ Canary Deployment"]
        LB2[Load Balancer]
        Stable["‚úÖ Stable (v1.0)<br/>90% traffic"]
        Can["üê§ Canary (v1.1)<br/>10% traffic"]
        
        LB2 -->|"90%"| Stable
        LB2 -->|"10%"| Can
        
        Monitor["üìä Monitor metrics<br/>5-10 minutes"]
        Can --> Monitor
        Monitor -->|"‚úÖ Healthy"| Promote["Gradually: 25% ‚Üí 50% ‚Üí 100%"]
        Monitor -->|"‚ùå Errors"| Rollback["Instant rollback to 0%"]
    end
    
    style Blue1 fill:#dbeafe,stroke:#3b82f6,stroke-width:2px
    style Green1 fill:#dcfce7,stroke:#10b981,stroke-width:2px
    style Stable fill:#dcfce7,stroke:#10b981,stroke-width:2px
    style Can fill:#fef3c7,stroke:#f59e0b,stroke-width:2px
    style LB1 fill:#e9d5ff,stroke:#a855f7
    style LB2 fill:#e9d5ff,stroke:#a855f7
            </pre>
          </div>

          <h2>Strategy Details</h2>
          <div class="table-responsive mt-2">
            <table class="table table-bordered table-striped">
              <thead><tr><th>Strategy</th><th>How It Works</th><th>Rollback Time</th><th>Infra Cost</th><th>Risk Level</th></tr></thead>
              <tbody>
                <tr>
                  <td><strong>Recreate (Big Bang)</strong></td>
                  <td>Stop all old instances, deploy new version, start new instances. Brief downtime window.</td>
                  <td>Requires full redeploy (10-30 min)</td>
                  <td>Low ‚Äî no extra infrastructure</td>
                  <td>High ‚Äî all users hit new code at once</td>
                </tr>
                <tr>
                  <td><strong>Rolling Update</strong></td>
                  <td>Replace instances one-by-one or in batches. Old and new versions run side-by-side temporarily.</td>
                  <td>Moderate ‚Äî roll back batch-by-batch</td>
                  <td>Low ‚Äî no extra capacity needed</td>
                  <td>Medium ‚Äî gradual rollout but version mix</td>
                </tr>
                <tr>
                  <td><strong>Blue-Green</strong></td>
                  <td>Two identical environments (Blue = live, Green = new). Deploy to Green, test, switch traffic instantly via LB or DNS.</td>
                  <td>Instant ‚Äî flip LB back to Blue</td>
                  <td>High ‚Äî 2√ó infrastructure during deploy</td>
                  <td>Low ‚Äî test fully before traffic switch</td>
                </tr>
                <tr>
                  <td><strong>Canary</strong></td>
                  <td>Route small % of traffic (1-10%) to new version. Monitor metrics. Gradually increase if healthy, instant rollback if errors.</td>
                  <td>Instant ‚Äî route 0% to canary</td>
                  <td>Medium ‚Äî small extra capacity</td>
                  <td>Very Low ‚Äî blast radius limited to canary %</td>
                </tr>
              </tbody>
            </table>
          </div>

          <h2>Blue-Green Deployment Deep Dive</h2>
          <div class="row g-3 mt-1">
            <div class="col-md-6"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100">
              <h6 class="fw-bold">‚úÖ Advantages</h6>
              <ul class="mb-0 ps-3">
                <li><strong>Zero downtime:</strong> Users never experience service interruption ‚Äî traffic switches instantly</li>
                <li><strong>Full pre-production validation:</strong> Test Green environment with smoke tests, load tests, security scans before any user traffic hits it</li>
                <li><strong>Instant rollback:</strong> If production issues emerge, switch LB back to Blue in seconds</li>
                <li><strong>Clean cutover:</strong> No version mixing ‚Äî all users on v1.0 or all on v1.1, never both simultaneously</li>
              </ul>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-red p-3 rounded-3 h-100">
              <h6 class="fw-bold">‚ùå Challenges</h6>
              <ul class="mb-0 ps-3">
                <li><strong>2√ó infrastructure cost:</strong> Must provision full production capacity in both Blue and Green ‚Äî doubles cloud spend during deployment window</li>
                <li><strong>Database migrations:</strong> Both Blue and Green must use same database schema ‚Äî backward-compatible migrations required</li>
                <li><strong>Stateful services:</strong> Session state must be external (Redis) or drained from Blue before cutover</li>
                <li><strong>DNS TTL delays:</strong> If switching via DNS, propagation can take minutes (use LB switching instead)</li>
              </ul>
            </div></div>
          </div>

          <h2>Canary Deployment Deep Dive</h2>
          <div class="row g-3 mt-1">
            <div class="col-md-6"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100">
              <h6 class="fw-bold">‚úÖ Advantages</h6>
              <ul class="mb-0 ps-3">
                <li><strong>Lowest risk:</strong> Only 1-10% of users exposed to new version initially ‚Äî if bugs exist, blast radius is tiny</li>
                <li><strong>Real-user validation:</strong> Metrics from real production traffic validate the release ‚Äî not synthetic tests</li>
                <li><strong>Progressive rollout:</strong> Increase traffic gradually (1% ‚Üí 5% ‚Üí 25% ‚Üí 50% ‚Üí 100%) as confidence builds</li>
                <li><strong>Automated promotion:</strong> Tools like Flagger (for Kubernetes) auto-promote or rollback based on metrics (error rate, latency)</li>
              </ul>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-yellow p-3 rounded-3 h-100">
              <h6 class="fw-bold">‚ö†Ô∏è Considerations</h6>
              <ul class="mb-0 ps-3">
                <li><strong>Metrics-driven:</strong> Requires robust observability (error rates, latency, business metrics) ‚Äî cannot canary without monitoring</li>
                <li><strong>Longer deployment:</strong> Full rollout takes hours (monitor each stage) vs minutes for Blue-Green</li>
                <li><strong>User experience variance:</strong> 10% of users on new version may experience different behavior ‚Äî handle with feature flags for consistency</li>
                <li><strong>StatefulSet challenges:</strong> Difficult for databases or stateful workloads ‚Äî better suited to stateless services</li>
              </ul>
            </div></div>
          </div>

          <h2>Feature Flags vs Deployment Strategy</h2>
          <div class="callout mt-3">
            <strong>üéöÔ∏è Feature Flags ‚Äî Decouple Deploy from Release</strong><br/>
            Deploy code with new features <em>disabled by default</em>. Enable via runtime flag (database toggle, config file, LaunchDarkly). This allows:<br/>
            ‚Ä¢ <strong>Deploy anytime, release separately:</strong> Deploy Friday, enable Monday<br/>
            ‚Ä¢ <strong>A/B testing:</strong> Enable for 50% of users, measure impact<br/>
            ‚Ä¢ <strong>Kill switch:</strong> Disable broken feature instantly without redeployment<br/>
            ‚Ä¢ <strong>Gradual rollout:</strong> Enable for internal users ‚Üí beta users ‚Üí 1% ‚Üí 100%<br/>
            Combine with Canary: deploy to canary instances, enable flag for canary traffic only.
          </div>

          <h2>When to Choose Each Strategy</h2>
          <div class="table-responsive mt-3">
            <table class="table table-bordered table-striped">
              <thead><tr><th>Scenario</th><th>Recommended Strategy</th><th>Reason</th></tr></thead>
              <tbody>
                <tr><td>Non-critical internal tool, off-hours deploy</td><td>Recreate</td><td>Downtime acceptable; simplicity wins</td></tr>
                <tr><td>Standard stateless web app, moderate traffic</td><td>Rolling Update</td><td>Good balance ‚Äî default for Kubernetes Deployments</td></tr>
                <tr><td>High-traffic production app, zero downtime required</td><td>Blue-Green or Canary</td><td>Zero user impact; instant rollback; worth the infra cost</td></tr>
                <tr><td>Mission-critical service (payments, auth), strict SLA</td><td>Canary with automated metrics</td><td>Minimises blast radius; real-user validation before full rollout</td></tr>
                <tr><td>Database schema change</td><td>Blue-Green with backward-compatible migration</td><td>Both versions must work with new schema during transition</td></tr>
              </tbody>
            </table>
          </div>

          <h2>Tools & Platforms</h2>
          <div class="row g-3 mt-2">
            <div class="col-md-3"><div class="card border-0 bg-gradient-purple p-3 rounded-3 h-100"><strong>Kubernetes</strong><p class="mt-1 mb-0"><small>Rolling Update (default), Blue-Green (via Services), Canary (via Flagger, Argo Rollouts)</small></p></div></div>
            <div class="col-md-3"><div class="card border-0 bg-gradient-teal p-3 rounded-3 h-100"><strong>AWS CodeDeploy</strong><p class="mt-1 mb-0"><small>Blue-Green for ECS, Lambda. Canary for Lambda with traffic shifting.</small></p></div></div>
            <div class="col-md-3"><div class="card border-0 bg-gradient-pink p-3 rounded-3 h-100"><strong>Azure DevOps</strong><p class="mt-1 mb-0"><small>Blue-Green via deployment slots (App Service). Canary via Traffic Manager.</small></p></div></div>
            <div class="col-md-3"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100"><strong>Spinnaker / Flagger</strong><p class="mt-1 mb-0"><small>Multi-cloud CD platform with automated canary analysis and progressive delivery.</small></p></div></div>
          </div>

          <div class="callout mt-4">üí° <strong>Best Practice:</strong> Start with Rolling Updates. Graduate to Blue-Green when downtime is unacceptable. Adopt Canary when site traffic is high enough that 1-10% provides statistically significant metrics. Combine Canary with Feature Flags for maximum control and safety.</div>
        </section>

        <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ SERVICE MESH ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
        <section id="service-mesh" role="article">
          <h1>üï∏Ô∏è Service Mesh</h1>
          <span class="badge">service mesh</span> <span class="badge">istio</span> <span class="badge">linkerd</span> <span class="badge">envoy</span>

          <h2>Introduction</h2>
          <p>As microservice counts grow from 5 to 50 to 500, the operational complexity of <strong>service-to-service networking</strong> explodes. Every service needs: mutual TLS for encryption, retries and timeouts for resilience, metrics and distributed tracing for observability, and traffic management for canary deployments. Implementing this in every service codebase creates duplication, drift, and operational nightmares.</p>
          <p>A <strong>Service Mesh</strong> solves this by <strong>extracting all networking concerns into infrastructure</strong>. Each service instance runs alongside a sidecar proxy (typically Envoy) that intercepts all inbound and outbound traffic, applying policies uniformly across the entire fleet ‚Äî without modifying application code.</p>

          <div class="callout">
            <strong>üí° Service Mesh ‚Äî The Elevator Pitch</strong><br/>
            Instead of each service handling retries, circuit breaking, mTLS, metrics, and load balancing in application code, a service mesh provides all of this <strong>transparently at the infrastructure layer</strong>. The application makes a plain HTTP call to <code>localhost</code>; the sidecar proxy handles everything else ‚Äî encryption, retry, observability, routing.
          </div>

          <h2>Architecture ‚Äî Sidecar Pattern</h2>
          <div class="mermaid-container mt-3">
            <pre class="mermaid">
graph TB
    subgraph Pod1["üì¶ Service A Pod"]
        A[Service A Container]
        ProxyA[üî∑ Envoy Sidecar]
        A <-->|localhost| ProxyA
    end
    
    subgraph Pod2["üì¶ Service B Pod"]
        B[Service B Container]
        ProxyB[üî∑ Envoy Sidecar]
        B <-->|localhost| ProxyB
    end
    
    subgraph Pod3["üì¶ Service C Pod"]
        C[Service C Container]
        ProxyC[üî∑ Envoy Sidecar]
        C <-->|localhost| ProxyC
    end
    
    ControlPlane["üéõÔ∏è Control Plane<br/>(Istio/Linkerd)<br/>Policy, Config, Metrics"]
    
    ProxyA <-->|mTLS encrypted| ProxyB
    ProxyB <-->|mTLS encrypted| ProxyC
    ProxyA <-->|mTLS encrypted| ProxyC
    
    ProxyA -.->|"Telemetry<br/>Metrics<br/>Traces"| ControlPlane
    ProxyB -.->|Telemetry| ControlPlane
    ProxyC -.->|Telemetry| ControlPlane
    
    ControlPlane -.->|Configuration| ProxyA
    ControlPlane -.->|Configuration| ProxyB
    ControlPlane -.->|Configuration| ProxyC
    
    style A fill:#dbeafe,stroke:#3b82f6
    style B fill:#dbeafe,stroke:#3b82f6
    style C fill:#dbeafe,stroke:#3b82f6
    style ProxyA fill:#dcfce7,stroke:#10b981,stroke-width:2px
    style ProxyB fill:#dcfce7,stroke:#10b981,stroke-width:2px
    style ProxyC fill:#dcfce7,stroke:#10b981,stroke-width:2px
    style ControlPlane fill:#fef3c7,stroke:#f59e0b,stroke-width:2px
            </pre>
          </div>

          <h2>What a Service Mesh Provides</h2>
          <div class="row g-3 mt-2">
            <div class="col-md-6"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100">
              <h6 class="fw-bold">üîí Security</h6>
              <ul class="mb-0 ps-3">
                <li><strong>Mutual TLS (mTLS):</strong> All service-to-service traffic encrypted automatically ‚Äî no code changes</li>
                <li><strong>Zero-trust networking:</strong> Every request authenticated with certificate-based identity</li>
                <li><strong>Policy enforcement:</strong> Define which services can call which ‚Äî Service A can call Service B but not Service C</li>
                <li><strong>Certificate rotation:</strong> Auto-renewal of short-lived certs (24-hour TTL) ‚Äî eliminates manual cert management</li>
              </ul>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100">
              <h6 class="fw-bold">üìä Observability</h6>
              <ul class="mb-0 ps-3">
                <li><strong>Distributed tracing:</strong> Every request gets a trace ID automatically ‚Äî see full request path across all services</li>
                <li><strong>Metrics collection:</strong> RPS, latency (p50/p95/p99), error rates per service ‚Äî no instrumentation code needed</li>
                <li><strong>Service topology:</strong> Visualise service dependencies ‚Äî which services call which, at what rate</li>
                <li><strong>Golden signals:</strong> Latency, traffic, errors, saturation ‚Äî automatically collected for every service</li>
              </ul>
            </div></div>
          </div>

          <div class="row g-3 mt-3">
            <div class="col-md-6"><div class="card border-0 bg-gradient-yellow p-3 rounded-3 h-100">
              <h6 class="fw-bold">‚ö° Traffic Management</h6>
              <ul class="mb-0 ps-3">
                <li><strong>Canary deployments:</strong> Route 10% of traffic to v2, 90% to v1 ‚Äî purely via mesh config, no app changes</li>
                <li><strong>Traffic splitting:</strong> A/B testing ‚Äî 50% users see feature X, 50% see baseline</li>
                <li><strong>Retries &amp; timeouts:</strong> Configure per-service ‚Äî "retry 3 times with 2s timeout" ‚Äî enforced uniformly</li>
                <li><strong>Circuit breaking:</strong> If Service B has &gt;50% error rate, stop sending traffic ‚Äî automatic failover</li>
              </ul>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-purple p-3 rounded-3 h-100">
              <h6 class="fw-bold">üîÑ Resilience</h6>
              <ul class="mb-0 ps-3">
                <li><strong>Load balancing:</strong> Round-robin, least-request, weighted per instance ‚Äî configured once, applied everywhere</li>
                <li><strong>Health checks:</strong> Sidecar probes service health ‚Äî removes unhealthy instances from load balancing pool</li>
                <li><strong>Fault injection:</strong> Inject delays or errors for chaos testing ‚Äî "delay 10% of requests by 5s"</li>
                <li><strong>Rate limiting:</strong> Prevent one consumer from overwhelming a service ‚Äî "max 1000 RPS per client"</li>
              </ul>
            </div></div>
          </div>

          <h2>Service Mesh Comparison</h2>
          <div class="table-responsive mt-3">
            <table class="table table-bordered table-striped">
              <thead><tr><th>Mesh</th><th>Data Plane</th><th>Complexity</th><th>Best For</th></tr></thead>
              <tbody>
                <tr>
                  <td><strong>Istio</strong></td>
                  <td>Envoy sidecar</td>
                  <td>High ‚Äî many components (Pilot, Citadel, Galley); powerful but steep learning curve</td>
                  <td>Large-scale production with advanced traffic management, policy enforcement needs. Most feature-rich.</td>
                </tr>
                <tr>
                  <td><strong>Linkerd</strong></td>
                  <td>Linkerd2-proxy (Rust-based, purpose-built)</td>
                  <td>Low ‚Äî simple architecture; opinionated defaults; fast setup</td>
                  <td>Teams wanting service mesh benefits without Istio complexity. CNCF graduated project.</td>
                </tr>
                <tr>
                  <td><strong>Consul Connect</strong></td>
                  <td>Envoy or built-in proxy</td>
                  <td>Medium ‚Äî integrates with Consul service discovery; multi-datacenter support</td>
                  <td>Already using HashiCorp Consul for service discovery. VM and Kubernetes hybrid workloads.</td>
                </tr>
                <tr>
                  <td><strong>AWS App Mesh</strong></td>
                  <td>Envoy sidecar</td>
                  <td>Medium ‚Äî managed control plane; AWS-native; limited to AWS ecosystem</td>
                  <td>AWS-only deployments with ECS, EKS, EC2. Want managed control plane.</td>
                </tr>
              </tbody>
            </table>
          </div>

          <h2>When to Adopt a Service Mesh</h2>
          <div class="row g-3 mt-2">
            <div class="col-md-6"><div class="card border-0 bg-gradient-teal p-3 rounded-3 h-100">
              <h6 class="fw-bold">‚úÖ Adopt Service Mesh When:</h6>
              <ul class="mb-0 ps-3">
                <li><strong>&gt; 20-30 microservices:</strong> Service-to-service complexity is high enough that centralised management pays off</li>
                <li><strong>Security requirement for mTLS:</strong> Zero-trust mandate ‚Äî every call must be encrypted and authenticated</li>
                <li><strong>Multi-team ownership:</strong> Different teams own different services ‚Äî uniform policy enforcement prevents drift</li>
                <li><strong>Advanced traffic management needs:</strong> Canary, A/B testing, traffic mirroring for testing</li>
                <li><strong>Polyglot environment:</strong> Services in Go, Java, Python, Node.js ‚Äî mesh handles cross-language concerns uniformly</li>
              </ul>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-red p-3 rounded-3 h-100">
              <h6 class="fw-bold">‚ùå Do NOT Adopt When:</h6>
              <ul class="mb-0 ps-3">
                <li><strong>&lt; 10 microservices:</strong> Overhead (sidecar memory, control plane ops) outweighs benefits</li>
                <li><strong>Monolith or small distributed system:</strong> NGINX/API Gateway + application-level retries are sufficient</li>
                <li><strong>No operational maturity:</strong> Service mesh requires Kubernetes expertise, observability tooling, policy management</li>
                <li><strong>Performance-critical workload:</strong> Sidecar adds 1-5ms latency per hop ‚Äî unacceptable for HFT or ultra-low-latency systems</li>
                <li><strong>Team lacks capacity:</strong> Service mesh is infrastructure ‚Äî requires dedicated platform team to operate</li>
              </ul>
            </div></div>
          </div>

          <h2>Implementation Challenges</h2>
          <div class="row g-3 mt-2">
            <div class="col-md-4"><div class="card border-0 bg-gradient-pink p-3 rounded-3 h-100"><strong>üìà Resource Overhead</strong><p class="mt-1 mb-0"><small>Each sidecar consumes 50-200 MB RAM, 0.1-0.5 CPU cores. For 100 services √ó 3 replicas = 300 sidecars = 15-60 GB RAM overhead. Budget accordingly.</small></p></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-yellow p-3 rounded-3 h-100"><strong>üîß Complexity</strong><p class="mt-1 mb-0"><small>Debugging network issues now involves sidecar config, control plane state, cert expiry. Requires team upskilling. Start with Linkerd (simpler) before Istio.</small></p></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100"><strong>üêå Latency</strong><p class="mt-1 mb-0"><small>Sidecar adds 1-5ms per hop (localhost ‚Üí sidecar ‚Üí network ‚Üí sidecar ‚Üí service). Acceptable for most systems; problematic for ultra-low-latency.</small></p></div></div>
          </div>

          <div class="callout mt-4">üí° <strong>Adoption Strategy:</strong> Start with observability only (tracing, metrics) ‚Äî low risk. Then enable mTLS. Finally, adopt traffic management (canary) once the team understands mesh operations. Many teams enable Istio but only use 20% of features ‚Äî that's fine. The value is uniform policy enforcement across all services.</div>
        </section>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê PERFORMANCE & RELIABILITY GROUP ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <section id="perf-reliability" role="article">
          <h1>‚ö° Performance &amp; Reliability</h1>
          <span class="badge">performance</span> <span class="badge">reliability</span> <span class="badge">sre</span>
        </section>

        <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ PERFORMANCE & RELIABILITY INTRODUCTION ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
        <section id="perf-reliability-introduction" role="article">
          <h1>üìñ Introduction</h1>
          <span class="badge">performance</span> <span class="badge">reliability</span> <span class="badge">overview</span>

          <h2>About Performance &amp; Reliability</h2>
          <p>Performance and reliability are not features you add at the end ‚Äî they are properties you design for from the start. A system that is functionally correct but unreliable or slow will fail in production. <strong>Site Reliability Engineering (SRE)</strong>, popularised by Google, provides the vocabulary, practices, and decision frameworks to treat reliability as an engineering problem with measurable objectives.</p>
          <p>This group covers the four interlocking disciplines of production reliability: knowing what is happening (Observability), protecting against overload (Rate Limiting), proactively discovering weaknesses (Chaos Engineering), and defining and tracking reliability targets (SLIs/SLOs/SLAs).</p>

          <div class="callout">
            <strong>üí° The SRE Mental Model</strong>
            <ul class="mb-0 mt-2">
              <li><strong>You can't manage what you can't measure</strong> ‚Äî Observability provides the data; SLIs/SLOs give that data meaning</li>
              <li><strong>Reliability is a feature with a cost</strong> ‚Äî 99.99% is 10√ó more expensive than 99.9%; invest only where users feel the difference</li>
              <li><strong>Failure is inevitable</strong> ‚Äî Design for graceful degradation, not just failure prevention</li>
              <li><strong>Error budgets balance velocity and stability</strong> ‚Äî Burn too many and slow down; maintain budget and ship faster</li>
              <li><strong>Chaos Engineering turns unknown unknowns into known knowns</strong> ‚Äî Find your weaknesses before your users do</li>
            </ul>
          </div>

          <h2>What's Covered</h2>
          <div class="row g-3 mt-1">
            <div class="col-md-6"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100">
              <div class="fw-bold mb-1">üî≠ Observability</div>
              <small>Logs, Metrics, and Distributed Traces ‚Äî the three pillars. RED method for services, USE method for infrastructure. OpenTelemetry as the vendor-neutral standard.</small>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100">
              <div class="fw-bold mb-1">üö¶ Rate Limiting &amp; Throttling</div>
              <small>Token Bucket, Sliding Window, Leaky Bucket algorithms. Distributed rate limiting with Redis. API Gateway throttling policies and HTTP 429 response design.</small>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-yellow p-3 rounded-3 h-100">
              <div class="fw-bold mb-1">üí• Chaos Engineering</div>
              <small>Hypothesis-driven failure injection. GameDay events. Tools: Azure Chaos Studio, AWS FIS, Gremlin. Staging-first, production-with-safeguards progression.</small>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-purple p-3 rounded-3 h-100">
              <div class="fw-bold mb-1">üìê SLIs, SLOs &amp; SLAs</div>
              <small>Defining measurable reliability targets. Error budget = 100% ‚àí SLO. Burn rate alerting. Balancing feature velocity against reliability investment.</small>
            </div></div>
          </div>

          <div class="callout mt-4">üí° These four topics are deeply interconnected: <strong>Observability</strong> gives you SLI data ‚Üí <strong>SLOs</strong> define acceptable thresholds ‚Üí <strong>Chaos Engineering</strong> validates whether your system meets those thresholds under failure ‚Üí <strong>Rate Limiting</strong> prevents overload from eroding your error budget.</div>
        </section>

        <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ OBSERVABILITY ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
        <section id="observability" role="article">
          <h1>üî≠ Observability: Logging, Metrics, Tracing</h1>
          <span class="badge">observability</span> <span class="badge">logging</span> <span class="badge">metrics</span> <span class="badge">tracing</span>

          <h2>Introduction</h2>
          <p>Observability is the ability to understand the <strong>internal state of your system</strong> from its external outputs ‚Äî without modifying the system to answer a new question. It goes beyond traditional monitoring: rather than checking known failure modes, an observable system lets you investigate <em>any</em> failure, including ones you've never seen before.</p>
          <p>The three pillars ‚Äî <strong>Logs</strong>, <strong>Metrics</strong>, and <strong>Distributed Traces</strong> ‚Äî answer complementary questions. Metrics tell you <em>something is wrong</em>; logs tell you <em>what happened</em>; traces tell you <em>where in the request path it happened</em>. Together they give you the full picture to debug production issues in minutes rather than hours.</p>

          <div class="callout">
            <strong>üí° Observability vs Monitoring</strong><br/>
            Monitoring asks questions you thought to ask in advance (dashboard, static threshold alerts). Observability lets you ask arbitrary questions about the past and present state of your system. You need both: monitoring for known failure modes, observability for unknown ones.
          </div>

          <h2>The Three Pillars</h2>
          <div class="mermaid">
graph TB
    System["üñ•Ô∏è Distributed System<br/>(Microservices)"]
    
    System -->|"Emit"| Logs["üìù Logs<br/>(What happened)"]
    System -->|"Emit"| Metrics["üìä Metrics<br/>(How much/many)"]
    System -->|"Emit"| Traces["üîó Distributed Traces<br/>(Where it happened)"]
    
    Logs -->|"Contains"| TraceID1["trace-id: abc123"]
    Traces -->|"Contains"| TraceID2["trace-id: abc123"]
    Metrics -->|"Tagged with"| Labels["labels: service=api"]
    
    TraceID1 -.->|"Correlation"| Analysis["üîç Root Cause Analysis"]
    TraceID2 -.->|"Correlation"| Analysis
    Labels -.->|"Aggregation"| Analysis
    
    Analysis --> Fix["‚úÖ Production Issue Resolved<br/>(Minutes, not hours)"]
    
    style System fill:#dbeafe,stroke:#3b82f6,stroke-width:2px
    style Logs fill:#dcfce7,stroke:#10b981,stroke-width:2px
    style Metrics fill:#fef3c7,stroke:#f59e0b,stroke-width:2px
    style Traces fill:#e9d5ff,stroke:#a855f7,stroke-width:2px
    style TraceID1 fill:#fce7f3,stroke:#ec4899
    style TraceID2 fill:#fce7f3,stroke:#ec4899
    style Labels fill:#fce7f3,stroke:#ec4899
    style Analysis fill:#fee2e2,stroke:#ef4444,stroke-width:2px
    style Fix fill:#dcfce7,stroke:#10b981,stroke-width:3px
          </div>
          <div class="row g-3 mt-1">
            <div class="col-md-4"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100">
              <h6 class="fw-bold">üìù Logs</h6>
              <p class="mb-2"><small>Discrete timestamped records of individual events. The richest form of raw data ‚Äî but also the most storage-intensive.</small></p>
              <ul class="mb-0 ps-3">
                <li><strong>Structured logging (JSON):</strong> Machine-parseable; queryable by any field (userId, traceId, statusCode)</li>
                <li><strong>Log levels:</strong> DEBUG &gt; INFO &gt; WARN &gt; ERROR &gt; FATAL ‚Äî only emit what's needed in production</li>
                <li><strong>Always include:</strong> timestamp, correlation/trace ID, request ID, service name, environment</li>
                <li><strong>Tools:</strong> Azure Monitor Log Analytics, ELK Stack (Elasticsearch + Logstash + Kibana), Splunk, Loki + Grafana</li>
              </ul>
            </div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100">
              <h6 class="fw-bold">üìä Metrics</h6>
              <p class="mb-2"><small>Numeric measurements sampled over time. Extremely low-cost to store and query. Best for dashboards, alerting, and capacity planning.</small></p>
              <ul class="mb-0 ps-3">
                <li><strong>Counter:</strong> Always increasing (total requests, total errors)</li>
                <li><strong>Gauge:</strong> Can go up or down (active connections, queue depth, memory used)</li>
                <li><strong>Histogram:</strong> Distribution of values over time (request latency percentiles: p50, p95, p99)</li>
                <li><strong>Summary:</strong> Pre-computed quantiles on the client side</li>
                <li><strong>Tools:</strong> Prometheus + Grafana, Azure Monitor Metrics, Datadog, CloudWatch</li>
              </ul>
            </div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-yellow p-3 rounded-3 h-100">
              <h6 class="fw-bold">üîó Distributed Traces</h6>
              <p class="mb-2"><small>Track a request as it flows across multiple services. The only tool that reveals <em>cross-service latency breakdowns</em> and dependency call graphs.</small></p>
              <ul class="mb-0 ps-3">
                <li><strong>Trace:</strong> The full request journey from client to last backend service</li>
                <li><strong>Span:</strong> One unit of work (a single service call) within a trace; has start time, duration, status, attributes</li>
                <li><strong>Context propagation:</strong> Trace-ID + Span-ID injected into HTTP headers (W3C TraceContext standard: <code>traceparent</code> header)</li>
                <li><strong>Sampling:</strong> Trace every request (development) or head/tail-based sampling in production (e.g. 1% of traffic + 100% of errors)</li>
                <li><strong>Tools:</strong> Jaeger, Zipkin, Azure Application Insights, AWS X-Ray, OpenTelemetry collector</li>
              </ul>
            </div></div>
          </div>

          <h2>RED &amp; USE Methods</h2>
          <div class="row g-3 mt-1">
            <div class="col-md-6"><div class="card border-0 bg-gradient-purple p-3 rounded-3 h-100">
              <strong>RED Method ‚Äî for Services</strong>
              <p class="mt-1 mb-1"><small>Use for every microservice or API endpoint. The three metrics that best describe service health from the <em>user's perspective</em>.</small></p>
              <ul class="mb-0 ps-3">
                <li><strong>R</strong>ate ‚Äî requests per second (throughput)</li>
                <li><strong>E</strong>rrors ‚Äî error rate (4xx and 5xx responses as % of total)</li>
                <li><strong>D</strong>uration ‚Äî latency percentiles (p50, p95, p99) ‚Äî <em>never average-only</em></li>
              </ul>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-teal p-3 rounded-3 h-100">
              <strong>USE Method ‚Äî for Infrastructure</strong>
              <p class="mt-1 mb-1"><small>Use for every CPU, memory, disk, network resource. Diagnoses resource bottlenecks before they cause service degradation.</small></p>
              <ul class="mb-0 ps-3">
                <li><strong>U</strong>tilisation ‚Äî percentage of time the resource is busy (e.g. 80% CPU)</li>
                <li><strong>S</strong>aturation ‚Äî amount of extra work the resource can't service yet (queue depth, run queue length)</li>
                <li><strong>E</strong>rrors ‚Äî error events on the resource (disk I/O errors, network drops, memory ECC errors)</li>
              </ul>
            </div></div>
          </div>

          <h2>OpenTelemetry (OTEL)</h2>
          <div class="row g-3 mt-1">
            <div class="col-md-4"><div class="card border-0 bg-gradient-pink p-3 rounded-3 h-100"><strong>What is OTEL?</strong><p class="mt-1 mb-0"><small>A CNCF project providing vendor-neutral APIs, SDKs, and a collector for all three pillars. Instrument once, export to any backend (Jaeger, Prometheus, Datadog, Azure Monitor, etc.).</small></p></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-red p-3 rounded-3 h-100"><strong>OTEL Collector</strong><p class="mt-1 mb-0"><small>A standalone agent or sidecar that receives telemetry from your services, processes/filters it, and exports to one or more backends. Decouples your app from the observability tool choice.</small></p></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100"><strong>Correlation is the Goal</strong><p class="mt-1 mb-0"><small>The reason to use all three pillars together: trace ID in logs links a log line to the exact trace span; metric spike (errors ‚Üë) triggers a trace search; trace drill-down leads to the offending log line. This correlation is where OTEL shines.</small></p></div></div>
          </div>

          <div class="callout mt-4">üí° <strong>Start with structured logs + RED metrics for every service.</strong> Add distributed tracing once you have more than 3 services communicating. Adopt OpenTelemetry from day one to avoid vendor lock-in on your observability stack.</div>
        </section>

        <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ RATE LIMITING ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
        <section id="rate-limiting" role="article">
          <h1>üö¶ Rate Limiting &amp; API Throttling</h1>
          <span class="badge">rate limiting</span> <span class="badge">throttling</span> <span class="badge">api</span>

          <h2>Introduction</h2>
          <p>Rate limiting controls how many requests a client can make within a given time window ‚Äî protecting your services from <strong>overload, abuse, and cost runaway</strong>. Without it, a single runaway client or a DDoS attack can exhaust your entire infrastructure, cascading failures to all users.</p>
          <p>Throttling and rate limiting are related but distinct: <strong>rate limiting</strong> blocks requests that exceed a quota (HTTP 429), while <strong>throttling</strong> slows them down (via queuing or delayed responses). Both strategies prevent a fast upstream from overwhelming a slower downstream, and are essential at every layer: API Gateway, service-to-service calls, and database connection pools.</p>

          <div class="callout">
            <strong>üí° Why Rate Limiting is Non-Negotiable</strong>
            <ul class="mb-0 mt-2">
              <li><strong>Prevent cascade failures:</strong> A misbehaving client floods one service, which exhausts its DB connection pool, which causes failures for all clients</li>
              <li><strong>Cost protection:</strong> Serverless functions and managed APIs bill per request ‚Äî unlimited calls = unlimited bill</li>
              <li><strong>Fair usage:</strong> Ensure one heavy user doesn't starve all other users of capacity</li>
              <li><strong>Security:</strong> Rate limiting is a first-line defence against brute-force, credential stuffing, and scraping attacks</li>
            </ul>
          </div>

          <h2>Rate Limiting Algorithms</h2>
          <div class="mermaid">
graph TB
    subgraph TokenBucket["ü™£ Token Bucket Algorithm"]
        Refill["‚è∞ Refill Rate<br/>e.g., 10 tokens/sec"] -.->|"Add tokens<br/>continuously"| Bucket["ü™£ Token Bucket<br/>Capacity: 100 tokens<br/>Current: 85 tokens"]
        
        Req1["üì® Request 1"] -->|"Consume 1 token"| Check1{Tokens<br/>available?}
        Check1 -->|"‚úÖ Yes<br/>(85 ‚Üí 84)"| Allow1["‚úÖ 200 OK<br/>Process Request"]
        
        Req2["üì® Request 2<br/>(after bucket empty)"] -->|"Try consume"| Check2{Tokens<br/>available?}
        Check2 -->|"‚ùå No<br/>(0 tokens)"| Deny["üö´ 429 Too Many Requests<br/>Retry-After: 1s"]
        
        Check2 -.->|"Wait for refill"| Wait["‚è≥ Wait 100ms"]
        Wait -.->|"1 token added"| Allow2["‚úÖ 200 OK"]
    end
    
    subgraph FixedWindow["üìÖ Fixed Window Counter"]
        FW1["Window Start: 10:00:00<br/>Counter: 0"] -->|"Request at 10:00:30"| FW2["Counter: 1"]
        FW2 -->|"Request at 10:00:45"| FW3["Counter: 2"]
        FW3 -->|"Window Reset: 10:01:00"| FW4["Counter: 0<br/>‚ö†Ô∏è Burst possible"]
    end
    
    subgraph SlidingWindow["üîÑ Sliding Window Log"]
        SW1["Sorted Set:<br/>[10:00:10, 10:00:25, 10:00:40]"] -->|"New request<br/>at 10:00:55"| SW2["Add timestamp"]
        SW2 -->|"Remove entries<br/>< (now - 60s)"| SW3["‚úÖ Count entries<br/>in window"]
        SW3 -->|"3 requests<br/>in last 60s"| SW4{< Limit?}
        SW4 -->|"‚úÖ Yes"| SWAllow["‚úÖ Allow"]
        SW4 -->|"‚ùå No"| SWDeny["üö´ Deny"]
    end
    
    style Bucket fill:#dbeafe,stroke:#3b82f6,stroke-width:3px
    style Refill fill:#dcfce7,stroke:#10b981
    style Req1 fill:#fef3c7,stroke:#f59e0b
    style Req2 fill:#fef3c7,stroke:#f59e0b
    style Check1 fill:#fed7aa,stroke:#ea580c
    style Check2 fill:#fed7aa,stroke:#ea580c
    style Allow1 fill:#dcfce7,stroke:#10b981,stroke-width:2px
    style Allow2 fill:#dcfce7,stroke:#10b981,stroke-width:2px
    style Deny fill:#fee2e2,stroke:#dc2626,stroke-width:2px
    style FW4 fill:#fed7aa,stroke:#ea580c
    style SW4 fill:#fed7aa,stroke:#ea580c
    style SWAllow fill:#dcfce7,stroke:#10b981
    style SWDeny fill:#fee2e2,stroke:#dc2626
          </div>
          <div class="table-responsive mt-3">
            <table class="table table-bordered table-striped">
              <thead><tr><th>Algorithm</th><th>How it Works</th><th>Burst Handling</th><th>Best For</th><th>Cons</th></tr></thead>
              <tbody>
                <tr><td><strong>Token Bucket</strong></td><td>Tokens added at fixed rate to a bucket with capacity N. Each request consumes 1 token. Requests rejected when bucket is empty.</td><td>‚úÖ Allows bursts up to bucket size</td><td>APIs needing bursty allowance (e.g. payments API allows 100 req burst, then 10/sec steady)</td><td>Slightly complex to implement; bucket size is a tuning knob</td></tr>
                <tr><td><strong>Leaky Bucket</strong></td><td>Requests enter a queue and exit at a fixed rate. Excess requests overflow (dropped or queued).</td><td>‚ùå Smoothed to fixed rate ‚Äî no burst</td><td>Smoothing traffic before forwarding to a rate-sensitive downstream</td><td>Clients experience artificial delay even if service is idle</td></tr>
                <tr><td><strong>Fixed Window Counter</strong></td><td>Increment a counter per time window (e.g. per minute). Reset at boundary.</td><td>‚ö†Ô∏è Double-burst at window edge: 100 req at 0:59 + 100 req at 1:01 = 200 in 2 sec</td><td>Simple per-user API quotas where edge bursts are acceptable</td><td>Window boundary exploitation ‚Äî thundering herd at reset</td></tr>
                <tr><td><strong>Sliding Window Log</strong></td><td>Store timestamp of every request in a sorted set. Count entries within rolling window.</td><td>‚úÖ Perfectly accurate; no boundary burst</td><td>Where accurate fairness is critical (financial APIs)</td><td>High memory: one entry per request per user</td></tr>
                <tr><td><strong>Sliding Window Counter</strong></td><td>Blend current window count + weighted fraction of previous window count. <code>count = curr + prev √ó (1 ‚àí elapsed/window)</code></td><td>‚úÖ Near-perfect; low memory</td><td>Default choice for most production systems ‚Äî best accuracy-to-cost ratio</td><td>Slightly approximate (acceptable in practice)</td></tr>
              </tbody>
            </table>
          </div>

          <h2>Distributed Rate Limiting</h2>
          <p class="mt-2">In a microservices architecture, each service instance handles a fraction of traffic. A na√Øve in-process rate limiter allows each instance to independently grant the full quota ‚Äî multiplied across N instances. Distributed rate limiting uses a <strong>shared central store (Redis)</strong> so all instances enforce limits collectively.</p>
          <div class="row g-3 mt-1">
            <div class="col-md-4"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100"><strong>Redis INCR + TTL Pattern</strong><p class="mt-1 mb-0"><small><code>INCR user:{id}:minute:{ts}</code> ‚Üí if result &gt; limit, reject. <code>EXPIRE</code> sets window TTL. Atomic and fast (~microsecond latency). Suitable for fixed-window.</small></p></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100"><strong>Redis Sorted Sets (Sliding Log)</strong><p class="mt-1 mb-0"><small><code>ZADD</code> current timestamp as score. <code>ZREMRANGEBYSCORE</code> removes old entries. <code>ZCARD</code> counts current window. Lua script for atomicity.</small></p></div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-yellow p-3 rounded-3 h-100"><strong>API Gateway (Managed)</strong><p class="mt-1 mb-0"><small>Azure APIM, AWS API Gateway, Kong all provide built-in distributed rate limiting without Redis management. Best for public-facing APIs ‚Äî move complexity out of application code.</small></p></div></div>
          </div>

          <h2>Where to Apply &amp; Response Design</h2>
          <div class="row g-3 mt-1">
            <div class="col-md-3"><div class="card border-0 bg-gradient-purple p-3 rounded-3 text-center h-100"><strong>Per User / API Key</strong><br/><small>Protect against individual client abuse. Most common for SaaS APIs with per-tier quotas.</small></div></div>
            <div class="col-md-3"><div class="card border-0 bg-gradient-teal p-3 rounded-3 text-center h-100"><strong>Per IP Address</strong><br/><small>Defend against DDoS and credential stuffing from a single source. Beware of NAT ‚Äî many users share one IP.</small></div></div>
            <div class="col-md-3"><div class="card border-0 bg-gradient-pink p-3 rounded-3 text-center h-100"><strong>Global / Service-Level</strong><br/><small>Cap total throughput to protect downstream databases or third-party APIs with hard limits.</small></div></div>
            <div class="col-md-3"><div class="card border-0 bg-gradient-red p-3 rounded-3 text-center h-100"><strong>Tiered Quotas</strong><br/><small>Free tier: 100/hour. Pro: 10,000/hour. Enterprise: unlimited. Token Bucket size scales with tier.</small></div></div>
          </div>

          <h2>HTTP Response Headers</h2>
          <div class="table-responsive mt-2">
            <table class="table table-bordered table-striped">
              <thead><tr><th>Header</th><th>Meaning</th><th>Example</th></tr></thead>
              <tbody>
                <tr><td><code>X-RateLimit-Limit</code></td><td>Total allowed requests in the window</td><td><code>1000</code></td></tr>
                <tr><td><code>X-RateLimit-Remaining</code></td><td>Requests remaining in current window</td><td><code>847</code></td></tr>
                <tr><td><code>X-RateLimit-Reset</code></td><td>Unix timestamp when the window resets</td><td><code>1740000060</code></td></tr>
                <tr><td><code>Retry-After</code></td><td>Seconds until client may retry (sent with 429)</td><td><code>60</code></td></tr>
              </tbody>
            </table>
          </div>

          <div class="callout mt-4">üí° Always return <code>HTTP 429 Too Many Requests</code> with a <code>Retry-After</code> header when throttling ‚Äî <strong>never silently drop</strong> requests. Implement rate limiting at the <strong>API Gateway layer</strong> (Azure APIM, Kong) rather than in application code to enforce it consistently across all services and avoid per-service duplication.</div>
        </section>

        <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ CHAOS ENGINEERING ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
        <section id="chaos-engineering" role="article">
          <h1>üí• Chaos Engineering</h1>
          <span class="badge">chaos</span> <span class="badge">resilience</span> <span class="badge">testing</span>

          <h2>Introduction</h2>
          <p>Chaos Engineering is the discipline of <strong>intentionally injecting failures</strong> into a system in a controlled way to discover weaknesses before they manifest as real outages. It is not about breaking things randomly ‚Äî it is a scientific process: form a hypothesis about system behaviour under failure, run an experiment, measure the outcome, and fix what breaks.</p>
          <p>Popularised by Netflix (Chaos Monkey, 2011), chaos engineering grew from a recognition that <strong>distributed systems have failure modes that only emerge in production</strong> ‚Äî under real load, real network conditions, real deployment topology. Integration tests and staging environments simply cannot reproduce all the ways production will behave. The goal is to move from "hoping it works" to "knowing it works because we tested it breaking."</p>

          <div class="callout">
            <strong>üí° Why Chaos Engineering Matters</strong>
            <ul class="mb-0 mt-2">
              <li><strong>Failures will happen</strong> ‚Äî cloud VMs are killed, AZs go down, networks partition. The question is whether you find out in a GameDay or in a 2am page</li>
              <li><strong>Documentation lies</strong> ‚Äî runbooks describe the happy path. Chaos experiments reveal what actually happens</li>
              <li><strong>Resilience patterns need validation</strong> ‚Äî circuit breakers, retries, and bulkheads only work if configured correctly. Chaos confirms they do</li>
              <li><strong>Builds confidence</strong> ‚Äî teams who run regular chaos experiments sleep better because they have evidence their system self-heals</li>
            </ul>
          </div>

          <h2>The Chaos Engineering Process</h2>
          <div class="row g-3 mt-1">
            <div class="col-md-3"><div class="card border-0 bg-gradient-blue p-3 rounded-3 text-center h-100">
              <strong>1. Define Steady State</strong>
              <p class="mt-2 mb-0"><small>Identify a measurable signal of normal system health: e.g. <em>"95% of checkout requests complete in &lt;500ms with &lt;0.1% error rate."</em> Your SLIs and SLOs are the starting point.</small></p>
            </div></div>
            <div class="col-md-3"><div class="card border-0 bg-gradient-green p-3 rounded-3 text-center h-100">
              <strong>2. Form Hypothesis</strong>
              <p class="mt-2 mb-0"><small><em>"Even if the Payment Service has 100ms of extra latency, the Checkout Service will return responses within 1000ms due to its timeout + fallback."</em> Make it specific and falsifiable.</small></p>
            </div></div>
            <div class="col-md-3"><div class="card border-0 bg-gradient-yellow p-3 rounded-3 text-center h-100">
              <strong>3. Inject Failure</strong>
              <p class="mt-2 mb-0"><small>Use a chaos tool to introduce the failure. Start with the smallest possible blast radius ‚Äî single pod, single AZ. Monitor in real time. Have a kill switch ready to abort if impact exceeds expectations.</small></p>
            </div></div>
            <div class="col-md-3"><div class="card border-0 bg-gradient-purple p-3 rounded-3 text-center h-100">
              <strong>4. Verify &amp; Learn</strong>
              <p class="mt-2 mb-0"><small>Did steady state hold? If yes ‚Äî hypothesis confirmed, document as evidence. If no ‚Äî you found a real weakness. Fix it and re-run. This is the most valuable path: <em>failure-driven hardening.</em></small></p>
            </div></div>
          </div>

          <h2>Common Failure Experiments</h2>
          <div class="row g-3 mt-1">
            <div class="col-md-4"><div class="card border-0 bg-gradient-teal p-3 rounded-3 h-100">
              <strong>Resource Failures</strong>
              <ul class="mt-1 mb-0 ps-3">
                <li>Kill random pods or containers (Chaos Monkey)</li>
                <li>Terminate an entire Availability Zone</li>
                <li>Exhaust CPU (100% CPU saturation)</li>
                <li>Fill disk to 100% capacity</li>
                <li>Exhaust memory ‚Äî trigger OOM killer</li>
              </ul>
            </div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-pink p-3 rounded-3 h-100">
              <strong>Network Failures</strong>
              <ul class="mt-1 mb-0 ps-3">
                <li>Inject latency: +100ms, +1s, +5s on specific service calls</li>
                <li>Packet loss (1%, 10%, 100%)</li>
                <li>DNS failures ‚Äî return NXDOMAIN for a dependency</li>
                <li>Partition network ‚Äî isolate a pod from peers</li>
                <li>Throttle bandwidth to simulate degraded links</li>
              </ul>
            </div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-red p-3 rounded-3 h-100">
              <strong>Application &amp; Dependency Failures</strong>
              <ul class="mt-1 mb-0 ps-3">
                <li>Return 500 errors from a downstream API</li>
                <li>Add artificial sleep to DB queries</li>
                <li>Corrupt or duplicate queue messages</li>
                <li>Terminate the primary database node</li>
                <li>Invalidate all cache entries simultaneously</li>
              </ul>
            </div></div>
          </div>

          <h2>Tools Comparison</h2>
          <div class="table-responsive mt-2">
            <table class="table table-bordered table-striped">
              <thead><tr><th>Tool</th><th>Target Environment</th><th>Failure Types</th><th>Best For</th></tr></thead>
              <tbody>
                <tr><td><strong>Netflix Chaos Monkey</strong></td><td>AWS ‚Äî randomly terminates EC2 instances</td><td>Instance termination</td><td>Proving auto-scaling and stateless services work</td></tr>
                <tr><td><strong>Azure Chaos Studio</strong></td><td>Azure VMs, AKS, App Services, Cosmos DB</td><td>CPU/memory stress, network latency, pod kill, AZ shutdown</td><td>Azure-native chaos experiments with RBAC and audit logs</td></tr>
                <tr><td><strong>AWS Fault Injection Simulator (FIS)</strong></td><td>AWS EC2, ECS, EKS, RDS</td><td>CPU/memory, network, API throttling, instance stop/terminate</td><td>AWS-native; integrates with CloudWatch for monitoring</td></tr>
                <tr><td><strong>Gremlin</strong></td><td>Any ‚Äî Kubernetes, VMs, bare metal</td><td>All categories: resource, network, state, time</td><td>Enterprise teams needing cross-cloud chaos with guardrails</td></tr>
                <tr><td><strong>Chaos Mesh / Litmus</strong></td><td>Kubernetes only</td><td>Pod kill, network partition, time skew, I/O chaos</td><td>Kubernetes-native, open-source, GitOps-friendly experiments</td></tr>
              </tbody>
            </table>
          </div>

          <h2>GameDay Events</h2>
          <div class="row g-3 mt-1">
            <div class="col-md-6"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100"><strong>What is a GameDay?</strong><p class="mt-1 mb-0"><small>A scheduled, team-wide chaos experiment event ‚Äî typically 2‚Äì4 hours with multiple failure scenarios injected in sequence. The entire on-call team participates. Response procedures, runbooks, and escalation paths are tested in a realistic but controlled setting.</small></p></div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100"><strong>Staging First, Then Production</strong><p class="mt-1 mb-0"><small>Start every new experiment in staging to calibrate blast radius. Graduate to production only once you have confidence in the kill switch and recovery procedures. In production, start with the smallest possible scope (1 pod, 1% traffic) and expand only if steady state holds.</small></p></div></div>
          </div>

          <div class="callout mt-4">üí° The best outcome of a chaos experiment is <strong>finding a bug</strong> ‚Äî not confirming everything works fine. Budget time to fix discovered issues; chaos without remediation is just breaking things for no benefit.</div>
        </section>

        <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ SLI / SLO / SLA ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
        <section id="sli-slo-sla" role="article">
          <h1>üìê SLIs, SLOs, SLAs ‚Äî How to Define Reliability</h1>
          <span class="badge">sli</span> <span class="badge">slo</span> <span class="badge">sla</span> <span class="badge">reliability</span>

          <h2>Introduction</h2>
          <p>The SLI/SLO/SLA framework, central to <strong>Site Reliability Engineering (SRE)</strong>, gives engineering teams and business stakeholders a shared, measurable language for discussing reliability. It replaces vague goals like "the system should be fast and reliable" with precise, time-bounded, measurable commitments that drive engineering decisions.</p>
          <p>The framework works as a nested hierarchy: <strong>SLIs</strong> are the raw measurements, <strong>SLOs</strong> are the internal targets derived from SLIs, and <strong>SLAs</strong> are the weaker external contractual commitments derived from SLOs. The gap between your SLO and SLA is your operational buffer ‚Äî the margin that prevents every SLO breach from triggering a contract violation.</p>

          <div class="callout">
            <strong>üí° Why SLOs are the Heart of SRE</strong>
            <ul class="mb-0 mt-2">
              <li><strong>Replaces "five nines at all costs"</strong> ‚Äî a 99.9% SLO is often the right answer; 99.999% may cost 100√ó more with diminishing user benefit</li>
              <li><strong>Creates an error budget</strong> ‚Äî explicit permission to take risk (deploy risky features, run chaos experiments) while budget exists</li>
              <li><strong>Prevents alert fatigue</strong> ‚Äî alerts should fire on SLO burn rate, not raw metric thresholds ‚Äî fewer, more meaningful pages</li>
              <li><strong>Aligns engineering and product</strong> ‚Äî when error budget is exhausted, reliability work takes priority over features ‚Äî no more arguing about it</li>
            </ul>
          </div>

          <h2>Core Definitions</h2>
          <div class="row g-3 mt-1">
            <div class="col-md-4"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100">
              <h6 class="fw-bold">SLI ‚Äî Service Level Indicator</h6>
              <p class="mb-2"><small>A quantitative measurement of a service behaviour. Always a <strong>ratio</strong> or <strong>percentile</strong>. Examples:</small></p>
              <ul class="mb-0 ps-3">
                <li><small>% of requests that returned a 2xx response in &lt;200ms</small></li>
                <li><small>% of login attempts that succeeded</small></li>
                <li><small>p99 read latency from the database</small></li>
                <li><small>% of batch jobs that completed within 1 hour</small></li>
              </ul>
              <p class="mt-2 mb-0"><small>‚ö†Ô∏è Measure from the <strong>user's perspective</strong>, not the server's. A request that succeeded at the server but timed out at the client is a failure.</small></p>
            </div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100">
              <h6 class="fw-bold">SLO ‚Äî Service Level Objective</h6>
              <p class="mb-2"><small>A <strong>target range</strong> for an SLI over a rolling time window. An internal engineering commitment ‚Äî not a contract. Examples:</small></p>
              <ul class="mb-0 ps-3">
                <li><small>Success rate SLI ‚â• 99.9% over a rolling 28 days</small></li>
                <li><small>p99 latency ‚â§ 300ms over a rolling 7 days</small></li>
                <li><small>Availability ‚â• 99.95% per calendar month</small></li>
              </ul>
              <p class="mt-2 mb-0"><small>‚ö†Ô∏è Set SLOs <strong>tighter than your SLA</strong> to maintain a buffer. Never set an SLO of 100% ‚Äî perfection is expensive and creates perverse incentives.</small></p>
            </div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-yellow p-3 rounded-3 h-100">
              <h6 class="fw-bold">SLA ‚Äî Service Level Agreement</h6>
              <p class="mb-2"><small>A <strong>contractual commitment</strong> to customers with defined consequences (financial credits, refunds, contract termination) for breaches. Always more lenient than the SLO. Examples:</small></p>
              <ul class="mb-0 ps-3">
                <li><small>Azure SLA for App Service: 99.95% monthly uptime</small></li>
                <li><small>AWS SLA for EC2: 99.99% monthly uptime</small></li>
                <li><small>Custom SaaS SLA: 99.9% with 10% credit for each 0.1% below</small></li>
              </ul>
              <p class="mt-2 mb-0"><small>‚ö†Ô∏è Your internal SLO should be <strong>0.1‚Äì0.5% tighter</strong> than your SLA ‚Äî this operational buffer gives you time to react to an SLO breach before it becomes an SLA violation.</small></p>
            </div></div>
          </div>

          <h2>Error Budget</h2>
          <p class="mt-2">The error budget is the <strong>allowed quantity of unreliability</strong> over the SLO window. It is the key mechanism that balances engineering velocity against reliability investment.</p>
          <div class="table-responsive mt-1">
            <table class="table table-bordered table-striped">
              <thead><tr><th>SLO Target</th><th>Error Budget (per month, 30d)</th><th>Error Budget in Minutes</th><th>Typical Use Case</th></tr></thead>
              <tbody>
                <tr><td>99%</td><td>1%</td><td>432 min (7.2 hours)</td><td>Internal tools, batch systems</td></tr>
                <tr><td>99.5%</td><td>0.5%</td><td>216 min (3.6 hours)</td><td>Non-critical web apps</td></tr>
                <tr><td>99.9%</td><td>0.1%</td><td>43.2 min</td><td>Standard consumer SaaS (most common target)</td></tr>
                <tr><td>99.95%</td><td>0.05%</td><td>21.6 min</td><td>Enterprise SaaS with contractual SLAs</td></tr>
                <tr><td>99.99%</td><td>0.01%</td><td>4.32 min</td><td>Financial transactions, critical infrastructure</td></tr>
                <tr><td>99.999%</td><td>0.001%</td><td>26 seconds</td><td>Life-safety, emergency services (extremely rare)</td></tr>
              </tbody>
            </table>
          </div>

          <h2>Burn Rate Alerting</h2>
          <p class="mt-2">Burn rate measures <strong>how fast you are consuming error budget</strong> relative to the allowed rate. A burn rate of 1 = burning budget at exactly the pace you can sustain over the full window. A burn rate of 2 = burning at 2√ó the sustainable rate.</p>
          <div class="mermaid">
graph TB
    Budget["üí∞ Error Budget<br/>(99.9% SLO = 43.2 min/month)"]
    
    Budget --> Normal["üü¢ Burn Rate = 1√ó<br/>(Normal)"]
    Budget --> Slow["üü° Burn Rate = 2√ó<br/>(Medium Alert)"]
    Budget --> Fast["üî¥ Burn Rate = 14.4√ó<br/>(Critical Alert)"]
    
    Normal -->|"Consumption"| N1["Budget lasts full 30 days<br/>‚úÖ Healthy"]
    Slow -->|"Consumption"| S1["Budget exhausted in 15 days<br/>‚ö†Ô∏è Investigate next business day"]
    Fast -->|"Consumption"| F1["Budget exhausted in ~2 days<br/>üö® Page on-call immediately"]
    
    N1 -.->|"No action needed"| Action1["Continue feature development"]
    S1 -.->|"Ticket created"| Action2["Debug during business hours<br/>Fix underlying issue"]
    F1 -.->|"On-call paged"| Action3["Immediate mitigation required<br/>Rollback/hotfix/traffic shift"]
    
    style Budget fill:#dbeafe,stroke:#3b82f6,stroke-width:3px
    style Normal fill:#dcfce7,stroke:#10b981,stroke-width:2px
    style Slow fill:#fef3c7,stroke:#f59e0b,stroke-width:2px
    style Fast fill:#fee2e2,stroke:#ef4444,stroke-width:3px
    style N1 fill:#dcfce7,stroke:#10b981
    style S1 fill:#fef3c7,stroke:#f59e0b
    style F1 fill:#fee2e2,stroke:#ef4444
    style Action1 fill:#e9d5ff,stroke:#a855f7
    style Action2 fill:#fce7f3,stroke:#ec4899
    style Action3 fill:#fee2e2,stroke:#ef4444,stroke-width:2px
          </div>
          <div class="row g-3 mt-1">
            <div class="col-md-6"><div class="card border-0 bg-gradient-red p-3 rounded-3 h-100">
              <strong>üî¥ Fast Burn Alert (Page Immediately)</strong>
              <p class="mt-1 mb-0"><small>Burn rate &gt; 14.4√ó over the last 1 hour ‚Üí you will exhaust the entire monthly budget in ~2 days. Requires immediate on-call response. Typically set to alert within 5 minutes of the condition being true.</small></p>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-yellow p-3 rounded-3 h-100">
              <strong>üü° Slow Burn Alert (Ticket / Next Business Day)</strong>
              <p class="mt-1 mb-0"><small>Burn rate &gt; 1√ó over the last 6 hours ‚Üí budget will be exhausted before the window ends. Doesn't require waking someone, but needs investigation during business hours to prevent long-term reliability decay.</small></p>
            </div></div>
          </div>

          <h2>Best Practices</h2>
          <div class="row g-3 mt-1">
            <div class="col-md-4"><div class="card border-0 bg-gradient-purple p-3 rounded-3 h-100">
              <ul class="mb-0 ps-3">
                <li>Define SLIs from the <strong>user perspective</strong> (client-side latency, not server-side)</li>
                <li>Keep SLIs to a <strong>small set (3‚Äì5 per service)</strong> ‚Äî more is not better</li>
                <li>Use <strong>rolling windows</strong> (28 or 30 days), not calendar months ‚Äî avoids end-of-month gaming</li>
              </ul>
            </div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-teal p-3 rounded-3 h-100">
              <ul class="mb-0 ps-3">
                <li>Set SLOs <strong>tighter than 100%</strong> ‚Äî acknowledges that failures are acceptable and removes pressure to block deploys after any incident</li>
                <li>Review SLOs <strong>quarterly</strong> ‚Äî tighten as you improve; relax if targets are never meaningful triggers</li>
              </ul>
            </div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-pink p-3 rounded-3 h-100">
              <ul class="mb-0 ps-3">
                <li>Alert on <strong>burn rate</strong>, not raw threshold breaches ‚Äî reduces noise and focuses response on meaningful trends</li>
                <li>Use error budget to <strong>negotiate feature vs reliability work</strong> ‚Äî budget exhausted ‚Üí reliability sprint; budget healthy ‚Üí ship features</li>
              </ul>
            </div></div>
          </div>

          <div class="callout mt-4">üí° <strong>The hardest part of SLOs is not the math ‚Äî it is the cultural shift.</strong> Teams must accept that a healthy error budget means they have <em>permission to take risk</em>, and an exhausted budget means they have <em>an obligation to fix reliability</em> before shipping. This turns reliability from a heated debate into an objective, data-driven conversation.</div>
        </section>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê RESOURCES ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <section id="resources" role="article">
          <h1>üìö Resources &amp; Further Learning</h1>
          <span class="badge">docs</span> <span class="badge">links</span> <span class="badge">references</span>
          
          <h2 class="mt-3">Essential Books</h2>
          <div class="row g-3 mt-1">
            <div class="col-md-6"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100">
              <h6 class="fw-bold">üìñ System Design Fundamentals</h6>
              <ul class="mb-0 ps-3">
                <li><strong>Designing Data-Intensive Applications</strong> ‚Äî Martin Kleppmann<br/><small class="text-muted">The definitive guide to distributed systems, data modeling, and consistency patterns</small></li>
                <li><strong>System Design Interview (Vols 1 &amp; 2)</strong> ‚Äî Alex Xu<br/><small class="text-muted">Practical interview preparation with real-world examples</small></li>
                <li><strong>Understanding Distributed Systems</strong> ‚Äî Roberto Vitillo<br/><small class="text-muted">Concise coverage of consensus, replication, and coordination</small></li>
              </ul>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100">
              <h6 class="fw-bold">üèóÔ∏è Architecture &amp; Patterns</h6>
              <ul class="mb-0 ps-3">
                <li><strong>Building Microservices (2nd Edition)</strong> ‚Äî Sam Newman<br/><small class="text-muted">Comprehensive guide to service decomposition and distributed architecture</small></li>
                <li><strong>Software Architecture: The Hard Parts</strong> ‚Äî Neal Ford et al.<br/><small class="text-muted">Modern distributed architecture decision-making</small></li>
                <li><strong>Fundamentals of Software Architecture</strong> ‚Äî Mark Richards, Neal Ford<br/><small class="text-muted">Architectural thinking, trade-offs, and fitness functions</small></li>
              </ul>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-yellow p-3 rounded-3 h-100">
              <h6 class="fw-bold">‚öôÔ∏è Reliability &amp; Operations</h6>
              <ul class="mb-0 ps-3">
                <li><strong>Site Reliability Engineering</strong> ‚Äî Google SRE Team<br/><small class="text-muted">Free online. SLOs, error budgets, toil reduction</small></li>
                <li><strong>The Site Reliability Workbook</strong> ‚Äî Google SRE Team<br/><small class="text-muted">Practical SRE implementation with case studies</small></li>
                <li><strong>Release It! (2nd Edition)</strong> ‚Äî Michael Nygard<br/><small class="text-muted">Stability patterns: circuit breakers, bulkheads, timeouts</small></li>
              </ul>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-purple p-3 rounded-3 h-100">
              <h6 class="fw-bold">üíº DevOps &amp; Culture</h6>
              <ul class="mb-0 ps-3">
                <li><strong>The Phoenix Project</strong> ‚Äî Gene Kim<br/><small class="text-muted">DevOps transformation told through a compelling narrative</small></li>
                <li><strong>Accelerate</strong> ‚Äî Nicole Forsgren, Jez Humble, Gene Kim<br/><small class="text-muted">Science-backed metrics for high-performing teams</small></li>
                <li><strong>Team Topologies</strong> ‚Äî Matthew Skelton, Manuel Pais<br/><small class="text-muted">Organizing teams for fast flow and Conway's Law</small></li>
              </ul>
            </div></div>
          </div>

          <h2 class="mt-4">Online Resources &amp; Documentation</h2>
          <div class="row g-3 mt-1">
            <div class="col-md-6"><div class="card border-0 bg-gradient-teal p-3 rounded-3 h-100">
              <h6 class="fw-bold">üåê Learning Platforms &amp; Blogs</h6>
              <ul class="mb-0 ps-3">
                <li><a href="https://github.com/donnemartin/system-design-primer" target="_blank" rel="noopener">System Design Primer (GitHub)</a> ‚Äî comprehensive open-source guide</li>
                <li><a href="https://newsletter.systemdesign.one/" target="_blank" rel="noopener">System Design Newsletter</a> ‚Äî weekly deep dives</li>
                <li><a href="https://bytebytego.com/" target="_blank" rel="noopener">ByteByteGo</a> ‚Äî Alex Xu's visual system design content</li>
                <li><a href="https://highscalability.com" target="_blank" rel="noopener">High Scalability</a> ‚Äî real-world architecture case studies</li>
                <li><a href="https://martinfowler.com" target="_blank" rel="noopener">Martin Fowler's Blog</a> ‚Äî architecture patterns and refactoring</li>
                <li><a href="https://www.infoq.com/architecture-design/" target="_blank" rel="noopener">InfoQ Architecture</a> ‚Äî industry trends and presentations</li>
              </ul>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-pink p-3 rounded-3 h-100">
              <h6 class="fw-bold">üì∞ Engineering Blogs (Tier-1 Companies)</h6>
              <ul class="mb-0 ps-3">
                <li><a href="https://netflixtechblog.com/" target="_blank" rel="noopener">Netflix Tech Blog</a> ‚Äî chaos engineering, microservices at scale</li>
                <li><a href="https://engineering.fb.com/" target="_blank" rel="noopener">Meta Engineering</a> ‚Äî distributed systems, data infrastructure</li>
                <li><a href="https://www.uber.com/blog/engineering/" target="_blank" rel="noopener">Uber Engineering</a> ‚Äî real-time data, geospatial systems</li>
                <li><a href="https://engineeringblog.yelp.com/" target="_blank" rel="noopener">Yelp Engineering</a> ‚Äî service reliability, data pipelines</li>
                <li><a href="https://stripe.com/blog/engineering" target="_blank" rel="noopener">Stripe Engineering</a> ‚Äî API design, payment infrastructure</li>
                <li><a href="https://aws.amazon.com/blogs/architecture/" target="_blank" rel="noopener">AWS Architecture Blog</a> ‚Äî cloud patterns and best practices</li>
              </ul>
            </div></div>
          </div>

          <h2 class="mt-4">Cloud Provider Documentation</h2>
          <div class="row g-3 mt-1">
            <div class="col-md-4"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100">
              <h6 class="fw-bold">‚òÅÔ∏è Microsoft Azure</h6>
              <ul class="mb-0 ps-3">
                <li><a href="https://learn.microsoft.com/azure/architecture/" target="_blank" rel="noopener">Azure Architecture Center</a></li>
                <li><a href="https://learn.microsoft.com/azure/architecture/patterns/" target="_blank" rel="noopener">Cloud Design Patterns</a></li>
                <li><a href="https://learn.microsoft.com/azure/well-architected/" target="_blank" rel="noopener">Well-Architected Framework</a></li>
                <li><a href="https://learn.microsoft.com/azure/architecture/guide/technology-choices/compute-decision-tree" target="_blank" rel="noopener">Compute Decision Tree</a></li>
              </ul>
            </div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-yellow p-3 rounded-3 h-100">
              <h6 class="fw-bold">‚òÅÔ∏è Amazon Web Services</h6>
              <ul class="mb-0 ps-3">
                <li><a href="https://aws.amazon.com/architecture/" target="_blank" rel="noopener">AWS Architecture Center</a></li>
                <li><a href="https://aws.amazon.com/well-architected/" target="_blank" rel="noopener">Well-Architected Framework</a></li>
                <li><a href="https://aws.amazon.com/whitepapers/" target="_blank" rel="noopener">AWS Whitepapers</a></li>
                <li><a href="https://d1.awsstatic.com/whitepapers/AWS_Cloud_Best_Practices.pdf" target="_blank" rel="noopener">Cloud Best Practices (PDF)</a></li>
              </ul>
            </div></div>
            <div class="col-md-4"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100">
              <h6 class="fw-bold">‚òÅÔ∏è Google Cloud Platform</h6>
              <ul class="mb-0 ps-3">
                <li><a href="https://cloud.google.com/architecture" target="_blank" rel="noopener">Architecture Framework</a></li>
                <li><a href="https://sre.google/books/" target="_blank" rel="noopener">Google SRE Books (Free)</a></li>
                <li><a href="https://cloud.google.com/architecture/framework" target="_blank" rel="noopener">Cloud Architecture Center</a></li>
                <li><a href="https://research.google/pubs/" target="_blank" rel="noopener">Google Research Papers</a></li>
              </ul>
            </div></div>
          </div>

          <h2 class="mt-4">Practice</h2>
          <div class="row g-3 mt-1">
            <div class="col-md-6"><div class="card border-0 bg-gradient-purple p-3 rounded-3 h-100">
              <h6 class="fw-bold">üéì Learning Platforms</h6>
              <ul class="mb-0 ps-3">
                <li><a href="https://www.educative.io/courses/grokking-modern-system-design-interview-for-engineers-managers" target="_blank" rel="noopener">Educative: Grokking System Design</a> ‚Äî interactive learning</li>
                <li><a href="https://www.tryexponent.com/courses/system-design-interview" target="_blank" rel="noopener">Exponent System Design Course</a> ‚Äî video lessons + mock interviews</li>
                <li><a href="https://interviewing.io/mocks" target="_blank" rel="noopener">Interviewing.io</a> ‚Äî anonymous mock interviews with engineers</li>
                <li><a href="https://www.algoexpert.io/systems/product" target="_blank" rel="noopener">AlgoExpert SystemsExpert</a> ‚Äî structured curriculum</li>
              </ul>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-teal p-3 rounded-3 h-100">
              <h6 class="fw-bold">üõ†Ô∏è Tools &amp; Diagramming</h6>
              <ul class="mb-0 ps-3">
                <li><a href="https://excalidraw.com/" target="_blank" rel="noopener">Excalidraw</a> ‚Äî free, collaborative whiteboard for system diagrams</li>
                <li><a href="https://www.lucidchart.com/" target="_blank" rel="noopener">Lucidchart</a> ‚Äî professional diagramming tool</li>
                <li><a href="https://www.draw.io/" target="_blank" rel="noopener">draw.io (diagrams.net)</a> ‚Äî free diagram editor</li>
                <li><a href="https://mermaid.js.org/" target="_blank" rel="noopener">Mermaid.js</a> ‚Äî text-based diagrams (used in this document)</li>
                <li><a href="https://c4model.com/" target="_blank" rel="noopener">C4 Model</a> ‚Äî structured architecture documentation approach</li>
              </ul>
            </div></div>
          </div>

          <h2 class="mt-4">Foundational Papers</h2>
          <div class="row g-3 mt-1">
            <div class="col-md-12"><div class="card border-0 bg-gradient-pink p-3 rounded-3">
              <h6 class="fw-bold">üìÑ Distributed Systems Research Papers</h6>
              <div class="row">
                <div class="col-md-6">
                  <ul class="mb-0 ps-3">
                    <li><strong>MapReduce</strong> (Google, 2004) ‚Äî distributed data processing</li>
                    <li><strong>Bigtable</strong> (Google, 2006) ‚Äî distributed storage system</li>
                    <li><strong>Dynamo</strong> (Amazon, 2007) ‚Äî highly available key-value store</li>
                    <li><strong>CAP Theorem</strong> (Brewer, 2000/Gilbert &amp; Lynch, 2002)</li>
                    <li><strong>Paxos Made Simple</strong> (Lamport, 2001) ‚Äî consensus algorithm</li>
                  </ul>
                </div>
                <div class="col-md-6">
                  <ul class="mb-0 ps-3">
                    <li><strong>Raft Consensus</strong> (Ongaro &amp; Ousterhout, 2014) ‚Äî easier Paxos alternative</li>
                    <li><strong>Spanner</strong> (Google, 2012) ‚Äî globally distributed database</li>
                    <li><strong>Kafka</strong> (LinkedIn, 2011) ‚Äî distributed streaming platform</li>
                    <li><strong>Time, Clocks, and Ordering</strong> (Lamport, 1978) ‚Äî logical clocks</li>
                    <li>üìö <a href="https://dancres.github.io/Pages/" target="_blank" rel="noopener">Papers We Love: Distributed Systems</a></li>
                  </ul>
                </div>
              </div>
            </div></div>
          </div>

          <h2 class="mt-4">YouTube Channels &amp; Video Resources</h2>
          <div class="row g-3 mt-1">
            <div class="col-md-6"><div class="card border-0 bg-gradient-blue p-3 rounded-3 h-100">
              <h6 class="fw-bold">üì∫ System Design Video Content</h6>
              <ul class="mb-0 ps-3">
                <li><strong>ByteByteGo</strong> ‚Äî visual system design breakdowns (Alex Xu)</li>
                <li><strong>Gaurav Sen</strong> ‚Äî scalable system design interviews</li>
                <li><strong>System Design Interview</strong> ‚Äî mock interviews and real examples</li>
                <li><strong>Tech Dummies Narayan</strong> ‚Äî distributed systems concepts</li>
                <li><strong>Hussein Nasser</strong> ‚Äî backend engineering deep dives</li>
              </ul>
            </div></div>
            <div class="col-md-6"><div class="card border-0 bg-gradient-green p-3 rounded-3 h-100">
              <h6 class="fw-bold">üé• Conference Talks &amp; Presentations</h6>
              <ul class="mb-0 ps-3">
                <li><a href="https://www.infoq.com/presentations/" target="_blank" rel="noopener">InfoQ Presentations</a> ‚Äî QCon, GOTO conferences</li>
                <li><a href="https://www.youtube.com/@CNCF" target="_blank" rel="noopener">CNCF YouTube</a> ‚Äî KubeCon, cloud-native talks</li>
                <li><a href="https://www.youtube.com/@strangeloopconf" target="_blank" rel="noopener">Strange Loop</a> ‚Äî systems programming and distributed computing</li>
                <li><a href="https://www.allthingsdistributed.com/" target="_blank" rel="noopener">All Things Distributed</a> ‚Äî Werner Vogels (AWS CTO) blog</li>
              </ul>
            </div></div>
          </div>

          <div class="callout mt-4">
            üí° <strong>Learning Path Recommendation:</strong> Start with <em>Designing Data-Intensive Applications</em> for fundamentals, practice with <em>System Design Interview</em> books, then explore company engineering blogs for real-world patterns. Diagram every system you learn on Excalidraw. Review <em>Google SRE Book</em> for operational excellence. Revisit this document as a quick reference during interviews and design discussions.
          </div>

          <hr />
          <div class="document-footer">
            <p>
              <strong>Last Updated:</strong> February 2026 |
              <strong>Curated by:</strong> Murthy Vepa with ‚ù§Ô∏è | 
              <strong>Powered by:</strong> GitHub Copilot
            </p>
          </div>
        </section>

        </div>
      </main>
    </div>
    
    <nav class="controls" role="navigation" aria-label="Pagination">
      <div class="btn-group" role="group">
        <button class="btn btn-outline-info btn-sm" id="prevBtn" title="Previous" aria-label="Previous concept">&nbsp;&lt;&nbsp;</button>
        <button class="btn btn-outline-info btn-sm" id="nextBtn" title="Next" aria-label="Next concept">&nbsp;&gt;&nbsp;</button>
      </div>
    </nav>
  </div>  <div class="offcanvas offcanvas-start" tabindex="-1" id="sidebarOffcanvas" aria-labelledby="sidebarLabel">
    <div class="offcanvas-header">
      <h5 class="offcanvas-title" id="sidebarLabel">Contents</h5>
      <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body p-0">
      <ul class="list-group list-group-flush w-100" id="tocMobile"></ul>
    </div>
  </div>

  <script>
    // ---- Mermaid Initialization ----
    document.addEventListener('DOMContentLoaded', () => {
      if (window.mermaid) {
        window.mermaid.contentLoaded();
      }
    });

    // ---- Configuration ----
    const sectionConfig = [
      // Overview
      { id: "overview",                  title: "üìñ Overview",                              tags: ["intro", "overview", "system design"] },

      // Foundational Concepts
      { id: "foundational",              title: "üéì Foundational Concepts",                 tags: ["foundational", "basics", "fundamentals"] },
      { id: "foundational-introduction", title: "üìñ Introduction",                         tags: ["foundational", "basics", "overview"],                      parent: "foundational" },
      { id: "what-is-sd",                title: "üéØ What is System Design?",               tags: ["problem framing", "requirements", "basics"],              parent: "foundational" },
      { id: "functional-nfr",            title: "üìã Functional vs NFRs",                   tags: ["nfr", "functional", "requirements"],                      parent: "foundational" },
      { id: "scaling",                   title: "üìà Horizontal vs Vertical Scaling",        tags: ["scale", "horizontal", "vertical"],                        parent: "foundational" },
      { id: "load-balancing",            title: "‚öñÔ∏è Load Balancing Strategies",             tags: ["load balancing", "round-robin", "consistent hashing"],    parent: "foundational" },
      { id: "caching",                   title: "‚ö° Caching Basics",                        tags: ["cache", "cdn", "client", "db caching"],                  parent: "foundational" },
      { id: "db-sharding",               title: "üóÑÔ∏è DB Sharding & Replication",             tags: ["sharding", "partitioning", "replication"],               parent: "foundational" },

      // Storage & Databases
      { id: "storage-databases",         title: "üíæ Storage & Databases",                   tags: ["storage", "databases", "data"] },
      { id: "storage-databases-introduction", title: "üìñ Introduction",                   tags: ["storage", "databases", "overview"],                        parent: "storage-databases" },
      { id: "sql-vs-nosql",              title: "üóÉÔ∏è SQL vs NoSQL",                          tags: ["sql", "nosql", "database choice"],                        parent: "storage-databases" },
      { id: "cap-theorem",               title: "üî∫ CAP Theorem & PACELC",                  tags: ["cap", "pacelc", "consistency", "availability"],          parent: "storage-databases" },
      { id: "event-sourcing-cqrs",       title: "üìú Event Sourcing & CQRS",                 tags: ["event sourcing", "cqrs", "patterns"],                     parent: "storage-databases" },
      { id: "search-systems",            title: "üîç Search Systems",                        tags: ["search", "inverted index", "elasticsearch"],             parent: "storage-databases" },
      { id: "bloom-filters",             title: "üå∏ Bloom Filters & Probabilistic Data",    tags: ["bloom filters", "probabilistic", "data structures"],     parent: "storage-databases" },
      { id: "lsm-trees",                 title: "üå≥ LSM Trees - Write-Optimized Storage",   tags: ["lsm", "storage engine", "write optimization"],           parent: "storage-databases" },
      { id: "db-indexing",               title: "üìä Database Indexing Deep Dive",           tags: ["indexing", "b-tree", "performance", "query optimization"], parent: "storage-databases" },

      // Architecture Patterns
      { id: "arch-patterns",             title: "üèóÔ∏è Architecture Patterns",                 tags: ["architecture", "patterns", "design"] },
      { id: "arch-patterns-introduction", title: "üìñ Introduction",                       tags: ["architecture", "patterns", "overview"],                   parent: "arch-patterns" },
      { id: "monolith-microservices",    title: "üèõÔ∏è Monolith vs Microservices",             tags: ["monolith", "microservices", "architecture"],             parent: "arch-patterns" },
      { id: "api-gateway-bff",           title: "üö™ API Gateway & BFF",                     tags: ["api gateway", "bff", "backend for frontend"],            parent: "arch-patterns" },
      { id: "message-queues",            title: "üì¨ Message Queues & Pub/Sub",              tags: ["kafka", "rabbitmq", "pub/sub", "queues"],                parent: "arch-patterns" },
      { id: "distributed-transactions",  title: "üîÑ Distributed Transactions & Sagas",      tags: ["saga", "transactions", "distributed"],                   parent: "arch-patterns" },
      { id: "idempotency-retry",         title: "üîÅ Idempotency & Retry Patterns",          tags: ["idempotency", "retry", "resilience"],                    parent: "arch-patterns" },
      { id: "strangler-pattern",         title: "üåø Strangler Fig Pattern",                 tags: ["strangler", "modernization", "migration"],               parent: "arch-patterns" },
      { id: "realtime-communication",    title: "üí¨ Real-Time Communication Patterns",      tags: ["websocket", "sse", "polling", "realtime"],               parent: "arch-patterns" },

      // Cloud & Platform Engineering
      { id: "cloud-platform",            title: "‚òÅÔ∏è Cloud & Platform Engineering",          tags: ["cloud", "platform", "engineering"] },
      { id: "cloud-platform-introduction", title: "üìñ Introduction",                      tags: ["cloud", "platform", "overview"],                          parent: "cloud-platform" },
      { id: "fault-tolerance-ha",        title: "üõ°Ô∏è Fault Tolerance & High Availability",  tags: ["fault tolerance", "ha", "availability"],                 parent: "cloud-platform" },
      { id: "circuit-bulkhead",          title: "‚ö° Circuit Breaker & Bulkhead",            tags: ["circuit breaker", "bulkhead", "resilience"],             parent: "cloud-platform" },
      { id: "serverless-eda",            title: "‚òÅÔ∏è Serverless & Event-Driven Design",      tags: ["serverless", "event-driven", "functions"],              parent: "cloud-platform" },
      { id: "iac",                        title: "üèóÔ∏è Infrastructure as Code",                tags: ["iac", "terraform", "bicep", "automation"],              parent: "cloud-platform" },
      { id: "zero-trust",                title: "üîí Zero-Trust Architecture",               tags: ["zero trust", "security", "identity"],                    parent: "cloud-platform" },
      { id: "multi-region",              title: "üåç Multi-Region Active-Active/Passive",    tags: ["multi-region", "active-active", "active-passive"],      parent: "cloud-platform" },
      { id: "consensus-algorithms",      title: "ü§ù Consensus Algorithms ‚Äî Paxos & Raft",  tags: ["consensus", "raft", "paxos", "distributed"],            parent: "cloud-platform" },
      { id: "deployment-strategies",     title: "üöÄ Deployment Strategies",                 tags: ["deployment", "blue-green", "canary", "rollout"],        parent: "cloud-platform" },
      { id: "service-mesh",              title: "üï∏Ô∏è Service Mesh",                          tags: ["service mesh", "istio", "linkerd", "envoy"],            parent: "cloud-platform" },

      // Performance & Reliability
      { id: "perf-reliability",          title: "‚ö° Performance & Reliability",             tags: ["performance", "reliability", "sre"] },
      { id: "perf-reliability-introduction", title: "üìñ Introduction",                   tags: ["performance", "reliability", "overview"],                 parent: "perf-reliability" },
      { id: "observability",             title: "üëÅÔ∏è Observability: Logging, Metrics, Tracing", tags: ["observability", "logging", "metrics", "tracing"],   parent: "perf-reliability" },
      { id: "rate-limiting",             title: "üö¶ Rate Limiting & API Throttling",        tags: ["rate limiting", "throttling", "api"],                    parent: "perf-reliability" },
      { id: "chaos-engineering",         title: "üî• Chaos Engineering",                     tags: ["chaos", "resilience", "testing"],                        parent: "perf-reliability" },
      { id: "sli-slo-sla",               title: "üìè SLIs, SLOs & SLAs",                    tags: ["sli", "slo", "sla", "reliability"],                      parent: "perf-reliability" },

      // Resources
      { id: "resources",                 title: "üìö Resources",                             tags: ["docs", "links", "references"] }
    ];

    // ---- State & rendering ----
    const state = {
      index: 0,
      filtered: sectionConfig.map((_, i) => i), // indices
    };

    const els = {
      toc: document.getElementById('toc'),
      tocMobile: document.getElementById('tocMobile'),
      prev: document.getElementById('prevBtn'),
      next: document.getElementById('nextBtn'),
      toggleSidebar: document.getElementById('toggleSidebar'),
      themeToggle: document.getElementById('themeToggle'),
      main: document.getElementById('main'),
      sidebar: document.querySelector('nav.sidebar'),
      sidebarOffcanvas: document.getElementById('sidebarOffcanvas')
    };

    // Track collapsed state for each parent
    const collapsedState = {};
    
    function buildTOC(){
      // Clear both TOC lists
      els.toc.innerHTML = '';
      els.tocMobile.innerHTML = '';
      
      // First pass: identify parents and their children
      const parentMap = new Map();
      state.filtered.forEach((idx) => {
        const s = sectionConfig[idx];
        if (s.parent) {
          if (!parentMap.has(s.parent)) {
            parentMap.set(s.parent, []);
          }
          parentMap.get(s.parent).push(s.id);
        }
      });
      
      // Initialize collapsed state for parents (default: collapsed)
      state.filtered.forEach((idx) => {
        const s = sectionConfig[idx];
        if (!s.parent && parentMap.has(s.id)) {
          if (collapsedState[s.id] === undefined) {
            collapsedState[s.id] = true; // collapsed by default
          }
        }
      });
      
      state.filtered.forEach((idx) => {
        const s = sectionConfig[idx];
        
        // Check if this is a sub-item (has a parent section)
        const isSubItem = !!s.parent;
        const hasChildren = parentMap.has(s.id);
        
        // Desktop sidebar
        const liDesktop = document.createElement('li');
        liDesktop.className = isSubItem ? 'list-group-sub-item' : 'list-group-item';
        if (hasChildren) {
          liDesktop.classList.add('has-children');
          if (collapsedState[s.id]) {
            liDesktop.classList.add('collapsed');
          }
        }
        if (isSubItem && collapsedState[s.parent]) {
          liDesktop.classList.add('collapsed');
        }
        liDesktop.dataset.sectionId = s.id;
        
        const aDesktop = document.createElement('a');
        aDesktop.href = `#${s.id}`;
        aDesktop.textContent = s.title;
        aDesktop.addEventListener('click', (e) => {
          e.preventDefault();
          if (hasChildren) {
            // Toggle collapse/expand
            toggleCollapse(s.id, 'desktop');
          } else {
            navigateToId(s.id);
            closeSidebar();
          }
        });
        liDesktop.appendChild(aDesktop);
        els.toc.appendChild(liDesktop);
        
        // Mobile offcanvas
        const liMobile = document.createElement('li');
        liMobile.className = isSubItem ? 'list-group-sub-item' : 'list-group-item';
        if (hasChildren) {
          liMobile.classList.add('has-children');
          if (collapsedState[s.id]) {
            liMobile.classList.add('collapsed');
          }
        }
        if (isSubItem && collapsedState[s.parent]) {
          liMobile.classList.add('collapsed');
        }
        liMobile.dataset.sectionId = s.id;
        
        const aMobile = document.createElement('a');
        aMobile.href = `#${s.id}`;
        aMobile.textContent = s.title;
        aMobile.addEventListener('click', (e) => {
          e.preventDefault();
          if (hasChildren) {
            // Toggle collapse/expand
            toggleCollapse(s.id, 'mobile');
          } else {
            navigateToId(s.id);
            closeSidebar();
          }
        });
        liMobile.appendChild(aMobile);
        els.tocMobile.appendChild(liMobile);
      });
      highlightActiveTOC();
    }
    
    function toggleCollapse(parentId, context) {
      // Toggle the collapsed state
      collapsedState[parentId] = !collapsedState[parentId];
      const isCollapsed = collapsedState[parentId];
      
      // Update both desktop and mobile TOCs
      const containers = context === 'desktop' ? [els.toc] : context === 'mobile' ? [els.tocMobile] : [els.toc, els.tocMobile];
      
      containers.forEach(container => {
        // Update parent item
        const parentItem = container.querySelector(`li[data-section-id="${parentId}"]`);
        if (parentItem) {
          if (isCollapsed) {
            parentItem.classList.add('collapsed');
          } else {
            parentItem.classList.remove('collapsed');
          }
        }
        
        // Update child items
        const childItems = Array.from(container.querySelectorAll('li.list-group-sub-item'));
        childItems.forEach(child => {
          const childId = child.dataset.sectionId;
          const childSection = sectionConfig.find(s => s.id === childId);
          if (childSection && childSection.parent === parentId) {
            if (isCollapsed) {
              child.classList.add('collapsed');
            } else {
              child.classList.remove('collapsed');
            }
          }
        });
      });
    }

    function setActiveByIndex(i){
      const ids = state.filtered.map(idx => sectionConfig[idx].id);
      document.querySelectorAll('section').forEach(s => s.classList.remove('active'));
      const id = ids[i];
      const active = document.getElementById(id);
      if (active){
        active.classList.add('active');
        active.setAttribute('tabindex', '-1');
        active.focus({preventScroll:true});
      }
      updateControls();
      highlightActiveTOC();
      updateURLHash(id);
    }

    function updateControls(){
      const count = state.filtered.length;
      els.prev.disabled = state.index <= 0;
      els.next.disabled = state.index >= count - 1;
    }

    function filterTOC(query){
      const q = query.trim().toLowerCase();
      state.filtered = sectionConfig
        .map((s, i) => ({s, i}))
        .filter(({s}) => s.title.toLowerCase().includes(q) || s.tags.some(t => t.toLowerCase().includes(q)))
        .map(({i}) => i);

      state.index = Math.min(state.index, Math.max(0, state.filtered.length - 1));
      buildTOC();
      setActiveByIndex(state.index);
    }

    function navigate(delta){
      const count = state.filtered.length;
      const nextIndex = Math.min(Math.max(state.index + delta, 0), count - 1);
      if (nextIndex !== state.index){
        state.index = nextIndex;
        setActiveByIndex(state.index);
        // Scroll content to top
        const contentEl = document.querySelector('.content');
        if (contentEl) contentEl.scrollTop = 0;
      }
    }

    function navigateToId(id){
      const idxInFiltered = state.filtered.findIndex(fi => sectionConfig[fi].id === id);
      if (idxInFiltered !== -1){
        state.index = idxInFiltered;
        setActiveByIndex(state.index);
        // Scroll content to top
        const contentEl = document.querySelector('.content');
        if (contentEl) contentEl.scrollTop = 0;
      } else {
        state.filtered = sectionConfig.map((_, i) => i);
        buildTOC();
        navigateToId(id);
      }
    }

    function updateURLHash(id){
      const url = new URL(window.location);
      url.hash = id;
      history.replaceState(null, '', url);
    }

    function highlightActiveTOC(){
      const ids = state.filtered.map(idx => sectionConfig[idx].id);
      const activeId = ids[state.index];
      
      // Find the active section config
      const activeSection = sectionConfig.find(s => s.id === activeId);
      
      // If active section has a parent, expand the parent
      if (activeSection && activeSection.parent) {
        if (collapsedState[activeSection.parent]) {
          collapsedState[activeSection.parent] = false;
          // Update both desktop and mobile
          [els.toc, els.tocMobile].forEach(container => {
            const parentItem = container.querySelector(`li[data-section-id="${activeSection.parent}"]`);
            if (parentItem) {
              parentItem.classList.remove('collapsed');
            }
            // Show all children of this parent
            const childItems = Array.from(container.querySelectorAll('li.list-group-sub-item'));
            childItems.forEach(child => {
              const childId = child.dataset.sectionId;
              const childSection = sectionConfig.find(s => s.id === childId);
              if (childSection && childSection.parent === activeSection.parent) {
                child.classList.remove('collapsed');
              }
            });
          });
        }
      }
      
      // Highlight desktop sidebar
      let activeDesktopElement = null;
      els.toc.querySelectorAll('a').forEach(a => {
        const isActive = a.getAttribute('href') === `#${activeId}`;
        a.classList.toggle('active', isActive);
        // Also toggle active on parent li for sub-items
        if (a.parentElement.classList.contains('list-group-sub-item')) {
          a.parentElement.classList.toggle('active', isActive);
        }
        // Store reference to active element
        if (isActive) {
          activeDesktopElement = a.parentElement;
        }
      });
      
      // Highlight mobile offcanvas
      let activeMobileElement = null;
      els.tocMobile.querySelectorAll('a').forEach(a => {
        const isActive = a.getAttribute('href') === `#${activeId}`;
        a.classList.toggle('active', isActive);
        // Also toggle active on parent li for sub-items
        if (a.parentElement.classList.contains('list-group-sub-item')) {
          a.parentElement.classList.toggle('active', isActive);
        }
        // Store reference to active element
        if (isActive) {
          activeMobileElement = a.parentElement;
        }
      });
      
      // Scroll active item into view in desktop sidebar
      if (activeDesktopElement && els.sidebar) {
        // Use smooth scrolling with a small delay to ensure rendering is complete
        setTimeout(() => {
          // Check if element is visible (not collapsed)
          const isVisible = activeDesktopElement.offsetParent !== null && 
                           !activeDesktopElement.classList.contains('collapsed');
          if (isVisible) {
            activeDesktopElement.scrollIntoView({
              behavior: 'smooth',
              block: 'nearest',
              inline: 'nearest'
            });
          }
        }, 150);
      }
      
      // Scroll active item into view in mobile offcanvas
      if (activeMobileElement) {
        setTimeout(() => {
          // Check if element is visible (not collapsed)
          const isVisible = activeMobileElement.offsetParent !== null && 
                           !activeMobileElement.classList.contains('collapsed');
          if (isVisible) {
            activeMobileElement.scrollIntoView({
              behavior: 'smooth',
              block: 'nearest',
              inline: 'nearest'
            });
          }
        }, 150);
      }
    }

    function openSidebar(){
      const offcanvas = new bootstrap.Offcanvas(document.getElementById('sidebarOffcanvas'));
      offcanvas.show();
    }
    function closeSidebar(){
      const offcanvasElement = document.getElementById('sidebarOffcanvas');
      const offcanvas = bootstrap.Offcanvas.getInstance(offcanvasElement);
      if(offcanvas) offcanvas.hide();
    }

    // ---- Events ----
    els.prev.addEventListener('click', () => navigate(-1));
    els.next.addEventListener('click', () => navigate(1));

    // Keyboard navigation
    window.addEventListener('keydown', (e) => {
      if (e.key === 'ArrowLeft') navigate(-1);
      else if (e.key === 'ArrowRight') navigate(1);
      else if (e.key === 'Escape') closeSidebar();
    });

    // Deep linking on load/hash change
    window.addEventListener('hashchange', () => {
      const id = location.hash.replace('#','');
      if (id) navigateToId(id);
    });

    // Sidebar toggle (mobile)
    els.toggleSidebar.addEventListener('click', () => {
      openSidebar();
    });

    // Restore theme
    (function(){
      try {
        const saved = localStorage.getItem('concepts-theme');
        if (saved) { 
          document.documentElement.setAttribute('data-theme', saved);
          els.themeToggle.textContent = saved === 'light' ? 'üåó' : 'üåô';
        }
      } catch {}
    })();

    // Initial render
    buildTOC();
    
    // Navigate to hash if present, otherwise show first section
    const initialId = location.hash.replace('#','');
    if (initialId){ 
    navigateToId(initialId); 
    } else {
    setActiveByIndex(0);
    // Scroll content to top on initial load
    const contentEl = document.querySelector('.content');
    if (contentEl) contentEl.scrollTop = 0;
    }

  </script>
  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>